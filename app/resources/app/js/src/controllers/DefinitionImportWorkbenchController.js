"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[164],{"../../packages/api-design/import/src/controllers/DefinitionImportWorkbenchController.js":function(e,t,i){i.r(t),i.d(t,{default:function(){return y}});var r,o,s,n=i("../../node_modules/mobx/lib/mobx.module.js"),a=i("../../node_modules/lodash/lodash.js"),l=i.n(a),c=i("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),d=i("./appsdk/workbench/BaseWorkbenchController.js"),p=i("./js/services/EditorService.js"),u=i("./api-dev/interfaces/APIInterface.js"),b=i("./js/stores/StoreManager.js"),g=i("./js/stores/SyncStatusStore.js"),h=i("./js/services/NavigationService.js");function f(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function m(e,t,i,r,o){var s={};return Object.keys(r).forEach((function(e){s[e]=r[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,r){return r(e,t,i)||i}),s),o&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(o):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const v=pm.logger.getContext("import","api-design");let y=(r=class extends d.default{constructor(...e){super(...e),this.files=[],f(this,"isProcessingComplete",o,this),f(this,"isLoading",s,this)}_setFiles(e){this.files=e,this.isProcessingComplete=!0}closeTab(){p.default.close({id:this.tabId})}setIsLoading(e){this.isLoading=e}showErrorToast(){(0,c.toast)({status:"error",description:"Something went wrong. Please try again"})}async didCreate(e){this.setIsLoading(!0);let t,i=l().get(e,"additionalContext.files"),r=l().get(e,"routeParams.apiId"),o=l().get(e,"queryParams.branch");if(l().isEmpty(i))return void h.default.transitionTo("build.createDefinition",{apiId:r},l().pick(e.queryParams,["branch"]),{tabOptions:{openIn:this.tabId}});try{await(0,n.when)((()=>(0,b.resolveStoreInstance)(g.default).isSocketConnected)),t=await(0,u.getAPI)(r)}catch(e){return pm.logger.error("DefinitionImportController~didCreate",e,{context:v}),this.showErrorToast(),void this.closeTab()}let s,a=l().get(t,"name"),c=l().get(t,"version.id");if(o)try{s=await(0,u.getAPILinkedEntityModel)(r,{name:"branch"},"apiDefinition","")}catch(e){return pm.logger.error("DefinitionImportController~didCreate",e,{context:v}),this.showErrorToast(),void this.closeTab()}this.setIsLoading(!1),this.opts={apiId:r,apiVersionId:c,apiName:a,fileStore:s},this._setFiles(i)}},o=m(r.prototype,"isProcessingComplete",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=m(r.prototype,"isLoading",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),m(r.prototype,"_setFiles",[n.action],Object.getOwnPropertyDescriptor(r.prototype,"_setFiles"),r.prototype),m(r.prototype,"setIsLoading",[n.action],Object.getOwnPropertyDescriptor(r.prototype,"setIsLoading"),r.prototype),r)}}]);