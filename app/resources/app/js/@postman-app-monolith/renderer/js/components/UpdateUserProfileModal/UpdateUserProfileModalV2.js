"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[0],{"./js/components/UpdateUserProfileModal/UpdateUserProfileModalV2.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var n=s("../../node_modules/react/index.js"),a=s("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),o=s("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/TextInput/TextInput.js"),d=s("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),m=s("../../node_modules/@postman/aether/esmLib/src/components/ButtonGroup/ButtonGroup.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),c=s("./js/utils/publicProfileValidation.js"),u=s("./js/stores/StoreManager.js"),p=s("./js/stores/CurrentUserInfoStore.js"),f=s("./node_modules/lodash/lodash.js");const g="You need a public profile to perform actions in public workspaces. Update and review the following details before making your profile visible to everyone.",b="Make Profile Public";class C extends n.Component{constructor(e){super(e),this.state={showModal:!1,username:null,name:null,isProfileUpdating:!1},this.descText=g,this.confirmCTAText=b,this.handleOpen=this.handleOpen.bind(this),this.handleClose=this.handleClose.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleInput=this.handleInput.bind(this),this.getNameErrorMessage=this.getNameErrorMessage.bind(this),this.getUserNameErrorMessage=this.getUserNameErrorMessage.bind(this),this.handleCancel=this.handleCancel.bind(this)}componentDidMount(){pm.mediator.on("showUpdateUserProfileModalV2",this.handleOpen)}componentWillUnmount(){pm.mediator.off("showUpdateUserProfileModalV2",this.handleOpen)}handleOpen(e){this.descText=f.get(e,"description")?e.description:this.descText,this.confirmCTAText=f.get(e,"confirmCTAText")?e.confirmCTAText:this.confirmCTAText,this.onComplete=e&&e.onComplete,this.onCancel=e&&e.onCancel;const t=(0,u.resolveStoreInstance)(p.default);this.setState({showModal:!0,username:t.username,name:t.name})}getUserNameErrorMessage(){return(0,c.isUsernameInvalid)(this.state.username)}getNameErrorMessage(){return this.state.name&&this.state.name.length?null:"Please fill out this field."}handleSubmit(){const e=(0,u.resolveStoreInstance)(p.default);this.setState({isProfileUpdating:!0}),e.updateCurrentUser({realname:this.state.name,username:this.state.username,isPublic:!0,email:e.email}).then((()=>{"function"==typeof this.onComplete&&this.onComplete(),(0,a.toast)({title:"Public profile enabled",status:"success",description:"You can now perform actions in public workspaces.",noIcon:!0}),this.handleClose()})).catch((e=>{(0,a.toast)({status:"error",description:f.get(e,"message")||"Couldn't enable public profile due to some error."})})).finally((()=>{this.setState({isProfileUpdating:!1})}))}handleInput(e,t){this.setState({[e]:t})}handleClose(){this.onComplete=null,this.onCancel=null,this.descText=g,this.confirmCTAText=b,this.setState({showModal:!1,username:null,name:null})}handleCancel(){"function"==typeof this.onCancel&&this.onCancel(),this.handleClose()}getCustomOverlayStyles(){return{zIndex:120}}render(){const e=this.getUserNameErrorMessage()||!this.state.name;return n.createElement(o.Modal,{isOpen:this.state.showModal,onClose:this.handleCancel,size:"small"},n.createElement(o.ModalHeader,{heading:"Make your profile public"}),n.createElement(o.ModalContent,null,n.createElement(l.default,{type:"para",color:"content-color-primary",hasBottomSpacing:!0},this.descText),n.createElement(r.default,{direction:"column",gap:"spacing-l"},n.createElement(i.default,{label:n.createElement(d.default,{text:"Name"}),type:"text",value:this.state.name,onChange:e=>{this.handleInput("name",e.target.value)},validationStatus:this.state.showModal&&e&&this.getNameErrorMessage()?"error":void 0,validationMessage:this.getNameErrorMessage()||void 0}),n.createElement(i.default,{label:n.createElement(d.default,{text:"Username"}),type:"text",value:this.state.username,helperText:"Your username can be used to sign in and helps identify you.",onChange:e=>{this.handleInput("username",e.target.value)},validationStatus:this.state.showModal&&e&&this.getUserNameErrorMessage()?"error":void 0,validationMessage:this.getUserNameErrorMessage()||void 0}),n.createElement(l.default,{type:"para",color:"content-color-primary",hasBottomSpacing:!0},"Your public URL will be:",n.createElement(l.default,{type:"strong",className:"profile-link",color:"content-color-primary"}," ",`${window.postman_explore_url}/${this.state.username}`)))),n.createElement(o.ModalFooter,null,n.createElement(r.default,{width:"100%",justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},n.createElement(m.default,null,n.createElement(h.default,{type:"secondary",onClick:this.handleCancel,text:"Cancel"}),n.createElement(h.default,{type:"primary",onClick:this.handleSubmit,text:this.confirmCTAText,isDisabled:e,isLoading:this.state.isProfileUpdating,className:"update-user-profile-modal-container__submit-btn"})))))}}}}]);