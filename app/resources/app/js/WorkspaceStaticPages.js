"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[77],{"../../node_modules/@postman/aether/esmLib/src/components/Illustration/page-illustrations/NoAccess.js":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/Illustration.js");t.default=function(){return o.createElement(n.default,{name:"page-illustration-no-access"})}},"./collaboration/components/workspace/WorkspaceForbidden.js":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),c=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),l=s("../../node_modules/mobx/lib/mobx.module.js"),i=s("./growth/foundation/public/amplitude/AmplitudeService.js"),d=s("./js/components/base/Buttons.js"),u=s("./js/services/NavigationService.js"),p=s("./collaboration/constants/workspace.js"),m=s("./apinetwork/navigation/constants.js"),E=s("./collaboration/navigation/constants.js"),f=s("./appsdk/utils/PublicWorkspaceUtils.js"),h=s("./collaboration/workspace/components/workspace-request-access/WorkspaceRFA.tsx"),R=s("./js/services/CurrentUserDetailsService.js"),_=s("./billing/stores/PlanFeaturesStore.js"),g=s("./js/stores/StoreManager.js"),S=s("./js/stores/CurrentUserStore.js"),v=s("./collaboration/workspace/service/AccessRequestService.ts"),w=s("./collaboration/workspace/types/WorkspaceTypes.ts"),b=s("./node_modules/lodash/lodash.js");const k=(0,c.default)(n.default)`
  margin-top: 25vh;
`,j=c.default.div`
  position: absolute;
  top: 50%;
  left: 50%;
`;function y(){const e=(0,f.isServedFromPublicWorkspaceDomain)()?m.OPEN_EXPLORE_HOME_IDENTIFIER:E.ALL_WORKSPACES_IDENTIFIER;u.default.transitionTo(e)}t.default=({workspaceId:e})=>{const[t,s]=(0,o.useState)(!0),[n,c]=(0,o.useState)(!1),[m,E]=(0,o.useState)(!1),[A,q]=(0,o.useState)(!1);(0,o.useEffect)((()=>{let t=u.default.getActiveQueryParams().get();"share"===b.get(t,"action")&&i.Ampli.shareEntityLinkError({entity_type:"collection",error_type:"workspaceForbidden"});const o=async()=>{try{await _.default.onPlanFeaturesLoad({timeout:1e4})}catch(e){pm.logger.error("WorkspaceForbidden~checkPrivateWorkspacesPlan: Error while loading plan features",e)}return b.get(_.default,["plan","features","private_team_workspaces_enabled","value"],!0)},n=async()=>(await(0,l.when)((()=>(0,g.resolveStoreInstance)(S.default).userStoreInitialised),{timeout:1e4}),Boolean((0,g.resolveStoreInstance)(S.default).isCurrentUserPartner));(async()=>{try{let[t,a]=await Promise.all([n(),o()]),r=!1;!t&&a&&(r=await(async()=>{const t=await v.default.getConfig({model:w.MODEL.workspace,modelId:e});return b.get(t,"requestForAccessEnabled")})()),E(t),c(a),q(r)}catch(e){pm.logger.error("WorkspaceForbidden~fetchAndSetState: Error while fetching state variables",e)}finally{s(!1)}})()}),[]);const P=R.default.teamId,C=e&&A&&n&&!m&&P&&"0"!==P;return t?o.createElement(j,null,o.createElement(a.default,null)):C?o.createElement(k,{justifyContent:"center"},o.createElement(h.default,{workspaceId:e})):o.createElement("div",{className:"workspace-forbidden"},o.createElement(r.default,null),o.createElement("div",{className:"workspace-forbidden__title"},p.WORKSPACE_FORBIDDEN_PAGE_TITTLE),o.createElement("div",{className:"workspace-forbidden__description"},p.WORKSPACE_FORBIDDEN_PAGE_DESCRIPTION),o.createElement(d.Button,{type:"primary",className:"workspace-forbidden__view-workspaces-btn",onClick:y},(0,f.isServedFromPublicWorkspaceDomain)()?"Explore Public Workspaces":"View All Workspaces"))}},"./collaboration/components/workspace/WorkspaceNotFound.js":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/PageNotFound.js"),a=s("./growth/foundation/public/amplitude/AmplitudeService.js"),r=s("./js/components/base/Buttons.js"),c=s("./js/services/NavigationService.js"),l=s("./collaboration/constants/workspace.js"),i=s("./apinetwork/navigation/constants.js"),d=s("./collaboration/navigation/constants.js"),u=s("./appsdk/utils/PublicWorkspaceUtils.js"),p=s("./js/services/PageMetadataService.js"),m=s("./node_modules/lodash/lodash.js");function E(){const e=(0,u.isServedFromPublicWorkspaceDomain)()?i.OPEN_EXPLORE_HOME_IDENTIFIER:d.ALL_WORKSPACES_IDENTIFIER;c.default.transitionTo(e)}t.default=()=>((0,o.useEffect)((()=>{p.default.setPageAs404();let e=c.default.getActiveQueryParams().get();"share"===m.get(e,"action")&&a.Ampli.shareEntityLinkError({entity_type:"collection",error_type:"workspaceNotFound"})}),[]),o.createElement("div",{className:"workspace-not-found"},o.createElement(n.default,null),o.createElement("div",{className:"workspace-not-found__title"},l.WORKSPACE_NOT_FOUND_PAGE_TITTLE),o.createElement("div",{className:"workspace-not-found__description"},l.WORKSPACE_NOT_FOUND_PAGE_DESCRIPTION),o.createElement(r.Button,{type:"primary",className:"workspace-not-found__view-workspaces-btn",onClick:E},(0,u.isServedFromPublicWorkspaceDomain)()?"Explore Public Workspaces":"View All Workspaces")))},"./collaboration/workspace/components/workspace-request-access/WorkspaceRFA.tsx":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=s("../../node_modules/@postman/aether/esmLib/src/components/Toast/ToastManager.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/BlankState/BlankState.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/page-illustrations/NoAccess.js"),d=s("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),u=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),p=s("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),m=s("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),E=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),f=s("./node_modules/lodash/lodash.js"),h=s.n(f),R=s("./collaboration/workspace/controller/AccessRequestController.ts"),_=s("./collaboration/workspace/service/AccessRequestService.ts"),g=s("./collaboration/workspace/types/WorkspaceTypes.ts"),S=s("./collaboration/workspace/types/AccessRequestTypes.ts"),v=s("./js/services/NavigationService.js"),w=s("./js/navigation/active-mode/constants.js"),b=s("./js/services/CurrentUserDetailsService.js"),k=s("./collaboration/workspace/components/workspace-request-access/WorkspaceRFASkeleton.tsx"),j=s("./collaboration/workspace/constants/accessRequests.ts"),y=function(e,t,s,o){return new(s||(s=Promise))((function(n,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function c(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,c)}l((o=o.apply(e,t||[])).next())}))};const A=(0,E.default)(n.default)`
  margin-left: 64px;
`;t.default=e=>{const[t,s]=(0,o.useState)(""),[E,f]=(0,o.useState)(!0),[q,P]=(0,o.useState)(!1),[C,I]=(0,o.useState)(!1),{addToast:x}=(0,a.default)(),T=()=>{v.default.transitionTo(w.HOME)};return(0,o.useEffect)((()=>{y(void 0,void 0,void 0,(function*(){const{userId:t}=b.default;try{const s=yield _.default.find({model:g.MODEL.workspace,modelId:e.workspaceId,requesterId:t,state:[S.ACCESS_REQUEST_STATES.pending]});f(!1),I(!h().isEmpty(s))}catch(e){pm.logger.error("WorkspaceRFA~findPendingRequests: Failed to fetch pending access requests",e)}}))}),[e.workspaceId]),C?o.createElement(r.default,{title:j.ACCESS_REQUEST_PENDING_HEADING,description:j.ACCESS_REQUEST_PENDING_SUBHEADING,secondaryAction:o.createElement(c.default,{type:"outline",text:"Go to Homepage",onClick:T})},o.createElement(l.default,null)):E?o.createElement(k.default,null):o.createElement(n.default,{direction:"row",alignItems:"flex-start"},o.createElement(i.default,null),o.createElement(A,{direction:"column",gap:"spacing-s"},o.createElement(d.default,{type:"h2",text:j.ACCESS_REQUEST_HEADING}),o.createElement(n.default,{direction:"column",gap:"spacing-l"},o.createElement(u.default,{type:"body-medium",color:"content-color-secondary"},j.ACCESS_REQUEST_SUBHEADING),o.createElement(p.default,{placeholder:"A short note that will help workspace admins approve your request...",value:t,maxLength:500,validationStatus:t.length>=500&&"error",label:o.createElement(m.default,{text:"Add note",fieldType:"optional"}),onChange:e=>{var t;s(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.value)}}),o.createElement(n.default,{direction:"row",gap:"spacing-s"},o.createElement(c.default,{type:"primary",text:"Request Access",onClick:()=>y(void 0,void 0,void 0,(function*(){P(!0);const s={model:g.MODEL.workspace,modelId:e.workspaceId};t&&h().set(s,"notes",t);try{yield R.default.createRequest(s),x({title:"Request sent",status:"success",description:"You'll be notified of the workspace admin's response."}),T()}catch(e){x({title:"Couldn't send request",status:"error",description:"Just a faulty wire. Try again."})}finally{P(!1)}})),isLoading:q,isDisabled:t.length>=500,"data-testid":"createRequestBtn"}),o.createElement(c.default,{type:"secondary",text:"Cancel",isDisabled:q,onClick:T,"data-testid":"cancelRequestBtn"})))))}},"./collaboration/workspace/components/workspace-request-access/WorkspaceRFASkeleton.tsx":function(e,t,s){s.r(t);var o=s("../../node_modules/react/index.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),r=s("./collaboration/workspace/components/common/SkeletonUnit.tsx");const c=(0,a.default)(n.default)`
  margin-left: 64px;
  width: 432px;
`;t.default=()=>o.createElement(n.default,{direction:"row",alignItems:"center"},o.createElement(r.default,{width:"320px",height:"240px"}),o.createElement(c,{direction:"column",gap:"spacing-l"},o.createElement(n.default,{direction:"column",gap:"spacing-s"},o.createElement(r.default,{height:"22px",width:"60%"}),o.createElement(r.default,{height:"20px",width:"90%"})),o.createElement(n.default,{direction:"column",gap:"spacing-s"},o.createElement(n.default,{justifyContent:"space-between"},o.createElement(r.default,{height:"16px",width:"150px"}),o.createElement(r.default,{height:"16px",width:"55px"})),o.createElement(r.default,{height:"70px",width:"100%"})),o.createElement(n.default,{gap:"spacing-s"},o.createElement(r.default,{height:"32px",width:"118px"}),o.createElement(r.default,{height:"32px",width:"64px"}))))},"./collaboration/workspace/controller/AccessRequestController.ts":function(e,t,s){s.r(t);var o=s("./node_modules/lodash/lodash.js"),n=s.n(o),a=s("./js/stores/StoreManager.js"),r=s("./collaboration/workspace/model/AccessRequestStore.ts"),c=s("./js/services/CurrentUserDetailsService.js"),l=s("./collaboration/workspace/service/AccessRequestService.ts"),i=s("./collaboration/workspace/types/AccessRequestTypes.ts"),d=function(e,t,s,o){return new(s||(s=Promise))((function(n,a){function r(e){try{l(o.next(e))}catch(e){a(e)}}function c(e){try{l(o.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,c)}l((o=o.apply(e,t||[])).next())}))};t.default=new class{constructor(){this.removeRequest=(e,t)=>n().filter(e,(e=>e.code!==t)),this.createRequest=e=>d(this,void 0,void 0,(function*(){n().set(e,"context.action","grant_role");try{return yield l.default.create(e)}catch(e){throw pm.logger.error("AccessRequestController~createRequest: Failed to create request for access",e),e}})),this.approveRequest=e=>d(this,void 0,void 0,(function*(){const{code:t,role:s,model:o,modelId:a}=e||{},r=this.get(),c=this.getModelRequests(o,a),d=s?{role:s}:{};try{yield l.default.approve(t,d);const e=this.removeRequest(c,t);r.updatePendingRequests(o,a,e)}catch(e){pm.logger.error("AccessRequestController~approveRequest: Failed to approve request for access",e);switch(n().get(e,"error.name")){case i.ACCESS_REQUEST_ERRORS.REQUEST_ALREADY_APPROVED:case i.ACCESS_REQUEST_ERRORS.REQUEST_ALREADY_REJECTED:case i.ACCESS_REQUEST_ERRORS.REQUEST_EXPIRED:const e=this.removeRequest(c,t);r.updatePendingRequests(o,a,e)}throw e}})),this.rejectRequest=e=>d(this,void 0,void 0,(function*(){const{code:t,notes:s,model:o,modelId:a}=e||{},r=this.get(),c=this.getModelRequests(o,a),d=s?{notes:s}:{};try{yield l.default.reject(t,d);const e=this.removeRequest(c,t);r.updatePendingRequests(o,a,e)}catch(e){pm.logger.error("AccessRequestController~rejectRequest: Failed to reject request for access",e);switch(n().get(e,"error.name")){case i.ACCESS_REQUEST_ERRORS.REQUEST_ALREADY_APPROVED:case i.ACCESS_REQUEST_ERRORS.REQUEST_ALREADY_REJECTED:case i.ACCESS_REQUEST_ERRORS.REQUEST_EXPIRED:const e=this.removeRequest(c,t);r.updatePendingRequests(o,a,e)}throw e}})),this.populatePendingRequests=(e,t)=>d(this,void 0,void 0,(function*(){const s=this.get();try{const o=yield l.default.find({model:e,modelId:t,state:[i.ACCESS_REQUEST_STATES.pending]}),a=c.default.userId,r=n().filter(o,(e=>{const{responders:t}=e;return n().some(t,(e=>e.id===a))}));s.updatePendingRequests(e,t,r)}catch(e){throw pm.logger.error("AccessRequestController~populatePendingRequests: Failed to populate request for access",e),e}})),this.destroy=()=>{this.get().clear()},this.get=()=>(0,a.resolveStoreInstance)(r.default)}getModelRequests(e,t){const s=`${e}:${t}`;return this.get().pendingRequests[s]}}},"./collaboration/workspace/model/AccessRequestStore.ts":function(e,t,s){s.r(t),s.d(t,{default:function(){return a}});var o=s("../../node_modules/mobx/lib/mobx.module.js"),n=function(e,t,s,o){var n,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var c=e.length-1;c>=0;c--)(n=e[c])&&(r=(a<3?n(r):a>3?n(t,s,r):n(t,s))||r);return a>3&&r&&Object.defineProperty(t,s,r),r};class a{constructor(){this.pendingRequests={}}updatePendingRequests(e,t,s){const o=`${e}:${t}`;this.pendingRequests[o]=s}clear(){this.pendingRequests={}}}n([o.observable],a.prototype,"pendingRequests",void 0),n([o.action],a.prototype,"updatePendingRequests",null),n([o.action],a.prototype,"clear",null)}}]);