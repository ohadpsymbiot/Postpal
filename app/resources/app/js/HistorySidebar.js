"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[34],{"../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoHistory.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var o=s("../../node_modules/react/index.js"),i=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/Illustration.js");function r(){return o.createElement(i.default,{name:"illustration-no-history"})}},"./integrations/proxy/components/ProxyHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return O}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-capture-stroke.js"),u=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Avatar.js"),y=s("./js/components/base/Tooltips.js"),S=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),b=s("./js/stores/CurrentUserStore.js"),g=s("./js/stores/StoreManager.js"),f=s("./integrations/proxy/stores/ProxySessionStore.js"),v=s("./runtime-repl/_common/DisabledTooltipConstants.js"),I=s("./js/components/base/Dropdowns.js"),E=s("./js/services/NavigationService.js"),T=s("./integrations/proxy/services/ProxyHistoryService.js"),_=s("./js/controllers/ShortcutsList.js"),w=s("./integrations/proxy/helpers/constants.ts"),C=s("./integrations/navigation/constants.js"),A=s("./node_modules/lodash/lodash.js");let O=(0,u.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.proxyStore=(0,g.resolveStoreInstance)(f.default),this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getActionMenuItems=this.getActionMenuItems.bind(this),this.handleRenameSubmit=this.handleRenameSubmit.bind(this),this.containerRef=this.containerRef.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__proxy-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?v.DISABLED_TOOLTIP_IS_OFFLINE:v.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const t=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),s=(0,g.resolveStoreInstance)(b.default).teamMembers.get(String(this.props.owner)),o=s&&(s.name||s.username);return i.createElement("div",{className:t,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(h.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(y.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(y.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},o),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(){this.proxyStore.find(this.props.id)?this.proxyStore.update({id:this.props.id,name:this.props.name}):this.proxyStore.add({id:this.props.id,name:this.props.name,reqData:[],source:this.props.source,totalRecords:0});let e,t,s={name:this.props.name,source:this.props.source};this.props.state===w.SESSION_STATES.RUNNING?(e=C.CAPTURE_REQUESTS_SESSIONS_CONFIGURE_PAGE_IDENTIFIER,t={proxyId:w.CONFIGURE_PAGE_ID}):(e=C.CAPTURE_REQUEST_POST_SESSION_PAGE_IDENTIFIER,t={proxySessionId:this.props.id},A.assign(s,{createdAt:this.props.createdAt,fromActiveSession:!1})),E.default.transitionTo(e,t,{},{additionalContext:s})}handleAction(e){this.props.onSelectAction(e,{proxyhistory:[this.props.id]})}getProxySidebarIcon(e){return e==w.SESSION_STATES.RUNNING?i.createElement(p.default,{color:"content-color-success"}):i.createElement(p.default,null)}getActionMenuItems(e){let t=!1;return e===w.SESSION_STATES.RUNNING&&(t=!0),i.createElement(I.DropdownMenu,{"align-right":!0},i.createElement(I.MenuItem,{key:"proxy-rename",refKey:"proxy-rename"},i.createElement("div",{className:"dropdown-menu-item-label"},"Rename Session")),i.createElement(I.MenuItem,{key:"proxy-delete",refKey:"delete",disabled:t,disabledText:"Session is in progress"},i.createElement("div",{className:"dropdown-menu-item-label"},"Delete Session"),i.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,_.getShortcutByName)("delete"))))}async handleRenameSubmit(e){await T.default.updateProxyHistory({id:this.props.id,name:e}),this.proxyStore.update({id:this.props.id,name:e}),pm.toasts.success("Session renamed successfully")}containerRef(e){this.listItemRef=e}handleEditName(){A.invoke(this.listItemRef,"editText")}handleDropdownActionSelect(e){"proxy-rename"===e&&this.handleEditName(),"delete"===e&&this.props.onSelectAction("delete",{proxyhistory:[this.props.id]})}render(){return i.createElement("div",{"data-index":this.props.index},i.createElement(S.default,{ref:this.containerRef,text:this.props.name,icon:this.getProxySidebarIcon(this.props.state),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,state:this.props.state,moreActions:this.getActionMenuItems(this.props.state),onRename:this.handleRenameSubmit,onActionsDropdownSelect:this.handleDropdownActionSelect}))}})||o},"./js/components/base/ToggleSwitch.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var o=s("../../node_modules/react/index.js"),i=s("./node_modules/classnames/index.js"),r=s.n(i),n=s("./node_modules/prop-types/index.js"),a=s.n(n);class l extends o.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(){!this.props.disabled&&this.props.onClick&&this.props.onClick(!this.props.isActive)}getClasses(){return r()({"toggle-switch":!0,"is-active":this.props.isActive})}getWrapperClasses(){return r()({"toggle-switch-container":!0,"is-disabled":this.props.disabled},this.props.className)}render(){return o.createElement("div",{className:this.getWrapperClasses(),onClick:this.handleClick},o.createElement("div",{className:this.getClasses()}),!this.props.hideLabel&&o.createElement("div",{className:"toggle-switch-text"},this.props.isActive?o.createElement("span",{className:"toggle-switch-text-on"},this.props.activeLabel):o.createElement("span",{className:"toggle-switch-text-off"},this.props.inactiveLabel)))}}l.defaultProps={activeLabel:"ON",inactiveLabel:"OFF",isActive:!1,disabled:!1},l.propTypes={isActive:a().bool,disabled:a().bool,hideLabel:a().bool,activeLabel:a().node,inactiveLabel:a().node,onClick:a().func}},"./js/containers/apps/requester/sidebar/SidebarFilter.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return c}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("./js/components/base/XPaths/XPath.js"),a=s("./js/components/base/Inputs.js"),l=s("./node_modules/lodash/lodash.js");let c=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleSearchCancel=this.handleSearchCancel.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("focusSearchBox",this.focusSearchBox)}componentWillUnmount(){pm.mediator.off("focusSearchBox",this.focusSearchBox)}focusSearchBox(){l.invoke(this,"refs.filter.focus")}handleSearchChange(e){this.props.onSearch&&this.props.onSearch(e)}handleSearchCancel(){this.props.onSearch&&this.props.onSearch("")}render(){return i.createElement(n.default,{identifier:"filter"},i.createElement(a.Input,{icon:"icon-action-filter-stroke",ref:"filter",inputStyle:"search",onChange:this.handleSearchChange,onCancel:this.handleSearchCancel,query:this.props.searchQuery,className:this.props.className}))}})||o},"./js/containers/apps/requester/sidebar/SidebarListActions.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),n=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-add-stroke.js"),a=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),l=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=s("./js/containers/apps/requester/sidebar/SidebarFilter.js"),d=s("./js/components/base/Buttons.js"),h=s("./js/components/base/Dropdowns.js"),p=s("./js/components/base/XPaths/XPath.js");let u=(0,l.observer)(o=class extends i.Component{constructor(e){super(e),this.handleDropdownSelect=this.handleDropdownSelect.bind(this)}handleDropdownSelect(e){this.props.onActionsDropdownSelect&&this.props.onActionsDropdownSelect(e)}getCreateNewButton(e){if(!e)return null;const t=i.createElement(r.default,{className:"create-new__btn",onClick:e.onCreate,tooltip:e.tooltip,isDisabled:e.disabled,icon:i.createElement(n.default,null),type:"tertiary",size:"small"});return e.xPathIdentifier?i.createElement(p.default,{identifier:e.xPathIdentifier},t):t}render(){return i.createElement("div",{className:"requester-left-sidebar__actions-container"},this.getCreateNewButton(this.props.createNewConfig),i.createElement(c.default,{onSearch:this.props.onSearch,className:this.props.className,searchQuery:this.props.searchQuery}),this.props.rightMetaContainer||this.props.moreActions?i.createElement("div",{className:"secondary-actions-container"},this.props.rightMetaContainer,this.props.moreActions?i.createElement(h.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown"},i.createElement(h.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},i.createElement(d.Button,{tooltip:"View more actions"},i.createElement(a.default,{name:"icon-action-options-stroke",className:"dropdown-action-button pm-icon pm-icon-normal"}))),this.props.moreActions):null):"")}})||o},"./js/containers/new-button/CreateNewXService.js":function(e,t,s){s.r(t);var o=s("./js/stores/CurrentUserStore.js"),i=s("./runtime-repl/environment/datastores/ActiveEnvironmentStore.js"),r=s("./js/stores/StoreManager.js"),n=s("./js/stores/ActiveWorkspaceStore.js"),a=s("./js/modules/services/SignInModalService.js"),l=s("./js/services/NavigationService.js"),c=s("./onboarding/navigation/constants.js"),d=s("./runtime-repl/environment/_api/EnvironmentStoreV2.js"),h=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),p=s("./node_modules/lodash/lodash.js");function u(...e){pm.mediator.trigger(...e)}t.default={create:async function(e,t,s=null,m={}){!function(e,t,s,i){let n=(0,r.resolveStoreInstance)(o.default);if("create_new_modal"===i.from&&(i.onBack=()=>l.default.transitionTo(c.OPEN_CREATE_NEW_IDENTIFIER)),!n.isLoggedIn)return(0,a.showContextualSignInModal)(e,(()=>{u(e,t,s)}),i);u(e,t,s)}(e,await async function({collectionId:e=null,requests:t=null,opts:s}){if(1===s.activeStep)return{workspaceId:(0,r.resolveStoreInstance)(n.default).id,from:s.from};const o=(0,r.resolveStoreInstance)(n.default).id,a=(0,r.resolveStoreInstance)(i.default).id;let l=null,c=await(0,d.getMeta)(o),u=a&&c.findOne(a),m=c.list,y=p.sortBy(m,(e=>p.toLower(e.name))),S=await(0,h.getMeta)(o),b=e&&await(0,h.getOne)(e,{exclude:["response","request"]}),g=S.list;u&&(l=u.id),m=p.concat({id:null,name:"No Environment"},y);let f={activeStep:2,activeSource:"workspace",ownCollections:g,ownEnvironments:m,workspaceId:(0,r.resolveStoreInstance)(n.default).id,from:s.from};return f.selectedOptions=e&&b?{environmentId:l,collectionId:e,ownerId:b.owner,name:b.name}:{environmentId:l,name:s.name,requests:t},f}(t),s,m)}}},"./js/modules/services/SignInModalService.js":function(e,t,s){s.r(t),s.d(t,{attachAuthEventHandler:function(){return c},attachSyncEventHandler:function(){return d},showContextualSignInModal:function(){return h}});var o=s("./js/services/UIEventService.js"),i=s("./js/stores/StoreManager.js"),r=s("./js/stores/SyncStatusStore.js"),n=s("../../node_modules/mobx/lib/mobx.module.js"),a=s("./node_modules/lodash/lodash.js");const l={openCreateNewDocumentationModal:"documentation",openCreateNewMockModal:"mock",openCreateNewMonitorModal:"monitor",mock:"mock",monitor:"monitor",documentation:"documentation",invite:"invite"};function c({onSignIn:e,onSkipSignIn:t}={}){if(!e&&!t)return;let s,i;return a.isFunction(e)&&(s=o.default.subscribe("userSignedIn",e)),a.isFunction(t)&&(i=o.default.subscribe("userSkippedSignIn",t)),()=>{s&&s(),i&&i()}}function d({onSuccess:e,onError:t}={}){if((0,i.resolveStoreInstance)(r.default).isInSync)return a.isFunction(e)&&e(),a.noop;let s=setTimeout((()=>a.isFunction(t)&&t()),6e4),o=(0,i.resolveStoreInstance)(r.default),l=(0,n.reaction)((()=>o.isInSync),(t=>{t&&(clearTimeout(s),a.isFunction(e)&&e())}));return()=>{l&&l()}}function h(e="invite",t=null,s={}){let o=l[e]||"invite";return pm.mediator.trigger("showContextualSignInModal",{type:o,from:s.from,onLogin:()=>{a.isFunction(t)&&t()},onBack:a.isFunction(s.onBack)&&s.onBack})}},"./js/stores/ListCacheStore.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var o,i,r,n,a=s("../../node_modules/mobx/lib/mobx.module.js"),l=s("./js/stores/BaseListStore.js"),c=s("./js/modules/controllers/ListCacheController.js"),d=s("./node_modules/lodash/lodash.js");function h(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let p=(o=a.action.bound,i=a.action.bound,n=h((r=class{constructor(e){var t,s,o,i;t=this,s="ranges",i=this,(o=n)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.id=e.id,this.ranges=e.ranges,this.update(e)}getRange(e){return d.find(this.ranges,(t=>t[1]===e||t[1]<e&&t[0]>e||t[0]===e))}update(e){d.has(e,"ranges")&&(this.ranges=e.ranges)}}).prototype,"ranges",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h(r.prototype,"getRange",[o],Object.getOwnPropertyDescriptor(r.prototype,"getRange"),r.prototype),h(r.prototype,"update",[i],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),r);class u extends l.default{constructor(){super(p),this.modelEvents={namespace:"listcache"}}hydrate(){return c.default.getAll().then((e=>{this.add(e)}))}}},"./runtime-repl/extensible-collection/history/components/ECHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return T}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),u=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),m=s("./js/components/base/Avatar.js"),y=s("./js/components/base/Tooltips.js"),S=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),b=s("./js/stores/OnlineStatusStore.js"),g=s("./js/stores/PermissionStore.js"),f=s("./runtime-repl/history/HistoryActionsConstants.js"),v=s("./runtime-repl/_common/DisabledTooltipConstants.js"),I=s("./js/stores/StoreManager.js"),E=s("./js/stores/CurrentUserStore.js");let T=(0,u.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__extensibleitem":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?v.DISABLED_TOOLTIP_IS_OFFLINE:v.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){var t;if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const s=(0,I.resolveStoreInstance)(E.default),o=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),r=s.isCurrentUserPartner?null===(t=s.partnerMembersByIds)||void 0===t?void 0:t[this.props.userId]:s.teamMembers.get(String(this.props.userId)),n=r&&(r.name||r.username);return i.createElement("div",{className:o,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.userId&&"0"!==this.props.userId?i.createElement(m.default,{ref:this.userAvatar,size:"small",userId:this.props.userId}):i.createElement(p.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(y.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(y.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},n),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=c()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=(0,I.resolveStoreInstance)(g.default),{userCanSave:o}=(0,I.resolveStoreInstance)(b.default),r=o&&s.can("delete","history");return i.createElement("div",{className:t},i.createElement(h.default,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!r,tooltip:this.getTooltipText(!r,!o)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"ecitemhistory",itemType:this.props.itemType},t)}handleAction(e){this.props.onSelectAction(e,{ecitemhistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(f.ACTION_TYPE_DELETE)}render(){const e=pm.ECItemRegistry.getConfig(this.props.itemType);return e?i.createElement("div",{"data-index":this.props.index},i.createElement(S.default,{text:this.props.url,icon:i.createElement(p.default,{name:e.icon,color:e.iconColor}),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents})):null}})||o},"./runtime-repl/history/HistoryActionsConstants.js":function(e,t,s){s.r(t),s.d(t,{ACTION_TYPE_DELETE:function(){return a},ACTION_TYPE_DOCUMENT:function(){return r},ACTION_TYPE_DOWNLOAD:function(){return l},ACTION_TYPE_MOCK:function(){return n},ACTION_TYPE_MONITOR:function(){return i},ACTION_TYPE_SAVE:function(){return o}});const o="save",i="monitor",r="document",n="mock",a="delete",l="download"},"./runtime-repl/history/HistoryActionsTooltipConstants.js":function(e,t,s){s.r(t),s.d(t,{ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:function(){return i},ACTION_TYPE_DELETE_REQUEST_TOOLTIP:function(){return o},ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:function(){return n},ACTION_TYPE_SAVE_REQUEST_TOOLTIP:function(){return r}});const o="Delete request",i="Delete items",r="Add request to Collection",n="Add requests to Collection"},"./runtime-repl/history/HistoryInfoHeader.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return n}});var o=s("../../node_modules/react/index.js"),i=s("./node_modules/prop-types/index.js"),r=s.n(i);class n extends o.PureComponent{render(){const e=this.props.icon;return o.createElement("div",{className:"history-sidebar-info-header"},o.createElement("div",{className:"history-sidebar-info-header__icon"},o.createElement(e,null)),o.createElement("span",null,this.props.message))}}n.propTypes={message:r().string.isRequired}},"./runtime-repl/history/HistoryItemActionsDropdown.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var o,i,r,n,a=s("../../node_modules/react/index.js"),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),h=s("../../node_modules/mobx/lib/mobx.module.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),u=s("./js/components/base/Dropdowns.js"),m=s("./js/components/base/Buttons.js"),y=s("./js/utils/PluralizeHelper.js"),S=s("./runtime-repl/history/HistoryActionsConstants.js"),b=s("./runtime-repl/_common/ScratchpadConstants.js"),g=s("./runtime-repl/_common/DisabledTooltipConstants.js"),f=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/stores/StoreManager.js"),E=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),T=s("./js/constants/MoreButtonTooltipConstant.js"),_=s("./js/controllers/ShortcutsList.js"),w=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),C=s("./collaboration/workspace/types/PermissionTypes.ts"),A=s("./node_modules/lodash/lodash.js");function O(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const j="Not available to collection run items";let D=(0,d.observer)(((n=class extends a.Component{constructor(e){var t,s,o,i;super(e),t=this,s="collectionStore",i=this,(o=r)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.handleSelect=this.handleSelect.bind(this),this.handleShortcutSelect=this.handleShortcutSelect.bind(this),this.handleToggle=this.handleToggle.bind(this),this.workspaceReactionDisposer=null}async componentDidMount(){const e=(0,I.resolveStoreInstance)(E.default);this.workspaceReactionDisposer=(0,h.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,w.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUnmount(){this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}getKeymapHandlers(){return{delete:pm.shortcuts.handle("delete",this.handleShortcutSelect.bind(this,S.ACTION_TYPE_DELETE))}}handleShortcutSelect(e){pm.mediator.trigger("focusSidebar"),this.handleSelect(e)}handleSelect(e){this.props.onSelect&&this.props.onSelect(e),this.handleToggle(!1)}handleToggle(e){this.props.onToggle&&this.props.onToggle(e)}getDropDownActionWrapperClasses(){return c()({"collection-sidebar-request-dropdown-actions-wrapper":!0})}getDisabledText(e){if(e)return(0,I.resolveStoreInstance)(v.default).userCanSave?g.DISABLED_TOOLTIP_NO_PERMISSION:g.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t){return e?t?j:g.DISABLED_TOOLTIP_NO_PERMISSION:g.DISABLED_TOOLTIP_IS_OFFLINE}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}render(){const e=y.default.pluralize({count:this.props.count,singular:"Request",plural:"Requests"}),{userCanSave:t}=(0,I.resolveStoreInstance)(v.default),s=(0,I.resolveStoreInstance)(f.default),o=s&&s.permissions,i=!A.get(o,C.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),r=!A.get(o,C.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),n=t&&A.get(o,C.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),l=!A.isEmpty(this.editableCollections),c=A.get(o,C.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),d=l||c;return a.createElement("div",{className:this.getDropDownActionWrapperClasses()},a.createElement(u.Dropdown,{keyMapHandlers:this.getKeymapHandlers(),ref:"menu",onSelect:this.handleSelect,onToggle:this.handleToggle,className:"collection-sidebar-request-actions-dropdown history-sidebar-multiple-request-selected-dropdown"},a.createElement(u.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},a.createElement(m.Button,{className:"history-sidebar-list-item__button__options",tooltip:T.ACTION_TYPE_VIEW_MORE_ACTIONS_TOOLTIP}," ",a.createElement(p.default,{name:"icon-action-options-stroke",className:"history-sidebar-list-item__actions__options pm-icon pm-icon-normal"}))),a.createElement(u.DropdownMenu,{"align-right":!0},a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_SAVE,disabled:!t||this.props.disableRequestSpecificActions||!d,disabledText:this.getAddRequestTooltip(t,d)},a.createElement("div",{className:"dropdown-menu-item-label"},`Save ${e}`)),a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_MONITOR,disabled:!t||this.props.disableRequestSpecificActions||r,disabledText:t?this.props.disableRequestSpecificActions?j:g.DISABLED_TOOLTIP_WORKSPACE_VIEWER:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Monitor ${e}`)),a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_DOCUMENT,disabled:!t||this.props.disableRequestSpecificActions,disabledText:t?this.props.disableRequestSpecificActions?j:b.DISABLED_IN_SCRATCHPAD_TOOLTIP:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Document ${e}`)),a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_MOCK,disabled:!t||this.props.disableRequestSpecificActions||i,disabledText:t?this.props.disableRequestSpecificActions?j:g.DISABLED_TOOLTIP_WORKSPACE_VIEWER:g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},`Mock ${e}`)),"browser"!==window.SDK_PLATFORM&&a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_DOWNLOAD,disabled:!t||!this.props.disableRequestSpecificActions,disabledText:t?"You can only export collection runs":g.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Export")),a.createElement(u.MenuItem,{refKey:S.ACTION_TYPE_DELETE,disabled:!n,disabledText:this.getDisabledText(!n)},a.createElement("div",{className:"dropdown-menu-item-label"},"Delete"),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,_.getShortcutByName)("delete"))))))}}).collectionPermissions=["edit"],r=O((i=n).prototype,"collectionStore",[h.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O(i.prototype,"setCollectionStore",[h.action],Object.getOwnPropertyDescriptor(i.prototype,"setCollectionStore"),i.prototype),O(i.prototype,"editableCollections",[h.computed],Object.getOwnPropertyDescriptor(i.prototype,"editableCollections"),i.prototype),o=i))||o},"./runtime-repl/history/HistoryListCollectionRunItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/classnames/index.js"),a=s.n(n),l=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),c=s("./node_modules/moment/moment.js"),d=s.n(c),h=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),p=s("./js/components/base/Buttons.js"),u=s("./js/components/base/Avatar.js"),m=s("./js/components/base/Tooltips.js"),y=s("./runtime-repl/history/HistoryActionsConstants.js"),S=s("./runtime-repl/_common/DisabledTooltipConstants.js"),b=s("./js/stores/PermissionStore.js"),g=s("./js/stores/CurrentUserStore.js"),f=s("./js/stores/StoreManager.js"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListItem.js");let E=(0,h.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleRemoveRun=this.handleRemoveRun.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"collectionrun"},t)}getClasses(){return a()({"history-sidebar-list-item":!0,"history-sidebar-list-item__collection":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{runs:[this.props.id]})}handleRemoveRun(e){e.stopPropagation(),this.handleDropdownActionSelect(y.ACTION_TYPE_DELETE)}getTooltipText(e){return e?(0,f.resolveStoreInstance)(v.default).userCanSave?S.DISABLED_TOOLTIP_NO_PERMISSION:S.DISABLED_TOOLTIP_IS_OFFLINE:"Delete collection run"}getLeftAlignedComponents(e,t){const s=a()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return i.createElement("div",{className:"history-sidebar__indent"});const o=(0,f.resolveStoreInstance)(g.default).teamMembers.get(this.props.owner),r=o&&(o.name||o.username);return i.createElement("div",{className:s,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(u.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(l.default,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&i.createElement(m.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(m.TooltipBody,null,i.createElement("div",null,i.createElement("div",null,r),i.createElement("div",null,d()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e,t){const s=a()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const o=(0,f.resolveStoreInstance)(b.default),{userCanSave:r}=(0,f.resolveStoreInstance)(v.default),n=r&&o.can("delete","collectionrun",this.props.id);return i.createElement("div",{className:s},i.createElement(p.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRun,disabled:!n,tooltip:this.getTooltipText(!n)},i.createElement(l.default,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}render(){return i.createElement(I.default,{"data-index":this.props.index,text:this.props.name,icon:"icon-action-run-stroke",isSelected:this.props.selected,onClick:this.handleSelect,className:this.getClasses(),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,entity:{routeIdentifier:"build.run.open",routeParams:{rid:this.props.id}},routeConfig:{routeIdentifier:"build.run.open",routeParams:{rid:this.props.id},isNonLink:!0}})}})||o},"./runtime-repl/history/HistoryListErrorItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return i}});var o=s("../../node_modules/react/index.js");function i(e){return o.createElement("div",{className:"history-sidebar-list-item-group"},o.createElement("div",{className:"history-sidebar-list-item-group__error"},"Unable to load items."," ",o.createElement("span",{onClick:e.onRetry},"Retry")))}},"./runtime-repl/history/HistoryListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return z}});var o,i,r,n,a=s("../../node_modules/react/index.js"),l=s("../../node_modules/react-dom/index.js"),c=s("./node_modules/classnames/index.js"),d=s.n(c),h=s("./node_modules/moment/moment.js"),p=s.n(h),u=s("../../node_modules/mobx/lib/mobx.module.js"),m=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),y=s("../../node_modules/@postman/aether/esmLib/src/components/Menu/MenuItem.js"),S=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),b=s("./js/components/base/Buttons.js"),g=s("./js/components/base/Dropdowns.js"),f=s("./js/components/base/Avatar.js"),v=s("./js/components/base/Tooltips.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),E=s("./runtime-repl/history/HistoryActionsConstants.js"),T=s("./runtime-repl/_common/DisabledTooltipConstants.js"),_=s("./runtime-repl/_common/ScratchpadConstants.js"),w=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),C=s("./js/stores/OnlineStatusStore.js"),A=s("./js/stores/PermissionStore.js"),O=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),j=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),D=s("./runtime-repl/request-http/RequestIcon.js"),R=s("./js/controllers/ShortcutsList.js"),k=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),N=s("./collaboration/workspace/types/PermissionTypes.ts"),H=s("./runtime-repl/_common/uid-helper.ts"),P=s("./js/utils/TabOpeningUtil.js"),L=s("./appsdk/workbench/WorkbenchService.js"),x=s("./js/stores/StoreManager.js"),M=s("./js/stores/CurrentUserStore.js"),W=s("./node_modules/lodash/lodash.js");function q(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let z=(0,m.observer)(((n=class extends a.Component{constructor(e){var t,s,o,i;super(e),t=this,s="collectionStore",i=this,(o=r)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0}),this.state={dropdownOpen:!1,isTooltipVisible:!1},this.userAvatar=a.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this),this.workspaceReactionDisposer=null,this.getAetherMenuItems=this.getAetherMenuItems.bind(this)}async componentDidMount(){this.selfNode=(0,l.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode);const e=(0,x.resolveStoreInstance)(O.default);this.workspaceReactionDisposer=(0,u.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,k.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,l.findDOMNode)(this);if(!e)return;e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index),this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"request"},t)}getClasses(){return d()({"history-sidebar-list-item":!0,"history-sidebar-list-item__request":!0,"is-hovered":this.state.dropdownOpen,"is-selected":this.props.selected})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){this.props.onSelectAction(e,{requests:[this.props.id],from:"history_single"})}handleOpenInNewTab(){return(0,P.openInNewBrowserTab)("build.history",{hid:(0,H.composeUID)(this.props.id,this.props.owner)})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(E.ACTION_TYPE_SAVE,{from:"history_single"})}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(E.ACTION_TYPE_DELETE)}getTooltipText(e,t){return e?t?T.DISABLED_TOOLTIP_IS_OFFLINE:T.DISABLED_TOOLTIP_NO_PERMISSION:j.ACTION_TYPE_DELETE_REQUEST_TOOLTIP}getDisabledText(e,t){return t?T.DISABLED_TOOLTIP_IS_OFFLINE:T.DISABLED_TOOLTIP_NO_PERMISSION}getLeftAlignedComponents(e,t){var s;const o=d()({"history-sidebar-list-item-updatedBy":!0,hovered:e});if(!e&&!t)return a.createElement("div",{className:"history-sidebar__indent"});const i=(0,x.resolveStoreInstance)(M.default),r=i.isCurrentUserPartner?null===(s=i.partnerMembersByIds)||void 0===s?void 0:s[this.props.lastUpdatedBy]:i.teamMembers.get(this.props.lastUpdatedBy),n=r&&(r.name||r.username);return a.createElement("div",{className:o,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.lastUpdatedBy&&"0"!==this.props.lastUpdatedBy?a.createElement(f.default,{ref:this.userAvatar,size:"small",userId:this.props.lastUpdatedBy}):a.createElement(S.default,{name:"icon-descriptive-user-stroke",className:"pm-icon pm-icon-normal"}),this.userAvatar.current&&a.createElement(v.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},a.createElement(v.TooltipBody,null,a.createElement("div",null,a.createElement("div",null,n),a.createElement("div",null,p()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getSaveRequestTooltip(e,t){return e?t?j.ACTION_TYPE_SAVE_REQUEST_TOOLTIP:T.DISABLED_TOOLTIP_NO_PERMISSION:T.DISABLED_TOOLTIP_IS_OFFLINE}getRightAlignedComponents(e,t){const s=d()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e&&!t)return null;const o=(0,x.resolveStoreInstance)(A.default),{userCanSave:i}=(0,x.resolveStoreInstance)(C.default),r=i&&o.can("delete","history",this.props.id),n=!W.isEmpty(this.editableCollections),l=(0,x.resolveStoreInstance)(w.default),c=l&&l.permissions,h=W.get(c,N.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),p=n||h;return a.createElement("div",{className:s},a.createElement(b.Button,{className:"history-sidebar-list-item__button__add",type:"icon",onClick:this.handleAddRequestToCollectionClick,disabled:!i||!p,tooltip:this.getSaveRequestTooltip(i,p)},a.createElement(S.default,{size:"large",name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),a.createElement(b.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!r,tooltip:this.getTooltipText(!r,!i)},a.createElement(S.default,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})))}getDisabledTooltip(e,t){return e?t?T.DISABLED_TOOLTIP_WORKSPACE_VIEWER:_.DISABLED_IN_SCRATCHPAD_TOOLTIP:T.DISABLED_TOOLTIP_IS_OFFLINE}getActionsMenuItems(e){const{userCanSave:t,userCanSaveAndSync:s}=(0,x.resolveStoreInstance)(C.default),o=(0,x.resolveStoreInstance)(w.default),i=o&&o.permissions,r=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),n=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),l=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),c=!W.isEmpty(this.editableCollections),d=W.get(i,N.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),h=c||d;return a.createElement(g.DropdownMenu,{"align-right":!0},a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_SAVE,disabled:!t||!h,disabledText:this.getSaveRequestTooltip(t,h)},a.createElement("div",{className:"dropdown-menu-item-label"},"Save Request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_MONITOR,disabled:!s||n,disabledText:t?T.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Monitor Request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_DOCUMENT,disabled:!s||l,disabledText:this.getDisabledTooltip(t,l)},a.createElement("div",{className:"dropdown-menu-item-label"},"Document Request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_MOCK,disabled:!s||r,disabledText:t?T.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_TOOLTIP_IS_OFFLINE},a.createElement("div",{className:"dropdown-menu-item-label"},"Mock Request")),a.createElement(g.MenuItem,{refKey:E.ACTION_TYPE_DELETE,disabled:!t||!e,disabledText:this.getDisabledText(!t)},a.createElement("div",{className:"dropdown-menu-item-label"},"Delete"),a.createElement("div",{className:"dropdown-menu-item-shortcut"},(0,R.getShortcutByName)("delete"))))}getAetherMenuItems(e){const{userCanSave:t,userCanSaveAndSync:s}=(0,x.resolveStoreInstance)(C.default),o=(0,x.resolveStoreInstance)(w.default),i=o&&o.permissions,r=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_MOCK_TO_WORKSPACE,!0),n=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_MONITOR_TO_WORKSPACE,!0),l=!W.get(i,N.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),c=!W.isEmpty(this.editableCollections),d=W.get(i,N.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),h=c||d;return[L.default.isUseBrowserTabsActive()&&a.createElement(y.default,{isDisabled:!t,onClick:()=>this.handleOpenInNewTab(),shortcutLabel:(0,R.getShortcutByName)("openInNewBrowserTab"),key:"open-in-new-browser-tab"},"Open In New Tab"),a.createElement(y.default,{isDisabled:!t||!h,tooltip:(!t||!h)&&this.getSaveRequestTooltip(t,h),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_SAVE),key:"save-request"},"Save Request"),a.createElement(y.default,{isDisabled:!s||n,tooltip:(!s||n)&&(t?T.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_TOOLTIP_IS_OFFLINE),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_MONITOR),key:"monitor-request"},"Monitor Request"),a.createElement(y.default,{isDisabled:!s||l,tooltip:(!s||l)&&this.getDisabledTooltip(t,l),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_DOCUMENT),key:"document-request"},"Document Request"),a.createElement(y.default,{isDisabled:!s||r,tooltip:(!s||r)&&(t?T.DISABLED_TOOLTIP_WORKSPACE_VIEWER:T.DISABLED_TOOLTIP_IS_OFFLINE),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_MOCK),key:"mock-request"},"Mock Request"),a.createElement(y.default,{isDisabled:!t||!e,tooltip:(!t||!e)&&this.getDisabledText(!t),onClick:()=>this.handleDropdownActionSelect(E.ACTION_TYPE_DELETE),shortcutLabel:(0,R.getShortcutByName)("delete"),type:"destructive",key:"delete-request"},"Delete")].filter(Boolean)}render(){const e=(0,x.resolveStoreInstance)(A.default).can("delete","history",this.props.id);return a.createElement(I.default,{"data-index":this.props.index,text:this.props.url,onClick:this.handleSelect,isSelected:this.props.selected,icon:a.createElement(D.default,{method:this.props.method||"GET"}),className:this.getClasses(),moreActions:this.getActionsMenuItems(e),rightMetaComponent:this.getRightAlignedComponents,leftMetaComponent:this.getLeftAlignedComponents,onActionsDropdownSelect:this.handleDropdownActionSelect,routeConfig:{routeIdentifier:"build.history",routeParams:{hid:(0,H.composeUID)(this.props.id,this.props.owner)},isNonLink:!0},moreActionsForAetherMenu:L.default.isUseBrowserTabsActive()?this.getAetherMenuItems(e):null})}}).collectionPermissions=["edit"],r=q((i=n).prototype,"collectionStore",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q(i.prototype,"setCollectionStore",[u.action],Object.getOwnPropertyDescriptor(i.prototype,"setCollectionStore"),i.prototype),q(i.prototype,"editableCollections",[u.computed],Object.getOwnPropertyDescriptor(i.prototype,"editableCollections"),i.prototype),o=i))||o},"./runtime-repl/history/HistoryListMetaItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var o,i,r,n=s("../../node_modules/react/index.js"),a=s("../../node_modules/mobx/lib/mobx.module.js"),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("./js/components/base/Buttons.js"),p=s("./runtime-repl/history/HistoryActionsConstants.js"),u=s("./runtime-repl/_common/DisabledTooltipConstants.js"),m=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),y=s("./js/stores/OnlineStatusStore.js"),S=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),b=s("./js/stores/StoreManager.js"),g=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),f=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),v=s("./runtime-repl/collection/_api/CollectionStoreV2.js"),I=s("./collaboration/workspace/types/PermissionTypes.ts"),E=s("./runtime-repl/history/HistoryItemActionsDropdown.js"),T=s("./node_modules/lodash/lodash.js");function _(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}let w=((r=class extends n.PureComponent{constructor(e){var t,s,o,r;super(e),t=this,s="collectionStore",r=this,(o=i)&&Object.defineProperty(t,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(r):void 0}),this.state={dropdownOpen:!1,isHovered:!1},this.store=(0,b.resolveStoreInstance)(g.default),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddRequestToCollectionClick=this.handleAddRequestToCollectionClick.bind(this),this.handleRemoveRequest=this.handleRemoveRequest.bind(this),this.handleMouseEnter=this.handleMouseEnter.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),this.workspaceReactionDisposer=null}async componentDidMount(){const e=(0,b.resolveStoreInstance)(S.default);this.workspaceReactionDisposer=(0,a.reaction)((()=>e.id),(async()=>{if(!e.id)return;this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe();const t=await(0,v.subscribeMeta)(e.id,{permissions:this.constructor.collectionPermissions});this.setCollectionStore(t)}),{fireImmediately:!0})}componentWillUnmount(){this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.workspaceReactionDisposer&&this.workspaceReactionDisposer()}setCollectionStore(e){this.collectionStore=e}get editableCollections(){return this.collectionStore&&this.collectionStore.list&&this.collectionStore.list.filter((e=>e.isEditable))}handleMouseEnter(){this.setState({isHovered:!0})}handleMouseLeave(){!this.state.dropdownOpen&&this.setState({isHovered:!1})}getCollapseButtonClasses(){return c()({caret:!0,"pm-icon":!0,"pm-icon-normal":!0,"is-closed":this.store.isItemCollapsed(this.props.name)})}getMetaClasses(){return c()({"history-sidebar-list-item-group__meta":!0,"is-hovered":this.state.dropdownOpen})}handleToggleGroup(){const{name:e}=this.props;if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){const t={requests:T.reduce(this.props.items,((e,t)=>("request"===t.type&&e.push(t.id),e)),[]),runs:T.reduce(this.props.items,((e,t)=>("collectionrun"===t.type&&e.push(t.id),e)),[]),websockethistory:T.reduce(this.props.items,((e,t)=>("websockethistory"===t.type&&e.push(t.id),e)),[]),ecitemhistory:T.reduce(this.props.items,((e,t)=>("ecitemhistory"===t.type&&e.push(t.id),e)),[]),proxyhistory:T.reduce(this.props.items,((e,t)=>("proxyhistory"===t.type&&e.push(t.id),e)),[]),defaultCollectionName:this.props.name,from:"history_date_group"};e!==p.ACTION_TYPE_DELETE?this.props.onSelectAction(e,t):pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onSelectAction(e,t)}),{identifier:"selected"})}handleAddRequestToCollectionClick(e){e.stopPropagation(),this.handleDropdownActionSelect(p.ACTION_TYPE_SAVE)}handleRemoveRequest(e){e.stopPropagation(),this.handleDropdownActionSelect(p.ACTION_TYPE_DELETE)}getHistoryDeleteTooltip(e,t){return e?t?f.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:u.DISABLED_TOOLTIP_NO_PERMISSION:u.DISABLED_TOOLTIP_IS_OFFLINE}getAddRequestTooltip(e,t,s){return e?t?s?"Not available to collection run items":f.ACTION_TYPE_SAVE_REQUESTS_TOOLTIP:u.DISABLED_TOOLTIP_NO_PERMISSION:u.DISABLED_TOOLTIP_IS_OFFLINE}render(){const e=T.size(this.store.getSelectedItems())>1,{userCanSave:t}=(0,b.resolveStoreInstance)(y.default),s=(0,b.resolveStoreInstance)(m.default),o=s&&s.permissions,i=T.get(o,I.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),r=!T.isEmpty(this.editableCollections),a=T.get(o,I.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),l=r||a;return n.createElement("div",{className:"history-sidebar-list-item-group",onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n.createElement("div",{className:this.getMetaClasses(),onClick:this.handleToggleGroup},n.createElement("div",{className:"history-sidebar-list-item-group__name"},n.createElement(d.default,{name:"icon-direction-down",className:this.getCollapseButtonClasses()}),n.createElement("span",null,this.props.name)),!e&&this.state.isHovered&&n.createElement("div",{className:"history-sidebar-list-item-group__actions"},n.createElement(h.Button,{className:"history-sidebar-list-item__button__add",type:"icon",disabled:!t||this.props.disableRequestSpecificActions||!l,onClick:this.handleAddRequestToCollectionClick,tooltip:this.getAddRequestTooltip(t,l,this.props.disableRequestSpecificActions)},n.createElement(d.default,{name:"icon-action-add-stroke",className:"history-sidebar-list-item__actions__add pm-icon pm-icon-normal"})),n.createElement(h.Button,{className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleRemoveRequest,disabled:!t||!i,tooltip:this.getHistoryDeleteTooltip(t,i)},n.createElement(d.default,{name:"icon-action-delete-stroke",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),n.createElement(E.default,{count:T.size(this.props.items),onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.props.disableRequestSpecificActions,canAddRequest:this.props.canAddRequest}))))}}).collectionPermissions=["edit"],i=_((o=r).prototype,"collectionStore",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_(o.prototype,"setCollectionStore",[a.action],Object.getOwnPropertyDescriptor(o.prototype,"setCollectionStore"),o.prototype),_(o.prototype,"editableCollections",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"editableCollections"),o.prototype),o)},"./runtime-repl/history/HistorySidebar.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/pure-render-decorator/index.js"),a=s.n(n),l=s("./js/components/base/keymaps/KeyMaps.js"),c=s("./js/components/base/XPaths/XPath.js"),d=s("./runtime-repl/history/HistoryActionsConstants.js"),h=s("./runtime-repl/history/datastores/HistoryListStore.js"),p=s("./js/stores/StoreManager.js"),u=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),m=s("./runtime-repl/history/HistorySidebarMenu.js"),y=s("./runtime-repl/history/HistorySidebarList.js"),S=s("./node_modules/lodash/lodash.js");let b=a()(o=class extends i.Component{constructor(e){super(e),this.store=(0,p.resolveStoreInstance)(u.default),this.historyStore=(0,p.resolveStoreInstance)(h.default),this.focus=this.focus.bind(this),this.groupItems=this.groupItems.bind(this),this.selectNext=this.selectNext.bind(this),this.selectPrev=this.selectPrev.bind(this),this.deleteItem=this.deleteItem.bind(this),this.selectItem=this.selectItem.bind(this),this.multiselectNextItem=this.multiselectNextItem.bind(this),this.multiselectPrevItem=this.multiselectPrevItem.bind(this)}getKeyMapHandlers(){return{groupItems:pm.shortcuts.handle("groupItems",this.groupItems),nextItem:pm.shortcuts.handle("nextItem",this.selectNext),prevItem:pm.shortcuts.handle("prevItem",this.selectPrev),delete:pm.shortcuts.handle("delete",this.deleteItem),multiselectNextItem:pm.shortcuts.handle("multiselectNextItem",this.multiselectNextItem),multiselectPrevItem:pm.shortcuts.handle("multiselectPrevtItem",this.multiselectPrevItem),select:pm.shortcuts.handle("select",this.selectItem),search:pm.shortcuts.handle("search"),saveCurrentRequest:e=>{e&&e.stopPropagation(),this.props.onSaveCurrentRequest()}}}focus(){const e=(0,r.findDOMNode)(this.refs.history);e&&e.focus()}selectNext(e){e&&e.preventDefault();const t=this.store.getNextItem();t&&S.invoke(this,"props.onSelect",t)}selectPrev(e){e&&e.preventDefault();const t=this.store.getPrevItem();t&&S.invoke(this,"props.onSelect",t)}deleteItem(e){if(document.activeElement.classList.contains("history-sidebar__filter"))return;e&&e.preventDefault();const t=this.store.getPrevItem();S.invoke(this,"props.onDeleteMultiple","selected",t)}selectItem(e){e&&e.preventDefault(),S.invoke(this,"refs.list.selectItem")}multiselectNextItem(e){e&&e.preventDefault();const t=this.store.getNextItem();t&&S.invoke(this,"props.onSelect",t,{metaKey:!0})}multiselectPrevItem(e){e&&e.preventDefault();const t=this.store.getPrevItem();t&&S.invoke(this,"props.onSelect",t,{metaKey:!0})}groupItems(){this.props.onSelectAction&&this.props.onSelectAction("all",d.ACTION_TYPE_SAVE,{requests:this.store.getSelectedItems(),from:"history_multiple"})}render(){return i.createElement(l.default,{handlers:this.getKeyMapHandlers(),keyMap:pm.shortcuts.getShortcuts()},i.createElement("div",{className:"history-sidebar",ref:"history"},i.createElement("div",{className:"history-sidebar-wrapper"},i.createElement(m.default,{historySidebar:this.store,historyStore:this.historyStore,enableHistoryResponseSaving:this.props.enableHistoryResponseSaving,isHistorySettingUpdating:this.props.isHistorySettingUpdating,onDeleteMultiple:this.props.onDeleteMultiple,onSelectAction:this.props.onSelectAction.bind(this,"all"),onToggleHistoryResponseSaving:this.props.onToggleHistoryResponseSaving}),i.createElement(c.default,{identifier:"history"},i.createElement(y.default,{ref:"list",initializing:this.props.initializing,isSocketConnected:this.props.isSocketConnected,isLoggedIn:this.props.isLoggedIn,workspace:this.props.workspace,onDeleteMultiple:this.props.onDeleteMultiple,onLoadMore:this.props.onLoadMore,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction})))))}})||o},"./runtime-repl/history/HistorySidebarContainer.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return W}});var o,i=s("../../node_modules/react/index.js"),r=s("./node_modules/@postman/react-click-outside/dist/index.js"),n=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("./runtime-repl/history/datastores/HistoryListStore.js"),c=s("./js/stores/CurrentUserStore.js"),d=s("./js/stores/SyncStatusStore.js"),h=s("./js/stores/ActiveWorkspaceStore.js"),p=s("./js/stores/OnlineStatusStore.js"),u=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),m=s("./runtime-repl/history/datastores/HistorySettingsStore.js"),y=s("./runtime-repl/runner/RunnerRun/RunnerRunStore.js"),S=s("./js/stores/StoreManager.js"),b=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),g=s("./js/modules/model-event.js"),f=s("./js/modules/pipelines/user-action.js"),v=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),I=s("./runtime-repl/history/HistorySidebar.js"),E=s("./runtime-repl/history/HistoryService.js"),T=s("./runtime-repl/history/_api/HistoryInterface.js"),_=s("./js/containers/new-button/CreateNewXService.js"),w=s("./js/modules/services/AnalyticsService.js"),C=s("./js/stores/CurrentUserInfoStore.js"),A=s("./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js"),O=s("./integrations/proxy/services/ProxyHistoryService.js"),j=s("./collaboration/workspace/types/PermissionTypes.ts"),D=s("./js/components/network/NetworkTrouble.js"),R=s("./runtime-repl/runner/workbench/common.js"),k=s("./api-dev/interfaces/APIInterface.js"),N=s("./runtime-repl/runner/_api/RunnerInterface.js"),H=s("./runtime-repl/_common/ToastHelpers.js"),P=s("./runtime-repl/_common/WorkspaceHelpers.js"),L=s("./runtime-repl/history/HistoryActionsConstants.js"),x=s("./runtime-repl/runner/RunnerHelper.js"),M=s("./node_modules/lodash/lodash.js");let W=n()(o=(0,a.observer)(o=class extends i.Component{constructor(e){super(e),this.store=(0,S.resolveStoreInstance)(b.default),this.focus=this.focus.bind(this),this.handleLoadRequestDebounced=M.debounce(this.handleLoadRequest,100,{leading:!0}).bind(this),this.handleLoadCollectionRunDebounced=M.debounce(this.handleLoadCollectionRun,100,{leading:!0}).bind(this),this.handleLoadWebSocketHistoryDebounced=M.debounce(this.handleLoadWebSocketHistory,100,{leading:!0}).bind(this),this.handleLoadECHistoryDebounced=M.debounce(this.handleLoadECHistory,100,{leading:!0}).bind(this),this.handleActiveRequestChange=this.handleActiveRequestChange.bind(this),this.handleAddToCollection=this.handleAddToCollection.bind(this),this.handleDeleteMultiple=this.handleDeleteMultiple.bind(this),this.handleItemSelect=this.handleItemSelect.bind(this),this.handleSelectAction=this.handleSelectAction.bind(this),this.handleSelectHistoryAction=this.handleSelectHistoryAction.bind(this),this.handleSelectCollectionRunAction=this.handleSelectCollectionRunAction.bind(this),this.handleSelectWebSocketHistoryAction=this.handleSelectWebSocketHistoryAction.bind(this),this.handleproxyHistoryAction=this.handleproxyHistoryAction.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("activeRequestChanged",this.handleActiveRequestChange)}componentWillUnmount(){pm.mediator.off("activeRequestChanged",this.handleActiveRequestChange)}focus(){M.invoke(this,"refs.history.focus")}selectNext(){M.invoke(this,"refs.history.selectNext")}handleActiveRequestChange(e){this.store.itemExists(e)?this.store.resetSelection([e]):this.store.resetSelection()}handleClickOutside(e){if(!M.isEmpty(this.store.getSelectedItems())){const t=document.getElementsByClassName("ReactModal__Content")[0],s=document.querySelector(".history-sidebar-multiple-request-selected-dropdown");if(t&&t.contains(e.target)||s&&s.contains(e.target))return;this.store.resetSelection()}}handleLoadRequest(e,t=!1){e&&E.default.openHistoryInTab(e,{newTab:t,preview:!0})}async handleLoadCollectionRun(e,t=!1){if(!e)return;const{uid:s,source:o,context:i}=(0,S.resolveStoreInstance)(y.default).find(e)||{},r=(0,S.resolveStoreInstance)(C.default),n=await(0,R.getParentAPIContext)(null==i?void 0:i.collection).catch((e=>{pm.logger.warn("HistorySidebarContainer~handleLoadCollectionRun: Error while fetching parent api context",e)}));(null==n?void 0:n.id)&&await(0,k.hasAPIMigrated)(null==n?void 0:n.id)?(0,N.openRunInTab)(s,{newTab:t,preview:!t},n):(0,N.openRunInTab)(s,{newTab:t,preview:!t},{}),w.default.addEventV2({category:"history_sidebar",action:"open_run_details_view",label:o,userId:r.id,teamId:r.teamId,entityId:s})}handleLoadWebSocketHistory(e,t=!1){e&&(0,A.openWebSocketHistoryTab)(e,{forceNew:t,preview:!t})}handleLoadECHistory(e,t,s=!1){if(!e)return;const o=pm.ECItemRegistry.getSDK(t);o&&o.openHistoryTab(e,{forceNew:s,preview:!s})}handleItemSelect({id:e,type:t,itemType:s},o={}){const i=M.includes(navigator.platform,"Mac");o.shiftKey&&(i?o.metaKey:o.ctrlKey)?("collectionrun"===t?this.handleLoadCollectionRunDebounced(e,!0):"websockethistory"===t?this.handleLoadWebSocketHistoryDebounced(e,!0):"ecitemhistory"===t?this.handleLoadECHistoryDebounced(e,s,!0):this.handleLoadRequestDebounced(e,!0),pm.mediator.trigger("focusSidebar")):o.ctrlKey||o.metaKey?this.store.isItemSelected(e)?this.store.unselectItem(e):this.store.selectItem(e):("collectionrun"===t?this.handleLoadCollectionRunDebounced(e,!1):"websockethistory"===t?this.handleLoadWebSocketHistoryDebounced(e,!1):"ecitemhistory"===t?this.handleLoadECHistoryDebounced(e,s,!1):this.handleLoadRequestDebounced(e,!1),pm.mediator.trigger("focusSidebar"),this.store.resetSelection([e]))}handleAddToCollection(e={}){const{requests:t}=e,s=M.isEmpty(t)?this.store.getSelectedItems():t;M.isEmpty(s)||(0,T.convertHistoryToRequests)(s,{populateIfPartial:!0}).then((t=>{1===M.size(t)?t[0]&&pm.mediator.trigger("showAddToCollectionModal",t[0],{from:e.from}):pm.mediator.trigger("addRequestsToCollection",t,e)}))}handleToggleHistoryResponseSaving(){if(!(0,P.isWorkspaceMember)())return(0,P.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,P.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_save_response"});const e=(0,S.resolveStoreInstance)(m.default),t={enableHistoryResponseSaving:!(e&&e.enableHistoryResponseSaving)};return e.updateSettings(t)}resetHistorySelection(e){e&&e.id?this.store.resetSelection([e.id]):this.store.resetSelection()}handleDeleteMultiple(e,t){const s=(0,S.resolveStoreInstance)(y.default),o=(0,S.resolveStoreInstance)(u.default),i=o&&o.permissions,r=M.get(i,j.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0);return(0,P.isWorkspaceMember)()?(0,S.resolveStoreInstance)(p.default).userCanSave?Promise.resolve().then((()=>{if("all"===e){const e=(0,S.resolveStoreInstance)(h.default).id;(0,f.default)((0,g.createEvent)("deleteAllInWorkspace","history",e)),s.deleteRun(M.map(s.values,(e=>e.id))),v.default.deleteAllHistory(e),(0,A.deleteAllWebSocketHistory)(),O.default.deleteProxyHistory()}else if("selected"===e){r?(0,f.default)((0,g.createEvent)("deleteMultiple","history",{ids:this.store.getSelectedItems()},null,null)):pm.toasts.error("You do not have permissions to delete history."),r?(0,S.resolveStoreInstance)(y.default).deleteRun(this.store.getSelectedItems()):pm.toasts.error("You do not have permissions to delete collection runs.");const e=(0,S.resolveStoreInstance)(h.default).id,t=this.store.getSelectedItems(),s=new Set,o=new Set;M.forEach(this.store.historyItems,(e=>{"ecitemhistory"===(null==e?void 0:e.type)&&s.add(e.id),"websockethistory"===(null==e?void 0:e.type)&&o.add(e.id)}));const i=M.filter(t,(e=>s.has(e))),n=M.filter(t,(e=>o.has(e)));v.default.deleteManyHistory(e,i),(0,A.deleteOneOrManyWebSocketHistory)(n),O.default.deleteProxyHistory(this.store.getSelectedItems())}})).then((()=>{this.resetHistorySelection(t)})).catch((()=>{this.resetHistorySelection(t)})):(0,H.showOfflineActionDisabledToast)():(0,P.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,P.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:"history_delete_multiple"})}handleAddRequestToService(e,t){const{requests:s,defaultCollectionName:o="",from:i=""}=e,r=M.isEmpty(s)?this.store.getSelectedItems():s;M.isEmpty(r)||(0,T.convertHistoryToRequests)(r,{populateIfPartial:e.populateIfPartial,populateResponse:e.populateResponse}).then((e=>{if(!M.isEmpty(e)){const s={name:o,from:i};_.default.create(t,{requests:e,opts:s},null,{from:"history_sidebar"})}}))}handleSelectHistoryAction(e,t){switch(e){case L.ACTION_TYPE_SAVE:if(!(0,S.resolveStoreInstance)(p.default).userCanSave)return(0,H.showOfflineActionDisabledToast)();this.handleAddToCollection(t);break;case L.ACTION_TYPE_MONITOR:this.handleAddRequestToService(t,"openCreateNewMonitorModal");break;case L.ACTION_TYPE_DOCUMENT:this.handleAddRequestToService(t,"openCreateNewDocumentationModal");break;case L.ACTION_TYPE_MOCK:this.handleAddRequestToService(M.assign(t,{populateIfPartial:!0,populateResponse:!0}),"openCreateNewMockModal");break;case L.ACTION_TYPE_DELETE:if(!(0,S.resolveStoreInstance)(p.default).userCanSave)return(0,H.showOfflineActionDisabledToast)();(0,f.default)((0,g.createEvent)("deleteMultiple","history",{ids:t.requests},null,null))}}handleSelectCollectionRunAction(e,t){switch(e){case L.ACTION_TYPE_DELETE:if(!(0,S.resolveStoreInstance)(p.default).userCanSave)return(0,H.showOfflineActionDisabledToast)();(0,S.resolveStoreInstance)(y.default).deleteRun(t.runs);break;case L.ACTION_TYPE_DOWNLOAD:return(0,x.exportRuns)(t.runs);default:pm.logger.warn(`HistorySidebarContainer~handleSelectCollectionRunAction: ${e} - action not handled`)}}handleSelectWebSocketHistoryAction(e,t){if(e===L.ACTION_TYPE_DELETE){if(!(0,S.resolveStoreInstance)(p.default).userCanSave)return(0,H.showOfflineActionDisabledToast)();(0,A.deleteOneOrManyWebSocketHistory)(t.websockethistory)}}handleSelectECHistoryAction(e,t){if(e===L.ACTION_TYPE_DELETE){if(!(0,S.resolveStoreInstance)(p.default).userCanSave)return(0,H.showOfflineActionDisabledToast)();v.default.deleteManyHistory((0,S.resolveStoreInstance)(h.default).id,t.ecitemhistory)}}async handleproxyHistoryAction(e,t){if(e===L.ACTION_TYPE_DELETE)try{await O.default.deleteProxyHistory(t.proxyhistory)}catch(e){pm.toasts.error("The proxy session is in progress")}}handleSelectAction(e,t,s){return(0,P.isWorkspaceMember)()?"collectionrun"===e?(1===M.size(s.runs)&&t===L.ACTION_TYPE_DELETE&&this.store.unselectItem(s.runs[0]),s.runs&&this.handleSelectCollectionRunAction(t,s)):"websockethistory"===e?(1===M.size(s.websockethistory)&&t===L.ACTION_TYPE_DELETE&&this.store.unselectItem(s.websockethistory[0]),s.websockethistory&&this.handleSelectWebSocketHistoryAction(t,s)):"ecitemhistory"===e?(1===M.size(s.ecitemhistory)&&t===L.ACTION_TYPE_DELETE&&this.store.unselectItem(s.ecitemhistory[0]),s.ecitemhistory&&this.handleSelectECHistoryAction(t,s)):"request"===e?(1===M.size(s.requests)&&t===L.ACTION_TYPE_DELETE&&this.store.unselectItem(s.requests[0]),this.handleSelectHistoryAction(t,s)):"proxyhistory"===e?(1===M.size(s.proxyhistory)&&t===L.ACTION_TYPE_DELETE&&this.store.unselectItem(s.proxyhistory[0]),s.proxyhistory&&this.handleproxyHistoryAction(t,s)):void("all"===e&&(s.runs&&this.handleSelectCollectionRunAction(t,s),s.requests&&this.handleSelectHistoryAction(t,s),s.websockethistory&&this.handleSelectWebSocketHistoryAction(t,s),s.ecitemhistory&&this.handleSelectECHistoryAction(t,s),s.proxyhistory&&this.handleproxyHistoryAction(t,s))):(0,P.canJoinWorkspace)()?pm.mediator.trigger("openUnjoinedWorkspaceModal"):(0,P.isLoggedIn)()?pm.toasts.error("You do not have permissions required to perform the action."):pm.mediator.trigger("showSignInModal",{type:"history",origin:`history_${t}`})}render(){const{isConsistentlyOffline:e}=(0,S.resolveStoreInstance)(d.default);if(e&&this.store.loading)return i.createElement(D.default,{origin:"sidebar",entity:"history"});const t=(0,S.resolveStoreInstance)(m.default),s=(0,S.resolveStoreInstance)(d.default),o=(0,S.resolveStoreInstance)(c.default),r=(0,S.resolveStoreInstance)(l.default),n=(0,S.resolveStoreInstance)(h.default),a=t&&t.enableHistoryResponseSaving,p=t&&t.isUpdating;return i.createElement(I.default,{store:this.store,enableHistoryResponseSaving:a,isHistorySettingUpdating:p,initializing:o.isHydrating||r.isHydrating||!n.id,isLoggedIn:o.isLoggedIn,isSocketConnected:s.isSocketConnected,workspace:n.id,onSelectAction:this.handleSelectAction,onDeleteMultiple:this.handleDeleteMultiple,onSelect:this.handleItemSelect,onSaveCurrentRequest:this.handleAddToCollection,onToggleHistoryResponseSaving:this.handleToggleHistoryResponseSaving,ref:"history"})}})||o)||o},"./runtime-repl/history/HistorySidebarController.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var o=s("../../node_modules/mobx/lib/mobx.module.js"),i=s("./js/modules/services/PermissionRemoteFetchService.js"),r=s("./js/stores/StoreManager.js"),n=s("./js/stores/ActiveWorkspaceStore.js"),a=s("./runtime-repl/extensible-collection/history/datastores/ECItemHistoryStore.js"),l=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),c=s("./runtime-repl/history/datastores/HistoryListStore.js"),d=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),h=s("./js/stores/SyncStatusStore.js"),p=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),u=s("./runtime-repl/history/HistoryService.js"),m=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),y=s("./integrations/proxy/services/ProxyHistoryService.js"),S=s("./api-dev/interfaces/APIInterface.js"),b=s("./runtime-repl/history/datastores/controllers/HistoryResponseController.js"),g=s("./js/modules/sync-helpers/create-changeset.js"),f=s("./js/models/sync/services/SyncIncomingHandler.js"),v=s("./runtime-repl/runner/SyncService.js"),I=s("./node_modules/lodash/lodash.js");class E{async didCreate(){let e;this.store=(0,r.resolveStoreInstance)(d.default),this.store.setSearchQuery(""),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>{e=(0,S.getAllAPIs)()})),this.wsHistoryStore=(0,r.resolveStoreInstance)(l.default),this.ecItemHistoryStore=(0,r.resolveStoreInstance)(a.default),this.httpHistoryStore=(0,r.resolveStoreInstance)(c.default),this.currentWorkspace=(0,r.resolveStoreInstance)(n.default).id;const t=await(0,i.fetchViewHistory)(this.currentWorkspace),s=(0,v.fetchMoreRunsInActiveWorkspace)();if(!t[this.currentWorkspace].allowed)return Promise.resolve();(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>u.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.httpSubscription=e,this.httpSubscription.subscribe((({data:e})=>{(0,o.transaction)((()=>{I.forEach(e,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;let i;switch(o){case"create":i=(0,g.default)("history","create",{instance:I.merge(s,{id:t,workspace:this.currentWorkspace,isPartial:!0}),modelId:s.id,owner:s.owner}),(0,f.processIncomingChangeset)(i).catch((e=>{pm.logger.warn("HistorySidebarController~didCreate: Could not create history",e)}));case"delete":return this.httpHistoryStore.remove(t),b.default.delete({history:t});case"deleteAll":return this.httpHistoryStore.removeAll(),b.default.clear()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to HTTP history's realtime events",e)})),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>p.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.subscription=e,this.subscription.subscribe((({data:e})=>{(0,o.transaction)((()=>{I.forEach(e,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;switch(o){case"create":return this.wsHistoryStore.add(I.assign({id:t,workspace:this.currentWorkspace},s));case"delete":return this.wsHistoryStore.remove(t);case"deleteAll":return this.wsHistoryStore.removeAll()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to WebSocket history's realtime events",e)})),(0,r.resolveStoreInstance)(h.default).onSyncAvailable({timeout:5e3}).then((()=>m.default.subscribeToRealtimeEvents(this.currentWorkspace))).then((e=>{if(!e)return Promise.reject(new Error("Subscription not found"));this.ecHistorySubscription=e,this.ecHistorySubscription.subscribe((e=>{const{data:t}=e;(0,o.transaction)((()=>{I.forEach(t,(e=>{if(!e)return;const{id:t,value:s,op:o}=e;switch(o){case"HISTORY_CREATE":return this.ecItemHistoryStore.add(I.assign({id:t,workspace:this.currentWorkspace},s));case"HISTORY_DELETE":return this.ecItemHistoryStore.remove(t);case"HISTORY_DELETE_ALL":return this.ecItemHistoryStore.removeAll()}}))}))}))})).catch((e=>{pm.logger.error("HistorySidebarController~didCreate: Error in subscribing to Extensible Item's history realtime events",e)})),await y.default.subscribeSessionEvents(),await s(),await e.catch((e=>{pm.logger.error("HistorySidebarController~didCreate - Error while fetching API details",e)}))}async beforeDestroy(){this.store=null,this.wsHistoryStore=null,this.subscription&&p.default.unsubscribeFromRealtimeEvents(this.currentWorkspace).catch((e=>pm.logger.error("WebSocketWorkbenchController~beforeDestroy: Error in unsubscribing from WebSocket history's realtime events",e))),this.httpSubscription&&u.default.unsubscribeFromRealtimeEvents(this.currentWorkspace).catch((e=>pm.logger.error("HTTPWorkbenchController~beforeDestroy: Error in unsubscribing from HTTP history's realtime events",e))),this.subscription=null,this.httpSubscription=null,this.currentWorkspace=null,await y.default.unsubscribeSessionEvents()}}},"./runtime-repl/history/HistorySidebarErrorState.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return r}});var o=s("../../node_modules/react/index.js"),i=s("./js/components/base/Buttons.js");function r(e){return o.createElement("div",{className:"history-sidebar-list-error"},o.createElement("h4",null,"Couldn't load history"),o.createElement("p",null,"Something went wrong while trying to load history items. Check your internet and try again."),o.createElement(i.Button,{type:"secondary",onClick:e.onRetry},"Retry"))}},"./runtime-repl/history/HistorySidebarList.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("./node_modules/react-window/dist/index.esm.js"),a=s("./node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoPermission.js"),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-state-locked-stroke.js"),p=s("./js/components/base/Buttons.js"),u=s("./js/utils/PluralizeHelper.js"),m=s("./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js"),y=s("./runtime-repl/extensible-collection/history/components/ECHistorySidebarListItem.js"),S=s("./js/stores/ui/sidebar/RequesterSidebarStore.js"),b=s("./js/stores/StoreManager.js"),g=s("./runtime-repl/history/datastores/HistorySidebarStore.js"),f=s("./js/stores/CurrentUserStore.js"),v=s("./runtime-repl/history/HistorySidebarListEmptyItem.js"),I=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),E=s("./runtime-repl/history/HistoryListItem.js"),T=s("./runtime-repl/history/HistoryInfoHeader.js"),_=s("./runtime-repl/history/HistoryListMetaItem.js"),w=s("./runtime-repl/history/HistoryListErrorItem.js"),C=s("./runtime-repl/history/HistoryListCollectionRunItem.js"),A=s("./runtime-repl/history/HistorySidebarErrorState.js"),O=s("./appsdk/sidebar/SidebarLoadingState/SidebarLoadingState.js"),j=s("./integrations/proxy/components/ProxyHistorySidebarListItem.js"),D=s("./node_modules/lodash/lodash.js");function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},R.apply(this,arguments)}let k=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.store=(0,b.resolveStoreInstance)(g.default),this.requesterSidebarStore=(0,b.resolveStoreInstance)(S.default),this.handleToggleGroup=this.handleToggleGroup.bind(this),this.getListItem=this.getListItem.bind(this),this.getItemSize=this.getItemSize.bind(this),this.handleClearCachedHeight=this.handleClearCachedHeight.bind(this),this.observeSizeChange=this.observeSizeChange.bind(this),this.unobserveSizeChange=this.unobserveSizeChange.bind(this),this.handleItemsRender=this.handleItemsRender.bind(this),this.handleItemsRenderDebounced=D.debounce(this.handleItemsRender,1e3),this.handleListScroll=this.handleListScroll.bind(this),this.handleListScrollDebounced=D.debounce(this.handleListScroll,300),this.handleJumpToTop=this.handleJumpToTop.bind(this),this.handleRefresh=this.handleRefresh.bind(this),this.heightSet={},this.resizeObserver=new ResizeObserver((e=>{for(const t of e){if(!(t&&t.target&&t.target.dataset))return;const{index:e}=t.target.dataset;this.heightSet[e]=t.target.offsetHeight}this.handleClearCachedHeight(0)}))}componentDidMount(){this.props.initializing||this.store.load()}componentDidUpdate(e){this.props.initializing||(e.initializing?this.store.load():(this.props.workspace!==e.workspace||this.props.isLoggedIn&&!e.isLoggedIn)&&(this.store.load(),this.listRef&&this.listRef.scrollTo(0),this.store.setScrollOffset(0)))}observeSizeChange(e){this.resizeObserver&&this.resizeObserver.observe(e)}unobserveSizeChange(e,t){this.resizeObserver&&this.resizeObserver.unobserve(e),delete this.heightSet[t]}handleClearCachedHeight(e){this.listRef.resetAfterIndex(e)}handleToggleGroup(e){if(this.store.isItemCollapsed(e))return this.store.expandItem(e);this.store.collapseItem(e)}getItemSize(e){const t=D.get(this.store,["historyItems",e]);return"meta"===t.type||"error"===t.type?28:this.heightSet[e]||28}getListItem(e){const t=D.get(this.store,["historyItems",e.index]);return t?"loading"===t.type?i.createElement("div",{className:"history-list__loading",style:e.style,key:t.key},i.createElement(l.default,null)):"error"===t.type?i.createElement("div",{className:"history-list__error",style:e.style},i.createElement(w.default,{key:t.name,onRetry:()=>"load-error"===t.key?this.store.load(!0):"load-more-error"===t.key?this.store.loadMore():void 0})):"meta"===t.type?i.createElement("div",{className:"history-list__meta",style:e.style},i.createElement(_.default,{name:t.name,key:t.name,onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"all"),items:t.items,disableRequestSpecificActions:t.disableRequestSpecificActions})):"collectionrun"===t.type?i.createElement("div",{className:"history-list__collection-run",style:e.style},i.createElement(C.default,R({},t,{name:t.name,hideActions:D.size(this.store.getSelectedItems())>1,key:t.id,selected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"collectionrun"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"websockethistory"===t.type?i.createElement("div",{className:"history-list__websocket",style:e.style},i.createElement(m.default,R({},t,{key:t.id,isSelected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"websockethistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"ecitemhistory"===t.type?i.createElement("div",{className:"history-list__extensibleitem",style:e.style},i.createElement(y.default,R({},t,{key:t.id,isSelected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,t.type),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):"proxyhistory"===t.type?i.createElement("div",{className:"history-list__proxy",style:e.style},i.createElement(j.default,R({},t,{key:t.id,isSelected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"proxyhistory"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,index:e.index}))):i.createElement("div",{className:"history-list__item",style:e.style},i.createElement(E.default,R({},t,{hideActions:D.size(this.store.getSelectedItems())>1,key:t.id,selected:this.store.isItemSelected(t.id),onSelect:this.props.onSelect,onSelectAction:this.props.onSelectAction.bind(this,"request"),observeSizeChange:this.observeSizeChange,unobserveSizeChange:this.unobserveSizeChange,viewLargeBody:this.props.viewLargeBody,index:e.index}))):null}getNotification(){return this.store.showReloadNotification?i.createElement("div",{className:"history-sidebar-list__notification"},i.createElement(p.Button,{type:"primary",size:"small",className:"history-sidebar-list__refresh",onClick:this.handleRefresh},i.createElement(d.default,{name:"icon-action-refresh-stroke",color:"content-color-primary",size:"small",className:"pm-icon"}),"Refresh")):this.store.newHistoryIds.size?i.createElement("div",{className:"history-sidebar-list__notification"},i.createElement(p.Button,{type:"primary",size:"small",className:"history-sidebar-list__more-on-top",onClick:this.handleJumpToTop},i.createElement(d.default,{name:"icon-direction-up",color:"content-color-primary",size:"small",className:"pm-icon"}),i.createElement("span",null,this.store.newHistoryIds.size," ","new"," ",u.default.pluralize({count:this.store.newHistoryIds.size,singular:"item",plural:"items"})))):null}handleListScroll({scrollOffset:e}){0===e&&this.store.newHistoryIds.size&&this.store.showNewHistory(),this.store.setScrollOffset(e)}handleItemsRender(e){this.store.scrolledToEnd||this.store.loadingMore||this.requesterSidebarStore.query||e.overscanStopIndex===e.visibleStopIndex&&this.store.loadMore()}handleJumpToTop(){this.listRef&&this.listRef.scrollTo(0)}handleRefresh(){this.listRef&&this.listRef.scrollTo(0),this.store.load(!0)}render(){const e=(0,b.resolveStoreInstance)(f.default).isCurrentUserPartner,t=e=>i.createElement(r.Observer,null,this.getListItem.bind(this,e)),s=({height:e,width:s})=>i.createElement(r.Observer,null,(()=>i.createElement(n.VariableSizeList,{height:e,itemCount:this.store.historyItems.length,itemSize:this.getItemSize,width:s,ref:e=>{this.listRef=e},overscanCount:10,onItemsRendered:this.handleItemsRenderDebounced,onScroll:this.handleListScrollDebounced},t)));return D.isEmpty(this.store.historyItems)?this.props.initializing||this.store.loading?i.createElement("div",{className:"history-sidebar-list"},i.createElement(O.default,{hasHierarchy:!0})):this.store.loadError?"You don't have permission to view history in this workspace"===this.store.loadError.message?i.createElement("div",{className:"history-sidebar-list-permission-error"},i.createElement(I.default,{illustration:i.createElement(c.default,null),title:"You don't have permission to view history",message:"Only team members can view history of this workspace"})):i.createElement("div",{className:"history-sidebar-list"},i.createElement(A.default,{onRetry:()=>this.store.load(!0)})):i.createElement("div",{className:"history-sidebar-list"},i.createElement(v.default,{query:this.store.searchQuery})):i.createElement("div",{className:"history-sidebar-list",ref:"history"},e&&i.createElement(T.default,{icon:h.default,message:"The history below is only visible to you."}),this.getNotification(),i.createElement(a.default,null,s))}})||o},"./runtime-repl/history/HistorySidebarListEmptyItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),n=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoHistory.js"),a=s("./js/constants/AppUrlConstants.js"),l=s("./js/external-navigation/ExternalNavigationService.js"),c=s("./appsdk/sidebar/SidebarEmptyState/SidebarEmptyState.js"),d=s("./appsdk/sidebar/SidebarNoResultsFound/SidebarNoResultsFound.js");let h=(0,r.observer)(o=class extends i.Component{constructor(e){super(e),this.handleShowMeHow=this.handleShowMeHow.bind(this)}handleShowMeHow(){(0,l.openExternalLink)(a.SEND_FIRST_REQUEST_DOCS,"_blank")}render(){return this.props.query?i.createElement(d.default,{searchQuery:this.props.query,illustration:i.createElement(n.default,null)}):i.createElement(c.default,{illustration:i.createElement(n.default,null),title:"You haven't sent any requests.",message:"Any request you send in this workspace will appear here.",action:{label:"Show me how",handler:this.handleShowMeHow}})}})||o},"./runtime-repl/history/HistorySidebarMenu.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return A}});var o,i=s("../../node_modules/react/index.js"),r=s("./node_modules/classnames/index.js"),n=s.n(r),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),d=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("./js/components/base/Buttons.js"),p=s("./js/components/base/ToggleSwitch.js"),u=s("./js/components/base/Dropdowns.js"),m=s("./js/components/base/Tooltips.js"),y=s("./runtime-repl/_common/ToastHelpers.js"),S=s("./runtime-repl/history/HistoryActionsConstants.js"),b=s("./runtime-repl/runner/RunnerHelper.js"),g=s("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),f=s("./js/stores/StoreManager.js"),v=s("./js/stores/OnlineStatusStore.js"),I=s("./js/containers/apps/requester/sidebar/SidebarListActions.js"),E=s("./runtime-repl/_common/DisabledTooltipConstants.js"),T=s("./collaboration/workspace/types/PermissionTypes.ts"),_=s("./runtime-repl/history/HistoryActionsTooltipConstants.js"),w=s("./runtime-repl/history/HistoryItemActionsDropdown.js"),C=s("./node_modules/lodash/lodash.js");let A=(0,a.observer)(o=class extends i.Component{constructor(e){super(e),this.state={dropdownOpen:!1,showResponseToggleTooltip:!1,loading:!1},this.handleDeleteClick=this.handleDeleteClick.bind(this),this.handleDropdownToggle=this.handleDropdownToggle.bind(this),this.handleDropdownActionSelect=this.handleDropdownActionSelect.bind(this),this.handleAddToCollectionClick=this.handleAddToCollectionClick.bind(this),this.handleDeleteSelected=this.handleDeleteSelected.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleActionsDropdownSelect=this.handleActionsDropdownSelect.bind(this),this.handleSaveResponseToggle=this.handleSaveResponseToggle.bind(this),this.showResponseToggleTooltip=this.showResponseToggleTooltip.bind(this),this.hideResponseToggleTooltip=this.hideResponseToggleTooltip.bind(this),this.disableRequestItemOptions=this.disableRequestItemOptions.bind(this)}handleAddToCollectionClick(e){e.stopPropagation(),this.props.onSelectAction(S.ACTION_TYPE_SAVE,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleDeleteClick(){pm.mediator.trigger("showDeleteHistoryModal",(async()=>{try{this.props.onDeleteMultiple&&await this.props.onDeleteMultiple("all")}catch(e){pm.logger.error("Could not delete history",e),pm.toasts.error("Could not delete history")}}),{identifier:"all"})}handleDropdownToggle(e){e!==this.state.dropdownOpen&&this.setState({dropdownOpen:e})}handleDropdownActionSelect(e){return e===S.ACTION_TYPE_DELETE?(0,f.resolveStoreInstance)(v.default).userCanSave?void pm.mediator.trigger("showDeleteHistoryModal",(()=>{this.props.onDeleteMultiple("selected")}),{identifier:"selected"}):(0,y.showOfflineActionDisabledToast)():e===S.ACTION_TYPE_DOWNLOAD?(this.setState({loading:!0}),void(0,b.exportRuns)(this.props.historySidebar.getSelectedItems()).finally((()=>{this.setState({loading:!1})}))):void this.props.onSelectAction(e,{requests:this.props.historySidebar.getSelectedItems(),from:"history_multiple"})}handleActionsDropdownSelect(e){if("history-sidebar--clear-all"===e)this.handleDeleteClick()}handleDeleteSelected(){this.handleDropdownActionSelect(S.ACTION_TYPE_DELETE)}disableRequestItemOptions(){const e=C.filter(this.props.historySidebar.historyItems,(e=>this.props.historySidebar.selectedItems.has(e.id)&&"request"===e.type));return C.isEmpty(e)}showResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!0})}hideResponseToggleTooltip(){this.setState({showResponseToggleTooltip:!1})}handleSaveResponseToggle(e){e&&e.stopPropagation(),this.props.onToggleHistoryResponseSaving&&this.props.onToggleHistoryResponseSaving()}handleSearchChange(e){this.props.historySidebar.setSearchQuery(e)}getToggleSaveResponseClasses(e){return n()({"dropdown-menu-item history-sidebar-menu__actions-save-response-toggle":!0,"is-disabled":e})}getDeleteHistoryTooltip(e,t){return e?t?_.ACTION_TYPE_DELETE_REQUESTS_TOOLTIP:E.DISABLED_TOOLTIP_NO_PERMISSION:E.DISABLED_TOOLTIP_IS_OFFLINE}render(){const e=this.props.historySidebar.selectedItems.size,{userCanSave:t}=(0,f.resolveStoreInstance)(v.default),s=(0,f.resolveStoreInstance)(g.default),o=s&&s.permissions,r=C.get(o,T.WORKSPACE_PERMISSIONS.REMOVE_HISTORY_FROM_WORKSPACE,!0),n=!t||!r,a=!C.get(o,T.WORKSPACE_PERMISSIONS.UPDATE_WORKSPACE_META,!0);return e>1?i.createElement("div",{className:"history-sidebar-menu multiple-request-selected"},i.createElement("div",{className:"history-sidebar-menu__left"},i.createElement(l.default,{type:"body-small",color:"content-color-primary"},e," ","items selected")),i.createElement("div",{className:"history-sidebar-menu__right"},i.createElement("div",{className:"history-sidebar-menu__actions-delete-history-wrapper"},i.createElement(h.Button,{disabled:!t||!r,className:"history-sidebar-list-item__button__delete",type:"icon",onClick:this.handleDeleteSelected,tooltip:this.getDeleteHistoryTooltip(t,r)},i.createElement(d.default,{name:"icon-action-delete-stroke",size:"large",className:"history-sidebar-list-item__actions__delete pm-icon pm-icon-normal"})),this.state.loading?i.createElement("div",{className:"history-sidebar-menu__actions-spinner-wrapper"},i.createElement(c.default,null)):i.createElement(w.default,{count:e,onSelect:this.handleDropdownActionSelect,onToggle:this.handleDropdownToggle,disableRequestSpecificActions:this.disableRequestItemOptions()})))):i.createElement("div",{className:"history-sidebar-menu"},i.createElement(I.default,{className:"history-sidebar__filter",onSearch:this.handleSearchChange,onActionsDropdownSelect:this.handleActionsDropdownSelect,searchQuery:this.props.historySidebar.searchQuery,moreActions:i.createElement(u.DropdownMenu,{className:"history-sidebar__header-actions-dropdown--menu"},!C.isEmpty(this.props.historySidebar.historyItems)&&i.createElement(u.MenuItem,{className:"history-sidebar__header-actions-dropdown--menu-item history-sidebar-menu__actions-delete-history-wrapper",key:"history-sidebar--clear-all",refKey:"history-sidebar--clear-all",disabled:n,disabledText:t?E.DISABLED_TOOLTIP_NO_PERMISSION:"You need to be online to clear history."},i.createElement("span",null,"Clear all")),i.createElement("div",{className:this.getToggleSaveResponseClasses(a||this.props.isHistorySettingUpdating),onClick:a?void 0:this.handleSaveResponseToggle,ref:e=>{this.saveResponseToggleContainerRef=e},onMouseEnter:this.showResponseToggleTooltip,onMouseLeave:this.hideResponseToggleTooltip},this.props.isHistorySettingUpdating?this.props.enableHistoryResponseSaving?"Disabling...":"Enabling...":"Save Responses",i.createElement(p.default,{isActive:this.props.enableHistoryResponseSaving,activeLabel:"",inactiveLabel:"",disabled:a||this.props.isHistorySettingUpdating}),i.createElement(m.Tooltip,{className:"history-sidebar-menu--save-response__tooltip",show:this.state.showResponseToggleTooltip,target:this.saveResponseToggleContainerRef},i.createElement(m.TooltipBody,null,a?"You dont have permission to take this action.":"When turned off, the response headers and body won't be saved, though the response code, time, size, and language will be saved for reporting purposes."))))}))}})||o},"./runtime-repl/history/datastores/HistorySidebarStore.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return X}});var o,i,r,n,a,l,c,d,h,p,u,m,y,S,b,g,f,v,I,E,T,_,w=s("../../node_modules/mobx/lib/mobx.module.js"),C=s("./node_modules/moment/moment.js"),A=s.n(C),O=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),j=s("./runtime-repl/extensible-collection/api/HistorySDK.ts"),D=s("./integrations/proxy/services/ProxyHistoryService.js"),R=s("./js/modules/services/SyncRemoteFetcherService.js"),k=s("./js/modules/pipelines/user-action.js"),N=s("./js/modules/model-event.js"),H=s("./js/modules/services/PermissionRemoteFetchService.js"),P=s("./js/constants/WorkspaceVisibilityConstants.js"),L=s("./js/stores/ListCacheStore.js"),x=s("./js/stores/CurrentUserStore.js"),M=s("./js/stores/SyncStatusStore.js"),W=s("./runtime-repl/runner/RunnerRun/RunnerRunStore.js"),q=s("./js/stores/ActiveWorkspaceStore.js"),z=s("./runtime-repl/extensible-collection/history/datastores/ECItemHistoryStore.js"),B=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),V=s("./integrations/proxy/stores/HistorySidebarProxyStore.js"),Y=s("./js/stores/StoreManager.js"),K=s("./runtime-repl/history/datastores/HistoryListStore.js"),F=s("./integrations/proxy/helpers/constants.ts"),U=s("./node_modules/lodash/lodash.js");function Q(e,t,s,o){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(o):void 0})}function $(e,t,s,o,i){var r={};return Object.keys(o).forEach((function(e){r[e]=o[e]})),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=s.slice().reverse().reduce((function(s,o){return o(e,t,s)||s}),r),i&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(i):void 0,r.initializer=void 0),void 0===r.initializer&&(Object.defineProperty(e,t,r),r=null),r}const G=50;let X=(o=w.action.bound,i=w.action.bound,r=w.action.bound,n=w.action.bound,a=w.action.bound,l=w.action.bound,c=w.action.bound,d=w.action.bound,p=$((h=class{getModelEventListeners(){if(this.modelEvents)return this.modelEvents.namespace?U.assign({[this.modelEvents.namespace]:this.defaultEventListeners},this.modelEvents.customEventListeners):void 0}constructor(){this.defaultEventListeners={},this.modelEvents={namespace:"history",customEventListeners:{history:{created:e=>{this.addHistory(e.id,e.workspace)}}}},Q(this,"selectedItems",p,this),Q(this,"pageCount",u,this),Q(this,"collapsedItems",m,this),Q(this,"visibleHistoryIds",y,this),Q(this,"newHistoryIds",S,this),Q(this,"loading",b,this),Q(this,"loadingMore",g,this),Q(this,"loadError",f,this),Q(this,"loadMoreError",v,this),Q(this,"lowestCursor",I,this),Q(this,"scrolledToEnd",E,this),Q(this,"showReloadNotification",T,this),Q(this,"searchQuery",_,this),this.historyStore=(0,Y.resolveStoreInstance)(K.default),this.websocketHistoryStore=(0,Y.resolveStoreInstance)(B.default),this.ecItemHistoryStore=(0,Y.resolveStoreInstance)(z.default),this.activeWorkspaceStore=(0,Y.resolveStoreInstance)(q.default),this.collectionRunStore=(0,Y.resolveStoreInstance)(W.default),this.syncStatusStore=(0,Y.resolveStoreInstance)(M.default),this.currentUserStore=(0,Y.resolveStoreInstance)(x.default),this.listCacheStore=(0,Y.resolveStoreInstance)(L.default),this.proxyHistoryStore=(0,Y.resolveStoreInstance)(V.default),(0,w.reaction)((()=>this.syncStatusStore.isSocketConnected),(e=>{if(e&&!this.loading&&!this.loadError){const e=U.get(this.historyItems,[0,"items",0]);if(!e)return;const t=this.historyStore.find(e)||{};t.cursor&&t.workspace&&this.fetchHistoryFromServer({sinceId:t.cursor,workspace:t.workspace,count:20}).then((e=>!U.isEmpty(e)&&this.setValue("showReloadNotification",!0))).catch((()=>this.setValue("showReloadNotification",!0)))}})),(0,w.reaction)((()=>this.activeWorkspaceStore.visibilityStatus),(()=>{this.load(!0)})),this.loadedWorkspace=null,this.scrollOffset=0}get historyListCache(){return this.listCacheStore.find(`workspace:${this.activeWorkspaceStore.id}:history`)}setSearchQuery(e){this.searchQuery=e}collapseItem(e){!this.collapsedItems.has(e)&&this.collapsedItems.set(e,!0)}expandItem(e){this.collapsedItems.has(e)&&this.collapsedItems.delete(e)}isItemCollapsed(e){return this.collapsedItems.has(e)}get historyItems(){const e=this.getDateGroups(this.truncatedByPageSize,"createdAt");return this.loadMoreError&&e.push({type:"error",name:"Load more error",key:"load-more-error"}),this.loading&&e.push({type:"loading",name:"Loading",key:"loading"}),this.loadError&&e.length&&e.unshift({type:"error",name:"Load error",key:"load-error"}),e}get truncatedByPageSize(){return U.take(this.sortedByDateCreated,this.pageCount*G+U.size(this.websocketHistoryWithType)+U.size(this.ecHistoryWithType))}get sortedByDateCreated(){return U.orderBy(this.historyAndRuns,["createdAt"],["desc"])}get historyAndRuns(){return U.union(this.historyWithType,this.runsWithType,this.websocketHistoryWithType,this.ecHistoryWithType,this.proxyHistoryWithType)}get historyWithType(){return U.map(this.filteredBySearchQuery,(e=>(e.type="request",e)),[])}get filteredBySearchQuery(){if(!this.searchQuery.trim())return this.workspaceHistory;const e=this.searchQuery.toLowerCase();return U.filter(this.workspaceHistory,(t=>U.includes(t.url&&U.toLower(t.url),e)))}get workspaceHistory(){return this.historyStore.historyInActiveWorkspace.filter((e=>this.visibleHistoryIds.has(e.id)))}get runsWithType(){return U.map(this.runsFilteredBySearchQuery,(e=>(e.type="collectionrun",e)),[])}get runsFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.collectionRunStore.collectionRunsInActiveWorkspace;const e=this.searchQuery.toLowerCase();return U.filter(this.collectionRunStore.collectionRunsInActiveWorkspace,(t=>U.includes(t.name&&U.toLower(t.name),e)))}get websocketHistoryWithType(){return U.map(this.websocketHistoryFilteredBySearchQuery,(e=>(e.type="websockethistory",e)),[])}get websocketHistoryFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.websocketHistoryStore.websocketHistoryInActiveWorkspace;const e=this.searchQuery.toLowerCase();return U.filter(this.websocketHistoryStore.websocketHistoryInActiveWorkspace,(t=>U.includes(t.url&&U.toLower(t.url),e)))}get ecHistoryWithType(){return U.map(this.ecHistoryFilteredBySearchQuery,(e=>(e.type="ecitemhistory",e)),[])}get ecHistoryFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.ecItemHistoryStore.ecHistoryInActiveWorkspace;const e=this.searchQuery.toLowerCase();return U.filter(this.ecItemHistoryStore.ecHistoryInActiveWorkspace,(t=>U.includes(t.url&&U.toLower(t.url),e)))}get proxyHistoryWithType(){return U.map(this.proxyFilteredBySearchQuery,(e=>(e.type="proxyhistory",e)),[])}get proxyFilteredBySearchQuery(){if(!this.searchQuery.trim())return this.proxyHistoryStore.ProxyHistoryInActiveWorkspace;const e=U.toLower(this.searchQuery);return U.filter(this.proxyHistoryStore.ProxyHistoryInActiveWorkspace,(t=>U.includes(U.toLower(t.name),e)))}getVisibleItems(){return U.reduce(this.historyItems,((e,t)=>("meta"!==t.type&&e.push({id:t.id,type:t.type}),e)),[])}selectItem(e){this.selectedItems.has(e)||this.selectedItems.set(e,!0)}unselectItem(e){this.selectedItems.has(e)&&this.selectedItems.delete(e)}resetSelection(e){this.selectedItems.clear(),!e||e instanceof Array?U.forEach(e,(e=>{this.selectItem(e)})):pm.logger.warn("resetSelection needs an Array of history ids.")}getNextItem(){const e=this.getVisibleItems(),t=U.last(this.getSelectedItems()),s=U.findIndex(e,(({id:e})=>e===t));return s+1===U.size(e)?U.last(e):U.inRange(s+1,0,U.size(e))?e[s+1]:U.head(e)}getPrevItem(){const e=this.getVisibleItems(),t=U.last(this.getSelectedItems()),s=U.findIndex(e,(({id:e})=>e===t));return 0===s?U.head(e):U.inRange(s-1,0,U.size(e))?e[s-1]:U.last(e)}isItemSelected(e){return this.selectedItems.has(e)}itemExists(e){return this.historyStore.has(e)}getSelectedItems(){return(0,w.keys)(this.selectedItems)}getDateGroups(e,t,s="MMMM D"){const o=U.groupBy(e,(e=>U.isFunction(e[t])?[]:A()(e[t]).format("YYYY MM DD"))),i=U.map(o,((e,t)=>({name:t,items:e}))),r=U.sortBy(i,(e=>-A()(e.name,"YYYY MM DD").unix())),n=U.map(r,(e=>{const t=A()(e.name,"YYYY MM DD").calendar(null,{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:s,lastWeek:s,nextWeek:s,sameElse:s}),o={name:t,type:"meta",disableRequestSpecificActions:U.isEmpty(U.filter(e.items,(e=>"request"===e.type))),items:U.map(e.items,(e=>({id:e.id,type:e.type})))};if(this.collapsedItems.has(t))return[o];return[o,...U.map(e.items,(e=>(e.parent=t,e)))]}));return U.flatMap(n)}setValue(e,t){this[e]=t}setNewHistoryIds(e){this.newHistoryIds.set(e,!0)}setVisibleHistoryIds(e,t){t?this.visibleHistoryIds.replace(e.map((e=>[e,!0]))):this.visibleHistoryIds.merge(e.map((e=>[e,!0]))),this.visibleHistoryIds.size>G*this.pageCount&&(this.pageCount+=1)}addHistory(e,t){const s=t!==this.activeWorkspaceStore.id,o=this.visibleHistoryIds.has(e);s||o||(0!==this.scrollOffset?this.setNewHistoryIds(e):this.visibleHistoryIds.set(e,!0))}setScrollOffset(e){this.scrollOffset!==e&&(this.scrollOffset=e)}showNewHistory(){const e=[];this.newHistoryIds.forEach(((t,s)=>e.push(s))),this.setVisibleHistoryIds(e),this.pageCount*G<this.visibleHistoryIds.size&&this.setValue("pageCount",this.pageCount+1),this.newHistoryIds.clear()}load(e=!1){const t=this.activeWorkspaceStore.id;if(t){if(t!==this.loadedWorkspace&&(this.setValue("loading",!0),this.setValue("loadingMore",!1),this.setValue("loadError",null),this.setValue("loadMoreError",null),this.setValue("lowestCursor",null),this.setValue("pageCount",1),this.setValue("scrolledToEnd",!1),this.visibleHistoryIds.clear(),this.newHistoryIds.clear(),this.loadedWorkspace=t),!this.currentUserStore.isLoggedIn&&this.activeWorkspaceStore.visibilityStatus!==P.VISIBILITY.public)return this.setVisibleHistoryIds(U.map(this.historyStore.historyInActiveWorkspace,(e=>e.id))),this.setValue("loadError",null),void this.setValue("loading",!1);this.setValue("loadError",null),this.setValue("loading",!0),this.setValue("showReloadNotification",!1),this.syncStatusStore.onSyncAvailable({timeout:1e4}).then((()=>{(0,H.fetchViewHistory)(t).then((s=>s[t].allowed?Promise.allSettled([this.loadHTTPHistory(e),this.loadWSHistory(),this.loadECHistory(),this.loadProxyHistory()]):Promise.reject(new Error("You don't have permission to view history in this workspace")))).catch((e=>{this.setValue("loadError",e)})).finally((()=>{this.setValue("loading",!1)}))})).catch((()=>{this.setVisibleHistoryIds(this.historyStore.historyInActiveWorkspace.map((e=>e.id))),this.setValue("loadError",!0),this.setValue("loading",!1)}))}}loadHTTPHistory(e){const t=this.activeWorkspaceStore.id;return this.fetchHistoryFromServer({workspace:t}).then((s=>this.processServerResponse(s,t,e))).catch((e=>{this.setVisibleHistoryIds(U.map(this.historyStore.historyInActiveWorkspace,(e=>e.id)),!0),this.setValue("loadError",e)}))}loadWSHistory(){const e=this.activeWorkspaceStore.id;return O.default.fetchHistoryList({workspaceId:e}).then((({data:t})=>{(0,w.transaction)((()=>{U.forEach(t,(t=>(0,Y.resolveStoreInstance)(B.default).createOrUpdate(U.assign(t,{workspace:e}))))}))})).catch((e=>{this.setValue("loadError",e)}))}loadECHistory(){const e=this.activeWorkspaceStore.id;return j.default.fetchHistoryList(e).then((({data:t})=>{(0,w.transaction)((()=>{U.forEach(t,(t=>{(0,Y.resolveStoreInstance)(z.default).createOrUpdate(U.assign(t,{workspace:e}))}))}))})).catch((e=>{pm.logger.error(e),this.setValue("loadError",e)}))}loadProxyHistory(){const e=this.activeWorkspaceStore.id;return D.default.getProxyHistoryList({workspaceId:e}).then((e=>{(0,w.transaction)((()=>{U.forEach(e,(e=>{U.get(e,"state")===F.SESSION_STATES.STOPPED&&this.proxyHistoryStore.add(e)}))}))})).catch((e=>{this.setValue("loadError",e)}))}loadMore(){if(this.setValue("loadingMore",!0),this.pageCount*G<this.visibleHistoryIds.size)return this.setValue("pageCount",this.pageCount+1),void this.setValue("loadingMore",!1);if(!(this.currentUserStore.isLoggedIn||this.activeWorkspaceStore.visibilityStatus===P.VISIBILITY.public)||!this.historyListCache||!this.lowestCursor)return void this.setValue("loadingMore",!1);const e=this.activeWorkspaceStore.id,t=this.historyListCache.getRange(this.lowestCursor-1);if(t){const e=this.historyStore.historyInActiveWorkspace.reduce(((e,s)=>(s.cursor<this.lowestCursor&&s.cursor>=t[1]&&e.push(s.id),e)),[]);if(this.setValue("lowestCursor",t[1]),e.length)return this.setVisibleHistoryIds(e),void this.setValue("loadingMore",!1)}this.syncStatusStore.isSocketConnected&&(this.setValue("loadMoreError",null),this.fetchHistoryFromServer({maxId:this.lowestCursor-1,workspace:e}).then((t=>this.processServerResponse(t,e))).catch((e=>{this.setValue("loadMoreError",e)})).finally((()=>{this.setValue("loadingMore",!1)})))}fetchHistoryFromServer({maxId:e,sinceId:t,meta:s=!0,workspace:o,count:i=50}){const r={};return t?r.since_cursor=t:e&&(r.max_cursor=e),R.default.remoteFetch("history","find",{meta:s,...r,workspace:o,count:i,format:"object"})}processServerResponse(e,t,s){if(!e)return;const o=(e||[]).map((e=>({...e.data,archived:U.get(e,"meta.archived",!1)})));if(!o.length)return void this.setValue("scrolledToEnd",!0);o.length<G&&this.setValue("scrolledToEnd",!0);const i=U.last(o),r=this.historyListCache&&this.historyListCache.getRange(i),n=o.map((e=>e.id));let a=i.cursor;return r&&(this.historyStore.historyInActiveWorkspace.forEach((e=>{e.cursor<i.cursor&&e.cursor>r[1]&&n.push(e.id)})),a=r[1]),this.setValue("lowestCursor",a),this.setVisibleHistoryIds(n,s),(0,k.default)((0,N.createEvent)("processHistoryRequestList","history",{workspace:t,requests:o,checkForExistence:!0}))}}).prototype,"selectedItems",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.observable.map()}}),u=$(h.prototype,"pageCount",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=$(h.prototype,"collapsedItems",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.observable.map()}}),y=$(h.prototype,"visibleHistoryIds",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.observable.map()}}),S=$(h.prototype,"newHistoryIds",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.observable.map()}}),b=$(h.prototype,"loading",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),g=$(h.prototype,"loadingMore",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=$(h.prototype,"loadError",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=$(h.prototype,"loadMoreError",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=$(h.prototype,"lowestCursor",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=$(h.prototype,"scrolledToEnd",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=$(h.prototype,"showReloadNotification",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=$(h.prototype,"searchQuery",[w.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),$(h.prototype,"historyListCache",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyListCache"),h.prototype),$(h.prototype,"setSearchQuery",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"setSearchQuery"),h.prototype),$(h.prototype,"collapseItem",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"collapseItem"),h.prototype),$(h.prototype,"expandItem",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"expandItem"),h.prototype),$(h.prototype,"historyItems",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyItems"),h.prototype),$(h.prototype,"truncatedByPageSize",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"truncatedByPageSize"),h.prototype),$(h.prototype,"sortedByDateCreated",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"sortedByDateCreated"),h.prototype),$(h.prototype,"historyAndRuns",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyAndRuns"),h.prototype),$(h.prototype,"historyWithType",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"historyWithType"),h.prototype),$(h.prototype,"filteredBySearchQuery",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"filteredBySearchQuery"),h.prototype),$(h.prototype,"workspaceHistory",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"workspaceHistory"),h.prototype),$(h.prototype,"runsFilteredBySearchQuery",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"runsFilteredBySearchQuery"),h.prototype),$(h.prototype,"websocketHistoryFilteredBySearchQuery",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"websocketHistoryFilteredBySearchQuery"),h.prototype),$(h.prototype,"ecHistoryFilteredBySearchQuery",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"ecHistoryFilteredBySearchQuery"),h.prototype),$(h.prototype,"proxyFilteredBySearchQuery",[w.computed],Object.getOwnPropertyDescriptor(h.prototype,"proxyFilteredBySearchQuery"),h.prototype),$(h.prototype,"selectItem",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"selectItem"),h.prototype),$(h.prototype,"unselectItem",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"unselectItem"),h.prototype),$(h.prototype,"resetSelection",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"resetSelection"),h.prototype),$(h.prototype,"setValue",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"setValue"),h.prototype),$(h.prototype,"setNewHistoryIds",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"setNewHistoryIds"),h.prototype),$(h.prototype,"setVisibleHistoryIds",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"setVisibleHistoryIds"),h.prototype),$(h.prototype,"addHistory",[w.action],Object.getOwnPropertyDescriptor(h.prototype,"addHistory"),h.prototype),$(h.prototype,"setScrollOffset",[o],Object.getOwnPropertyDescriptor(h.prototype,"setScrollOffset"),h.prototype),$(h.prototype,"showNewHistory",[i],Object.getOwnPropertyDescriptor(h.prototype,"showNewHistory"),h.prototype),$(h.prototype,"load",[r],Object.getOwnPropertyDescriptor(h.prototype,"load"),h.prototype),$(h.prototype,"loadHTTPHistory",[n],Object.getOwnPropertyDescriptor(h.prototype,"loadHTTPHistory"),h.prototype),$(h.prototype,"loadWSHistory",[a],Object.getOwnPropertyDescriptor(h.prototype,"loadWSHistory"),h.prototype),$(h.prototype,"loadECHistory",[l],Object.getOwnPropertyDescriptor(h.prototype,"loadECHistory"),h.prototype),$(h.prototype,"loadProxyHistory",[c],Object.getOwnPropertyDescriptor(h.prototype,"loadProxyHistory"),h.prototype),$(h.prototype,"loadMore",[d],Object.getOwnPropertyDescriptor(h.prototype,"loadMore"),h.prototype),h)},"./runtime-repl/request-websocket/base/api/WebSocketRequestInterface.js":function(e,t,s){s.r(t),s.d(t,{deleteAllWebSocketHistory:function(){return p},deleteOneOrManyWebSocketHistory:function(){return h},openWebSocketHistoryTab:function(){return d}});var o=s("./js/services/NavigationService.js"),i=s("./js/stores/StoreManager.js"),r=s("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),n=s("./runtime-repl/request-websocket/history/datastores/WebSocketHistoryStore.js"),a=s("./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js"),l=s("./runtime-repl/request-websocket/raw/configurations/RawWebSocketRequest.ts"),c=s("./node_modules/lodash/lodash.js");function d(e,t={preview:!0}){return o.default.transitionTo(l.default.openHistoryIdentifier,{echid:e},{},{tabOptions:{preview:t.preview,forceNew:t.forceNew}})}function h(e){var t;c.isString(e)&&(e=[e]),null!==(t=e)&&void 0!==t&&t.length&&a.default.deleteHistory((0,i.resolveStoreInstance)(r.default).id,e).then((()=>(0,i.resolveStoreInstance)(n.default).remove(e))).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteOneOrManyWebSocketHistory: Error in deleting websocket history",e)}))}function p(){var e;const t=(0,i.resolveStoreInstance)(n.default);null!==(e=t.websocketHistoryInActiveWorkspace)&&void 0!==e&&e.length&&a.default.deleteHistory((0,i.resolveStoreInstance)(r.default).id).then((()=>t.remove())).catch((e=>{pm.logger.error("WebSocketRequestInterface~deleteAllWebSocketHistory: Error in deleting all websocket history",e)}))}},"./runtime-repl/request-websocket/history/services/WebSocketHistoryService.js":function(e,t,s){s.r(t);var o=s("./node_modules/rxjs/_esm5/internal/operators/filter.js"),i=s("./js/modules/services/RemoteSyncRequestService.js"),r=s("./js/modules/sync-timeline-helpers/RealtimeSyncMessagesService.js"),n=s("./js/stores/StoreManager.js"),a=s("./js/stores/SyncStatusStore.js"),l=s("./node_modules/lodash/lodash.js");async function c(){return(0,n.resolveStoreInstance)(a.default).onSyncAvailable({timeout:5e3})}const d=200,h={async createHistory(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history`,body:t}});if(!s)throw new Error("WebSocketHistoryService~createHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~createHistory: Non 200 response status code",s.status);const o=l.get(s,"body.id");if(!o)throw new Error("WebSocketHistoryService~createHistory:History ID not received.");return{id:o}},async addMessagesToHistory(e,t,s){await c();const o=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/${t}/messages`,body:s}});if(!o)throw new Error("WebSocketHistoryService~addMessagesToHistory: Response not available");if(o.status!==d)throw new Error("WebSocketHistoryService~addMessagesToHistory: Non 200 response status code")},async fetchHistoryList({workspaceId:e,nextCursor:t,limit:s=50,dir:o="desc"}){let r=`?dir=${o}`;t&&(r=`${r}&cursor=${t}`),s&&(r=`${r}&limit=${s}`),await c();const n=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history${r}`}});if(!n)throw new Error("WebSocketHistoryService~fetchHistoryList: Response not available");if(n.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryList: Non 200 response status code",n.status);const{data:a,meta:h}=l.get(n,"body",{});if(!a||!h)throw new Error("WebSocketHistoryService~fetchHistoryList: Incorrect response structure.");return{data:a,meta:h}},async fetchHistoryMeta(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMeta: Non 200 response status code",s.status);return s.body},async fetchHistoryMessages(e,t){await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"get",path:`/workspaces/${e}/history/${t}/messages`}});if(!s)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Non 200 response status code",s.status);const{messages:o}=l.get(s,"body",{});if(!o)throw new Error("WebSocketHistoryService~fetchHistoryMessages: Incorrect response structure.");return o},async deleteHistory(e,t){l.isString(t)&&(t=[t]),await c();const s=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"delete",path:`/workspaces/${e}/history`,body:{ids:t}}});if(!s)throw new Error("WebSocketHistoryService~deleteHistory: Response not available");if(s.status!==d)throw new Error("WebSocketHistoryService~deleteHistory: Non 200 response status code",s.status)},async subscribeToRealtimeEvents(e){await c();const t=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/subscribe`}});if(!t)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~subscribeToRealtimeEvents: Non 200 response status code",t.status);const{subscription:s}=t.body||{};return(0,r.getRealtimeMessagesObservable)().pipe((0,o.filter)((e=>e&&e.sub===s)))},async unsubscribeFromRealtimeEvents(e){await c();const t=await i.default.request("/ws/proxy",{method:"post",data:{service:"websocket",method:"post",path:`/workspaces/${e}/history/unsubscribe`}});if(!t)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Response not available");if(t.status!==d)throw new Error("WebSocketHistoryService~unsubscribeFromRealtimeEvents: Non 200 response status code",t.status)}};t.default=h},"./runtime-repl/request-websocket/history/sidebar/components/WebSocketHistorySidebarListItem.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var o,i=s("../../node_modules/react/index.js"),r=s("../../node_modules/react-dom/index.js"),n=s("./node_modules/moment/moment.js"),a=s.n(n),l=s("./node_modules/classnames/index.js"),c=s.n(l),d=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),p=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-entity-websocket-stroke.js"),m=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),y=s("./js/components/base/Avatar.js"),S=s("./js/components/base/Tooltips.js"),b=s("./js/containers/apps/requester/sidebar/SidebarListItem.js"),g=s("./js/stores/OnlineStatusStore.js"),f=s("./js/stores/PermissionStore.js"),v=s("./runtime-repl/history/HistoryActionsConstants.js"),I=s("./runtime-repl/_common/DisabledTooltipConstants.js"),E=s("./js/stores/StoreManager.js"),T=s("./js/stores/CurrentUserStore.js"),_=s("./runtime-repl/request-websocket/raw/configurations/RawWebSocketRequest.ts");let w=(0,m.observer)(o=class extends i.Component{constructor(e){super(e),this.state={isTooltipVisible:!1},this.userAvatar=i.createRef(),this.handleSelect=this.handleSelect.bind(this),this.handleAction=this.handleAction.bind(this),this.handleDelete=this.handleDelete.bind(this),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this.getLeftAlignedComponents=this.getLeftAlignedComponents.bind(this),this.getRightAlignedComponents=this.getRightAlignedComponents.bind(this)}componentDidMount(){this.selfNode=(0,r.findDOMNode)(this),this.props.observeSizeChange&&this.props.observeSizeChange(this.selfNode)}componentWillUpdate(e){if(!this.props.selected&&e.selected){const e=(0,r.findDOMNode)(this);e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}componentWillUnmount(){this.props.unobserveSizeChange&&this.props.unobserveSizeChange(this.selfNode,this.props.index)}getClasses(){return c()({"history-sidebar-list-item":!0,"history-sidebar-list-item__websocket-history":!0,"is-selected":this.props.selected})}getTooltipText(e,t){return e?t?I.DISABLED_TOOLTIP_IS_OFFLINE:I.DISABLED_TOOLTIP_NO_PERMISSION:"Delete history"}getLeftAlignedComponents(e){var t;if(!e)return i.createElement("div",{className:"history-sidebar__indent"});const s=(0,E.resolveStoreInstance)(T.default),o=c()({"history-sidebar-list-item-updatedBy":!0,hovered:e}),r=s.isCurrentUserPartner?null===(t=s.partnerMembersByIds)||void 0===t?void 0:t[this.props.owner]:s.teamMembers.get(String(this.props.owner)),n=r&&(r.name||r.username);return i.createElement("div",{className:o,onMouseOver:this.showTooltip,onMouseLeave:this.hideTooltip},this.props.owner&&"0"!==this.props.owner?i.createElement(y.default,{ref:this.userAvatar,size:"small",userId:this.props.owner}):i.createElement(p.default,{name:"icon-descriptive-user-stroke",color:"content-color-secondary"}),this.userAvatar.current&&i.createElement(S.Tooltip,{immediate:!0,show:this.state.isTooltipVisible,target:this.userAvatar.current,placement:"right"},i.createElement(S.TooltipBody,null,i.createElement("div",{className:"history-sidebar-list-item-avatar-tooltip"},i.createElement(d.default,{type:"body-medium"},n),i.createElement(d.default,{type:"body-medium"},a()(this.props.createdAt).format("DD MMM YYYY, h:mm A"))))))}getRightAlignedComponents(e){const t=c()({"sidebar-list-item__right-section-actions":!0,hovered:e});if(!e)return null;const s=(0,E.resolveStoreInstance)(f.default),{userCanSave:o}=(0,E.resolveStoreInstance)(g.default),r=o&&s.can("delete","history");return i.createElement("div",{className:t},i.createElement(h.default,{type:"tertiary",icon:"icon-action-delete-stroke",onClick:this.handleDelete,isDisabled:!r,tooltip:this.getTooltipText(!r,!o)}))}showTooltip(){this.setState({isTooltipVisible:!0})}hideTooltip(){this.setState({isTooltipVisible:!1})}handleSelect(e){e.stopPropagation();const t={ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey};this.props.onSelect&&this.props.onSelect({id:this.props.id,type:"websockethistory"},t)}handleAction(e){this.props.onSelectAction(e,{websockethistory:[this.props.id]})}handleDelete(e){e.stopPropagation(),this.handleAction(v.ACTION_TYPE_DELETE)}render(){return i.createElement("div",{"data-index":this.props.index},i.createElement(b.default,{text:this.props.url,icon:i.createElement(u.default,{color:"content-color-brand"}),isSelected:this.props.isSelected,onClick:this.handleSelect,className:this.getClasses(),leftMetaComponent:this.getLeftAlignedComponents,rightMetaComponent:this.getRightAlignedComponents,routeConfig:{routeIdentifier:_.default.openHistoryIdentifier,routeParams:{echid:this.props.id},isNonLink:!0}}))}})||o}}]);