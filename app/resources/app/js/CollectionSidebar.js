"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[18],{"./js/containers/apps/requester/sidebar/SidebarFilter.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var r,s=o("../../node_modules/react/index.js"),n=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),i=o("./js/components/base/XPaths/XPath.js"),a=o("./js/components/base/Inputs.js"),l=o("./node_modules/lodash/lodash.js");let c=(0,n.observer)(r=class extends s.Component{constructor(e){super(e),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleSearchCancel=this.handleSearchCancel.bind(this),this.focusSearchBox=this.focusSearchBox.bind(this)}UNSAFE_componentWillMount(){pm.mediator.on("focusSearchBox",this.focusSearchBox)}componentWillUnmount(){pm.mediator.off("focusSearchBox",this.focusSearchBox)}focusSearchBox(){l.invoke(this,"refs.filter.focus")}handleSearchChange(e){this.props.onSearch&&this.props.onSearch(e)}handleSearchCancel(){this.props.onSearch&&this.props.onSearch("")}render(){return s.createElement(i.default,{identifier:"filter"},s.createElement(a.Input,{icon:"icon-action-filter-stroke",ref:"filter",inputStyle:"search",onChange:this.handleSearchChange,onCancel:this.handleSearchCancel,query:this.props.searchQuery,className:this.props.className}))}})||r},"./js/containers/apps/requester/sidebar/SidebarListActions.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var r,s=o("../../node_modules/react/index.js"),n=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),i=o("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-add-stroke.js"),a=o("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=o("./js/containers/apps/requester/sidebar/SidebarFilter.js"),d=o("./js/components/base/Buttons.js"),u=o("./js/components/base/Dropdowns.js"),h=o("./js/components/base/XPaths/XPath.js");let m=(0,l.observer)(r=class extends s.Component{constructor(e){super(e),this.handleDropdownSelect=this.handleDropdownSelect.bind(this)}handleDropdownSelect(e){this.props.onActionsDropdownSelect&&this.props.onActionsDropdownSelect(e)}getCreateNewButton(e){if(!e)return null;const t=s.createElement(n.default,{className:"create-new__btn",onClick:e.onCreate,tooltip:e.tooltip,isDisabled:e.disabled,icon:s.createElement(i.default,null),type:"tertiary",size:"small"});return e.xPathIdentifier?s.createElement(h.default,{identifier:e.xPathIdentifier},t):t}render(){return s.createElement("div",{className:"requester-left-sidebar__actions-container"},this.getCreateNewButton(this.props.createNewConfig),s.createElement(c.default,{onSearch:this.props.onSearch,className:this.props.className,searchQuery:this.props.searchQuery}),this.props.rightMetaContainer||this.props.moreActions?s.createElement("div",{className:"secondary-actions-container"},this.props.rightMetaContainer,this.props.moreActions?s.createElement(u.Dropdown,{ref:"menu",onSelect:this.handleDropdownSelect,className:"actions-dropdown"},s.createElement(u.DropdownButton,{dropdownStyle:"nocaret",type:"custom"},s.createElement(d.Button,{tooltip:"View more actions"},s.createElement(a.default,{name:"icon-action-options-stroke",className:"dropdown-action-button pm-icon pm-icon-normal"}))),this.props.moreActions):null):"")}})||r},"./runtime-repl/_common/WorkbenchStatusConstants.js":function(e,t,o){o.r(t),o.d(t,{API_NO_PERMISSION:function(){return c},API_REDIRECT_CONSUMER_ENTITY:function(){return d},DELETED:function(){return i},ERROR:function(){return n},LOADING:function(){return s},NO_TAB_MODE:function(){return a},READY:function(){return r},TAB_MODE:function(){return l}});const r="ready",s="loading",n="error",i="deleted",a="no-tab-mode",l="tab-mode",c="api-no-permission",d="api-redirect"},"./runtime-repl/_common/components/SidebarErrorState/SidebarErrorState.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return h}});var r,s=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),i=o.n(n),a=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=o("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),c=o("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/InternalServerError.js"),d=o("./js/modules/services/AnalyticsService.js"),u=o("./node_modules/lodash/lodash.js");let h=(0,a.observer)(r=class extends s.Component{constructor(e){super(e),this.renderButton=this.renderButton.bind(this)}componentDidMount(){"collection"===this.props.action&&d.default.addEventV2AndPublish({category:"workspace-load",action:"collection",label:"knownError:SidebarErrorState"})}renderButton(){if(this.props.buttonText&&this.props.handler)return s.createElement(l.default,{onClick:this.props.handler,type:"plain",text:this.props.buttonText})}render(){return s.createElement("div",{className:"sidebar-error-wrapper"},s.createElement(c.default,null),s.createElement("div",{className:"sidebar-error-content-container"},s.createElement("div",{className:"sidebar-error-header"},this.props.title),s.createElement("div",{className:"sidebar-error-content"},this.props.description),s.createElement("div",{className:"sidebar-error-button"},this.renderButton())))}})||r;h.defaultProps={description:null,buttonText:null,handler:u.noop},h.propTypes={title:i().string.isRequired,description:i().string,buttonText:i().string,handler:i().func}},"./runtime-repl/collection/sidebar/CollectionSidebarController.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return j}});var r,s,n,i=o("../../node_modules/mobx/lib/mobx.module.js"),a=o("./js/stores/StoreManager.js"),l=o("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),c=o("./js/constants/EnrichedError.js"),d=o("./runtime-repl/extensible-collection/api/ExtensibleCollectionAPI.ts"),u=o("./runtime-repl/extensible-collection/api/ExtensibleCollectionItemAPI.ts"),h=o("../../packages/version-control/change-management/index.ts"),m=o("./runtime-repl/collection/sidebar/CollectionSidebarModel.js"),p=o("./runtime-repl/_common/WorkbenchStatusConstants.js"),b=o("./runtime-repl/collection/_api/CollectionStoreV2.js"),S=o("./runtime-repl/collection/services/CollectionPerformanceMetricsService.ts"),f=o("./onboarding/src/common/LaunchDarkly.js"),C=o("./version-control/featureFlags.ts"),E=o("./js/utils/MeasurePerformance.js");function _(e,t,o,r,s){var n={};return Object.keys(r).forEach((function(e){n[e]=r[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=o.slice().reverse().reduce((function(o,r){return r(e,t,o)||o}),n),s&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(s):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}let j=((n=class{constructor(){var e,t,o,r;this.model=null,this.hydratedFromPartialStore=!1,e=this,t="status",r=this,(o=s)&&Object.defineProperty(e,t,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(r):void 0}),this.handleRetry=this.handleRetry.bind(this),this.handlePartialRetry=this.handlePartialRetry.bind(this)}async didCreate(){S.default.startTrace(S.CollectionPerformanceTraces.SIDEBAR),S.default.addMarker(S.CollectionPerformanceTraces.SIDEBAR,S.CollectionPerformanceMarkers.SIDEBAR_LOAD_START),this.model=new m.default,await this.loadSidebar(),this.loadOutOfSyncStatus()}async loadSidebar(){this.setSidebarStatus(p.LOADING),await(0,i.when)((()=>(0,a.resolveStoreInstance)(l.default).id));const e=(0,a.resolveStoreInstance)(l.default).id;try{await Promise.all([this._loadFromStore(e),this._loadExtensibleCollections().catch((()=>{}))]),this.setSidebarStatus(p.READY),E.default.markPoint("collection-sidebar-ready"),E.default.measureAndReportMetric("collection-sidebar-total-time","collection-sidebar-mount","collection-sidebar-ready",{category:"user-perceived-metrics"})}catch(e){pm.logger.error("CollectionSidebarController~didCreate: Failed to fetch collection list:",e),this.setSidebarStatus(p.ERROR),pm.logger.error("Availability~CollectionSidebarController","Collection sidebar controller collection fetch fail",e,{},{crash:!0,meta:{domain:"engineering-foundation",category:"availability"}})}}async loadOutOfSyncStatus(){try{if(!f.launchDarkly.getFlag(C.ENABLE_PULL_CHANGES_NUDGE_FLAG.key,C.ENABLE_PULL_CHANGES_NUDGE_FLAG.defaultValue))return;const e=[],t=(0,a.resolveStoreInstance)(h.ForkDivergenceStore);this.collectionStore.list.forEach((t=>{t.isForked&&e.push(t.id)})),t.getDivergenceBulk({collection:{ids:e}})}catch(e){}}async handleRetry(){await this.loadSidebar()}async handlePartialRetry(){this.model.setPartialError(!1),await(0,i.when)((()=>(0,a.resolveStoreInstance)(l.default).id));const e=(0,a.resolveStoreInstance)(l.default).id;await(0,b.subscribePartial)(e,{permissions:this.constructor.collectionPermissions}).then((e=>(this.hydratedFromPartialStore=!0,this.model.hydrateFromStore(e,!0),this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.collectionStore=e,this.model.setPartialError(!1),e))).catch((e=>{pm.logger.error("CollectionSidebarController~_loadFromStore: Failed to load collection hierarchy on retry",e),this.model.setPartialError(!0)}))}beforeDestroy(){this.collectionStore&&this.collectionStore.unsubscribe&&this.collectionStore.unsubscribe(),this.extensibleCollectionChangeListenersDisposer&&this.extensibleCollectionChangeListenersDisposer(),this.model=null}setSidebarStatus(e){this.status=e}async _loadExtensibleCollections(){let e;try{e=await d.default.list()}catch(e){pm.logger.error("CollectionSidebarController~_loadExtensibleCollections",e)}this.model.hydrateExtensibleCollection(e),this.extensibleCollectionChangeListenersDisposer=d.default.cacheAPI.subscribeToChanges(this.model.getExtensibleCollectionEventListeners()),this.extensibleCollectionItemsChangeListenersDisposer=u.default.cacheAPI.subscribeToChanges(this.model.getExtensibleCollectionItemEventListeners())}async _loadFromStore(e){this.hydratedFromPartialStore=!1;const t=(0,b.isPartialCached)(e),o=(0,b.subscribeMeta)(e,{permissions:this.constructor.collectionPermissions}).then((e=>(this.hydratedFromPartialStore||(S.default.hasTrace(S.CollectionPerformanceTraces.SIDEBAR)&&!t&&S.default.addMarker(S.CollectionPerformanceTraces.SIDEBAR,S.CollectionPerformanceMarkers.SIDEBAR_LOAD_META),this.model.hydrateFromStore(e,!1),this.collectionStore=e),e))).catch((e=>{throw pm.logger.error("CollectionSidebarController~_loadFromStore: Failed to load collection list",e),new c.EnrichedError("Failed to load collection list",e)})),r=(0,b.subscribePartial)(e,{permissions:this.constructor.collectionPermissions}).then((e=>(this.hydratedFromPartialStore=!0,this.model.hydrateFromStore(e,!0),o.then((e=>{e.unsubscribe()})),this.collectionStore=e,S.default.hasTrace(S.CollectionPerformanceTraces.SIDEBAR)&&(S.default.addMarker(S.CollectionPerformanceTraces.SIDEBAR,t?S.CollectionPerformanceMarkers.SIDEBAR_LOAD_CACHED:S.CollectionPerformanceMarkers.SIDEBAR_LOAD_END),S.default.endTrace(S.CollectionPerformanceTraces.SIDEBAR)),e))).catch((e=>{throw pm.logger.error("CollectionSidebarController~_loadFromStore: Failed to load collection hierarchy",e),this.model.setPartialError(!0),new c.EnrichedError("Failed to load collection hierarchy",e)}));return Promise.any([o,r])}}).collectionPermissions=["edit","delete","share","addMock","addMonitor"],s=_((r=n).prototype,"status",[i.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.LOADING}}),_(r.prototype,"setSidebarStatus",[i.action],Object.getOwnPropertyDescriptor(r.prototype,"setSidebarStatus"),r.prototype),r)},"./runtime-repl/collection/sidebar/CollectionSidebarMenu/CollectionSidebarMenu.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return P}});var r,s=o("../../node_modules/react/index.js"),n=o("../../node_modules/mobx/lib/mobx.module.js"),i=o("./node_modules/prop-types/index.js"),a=o.n(i),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=o("./js/components/base/Buttons.js"),d=o("./js/stores/SyncStatusStore.js"),u=o("./js/stores/OnlineStatusStore.js"),h=o("./collaboration/workspace/model/ActiveWorkspacePermissionStore.ts"),m=o("./js/stores/StoreManager.js"),p=o("./collaboration/workspace/model/ActiveWorkspaceBaseStore.ts"),b=o("./js/services/NavigationService.js"),S=o("./js/containers/apps/requester/sidebar/SidebarListActions.js"),f=o("./js/components/base/Dropdowns.js"),C=o("./collaboration/workspace/types/PermissionTypes.ts"),E=o("./runtime-repl/_common/WorkspaceHelpers.js"),_=o("./runtime-repl/collection/sidebar/CollectionSidebarModel.js"),j=o("./runtime-repl/collection/_api/CollectionInterface.js"),y=o("./runtime-repl/_common/DisabledTooltipConstants.js"),g=o("./node_modules/lodash/lodash.js");let P=(0,l.observer)(r=class extends s.Component{constructor(e){super(e),this.state={isCollectionCreateEnabled:!0},this.handleNewCollectionClick=this.handleNewCollectionClick.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this)}handleNewCollectionClick(){this.setState({isCollectionCreateEnabled:!1}),this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.setState({isCollectionCreateEnabled:!0})}),1e3),(0,j.createCollection)()}async handleTrashOpen(){if(!(0,E.isLoggedIn)())return pm.mediator.trigger("showSignInModal",{type:"trash",origin:"open_trash"});const e=(0,m.resolveStoreInstance)(p.default);await(0,n.when)((()=>e.id)),b.default.transitionTo("trash",{},{},{additionalContext:{sourceWorkspace:e.id}})}handleSearchChange(e){this.props.model&&this.props.model.setSearchQuery(e)}render(){const e=(0,m.resolveStoreInstance)(h.default),t=e&&e.permissions,o=g.get(t,C.WORKSPACE_PERMISSIONS.ADD_COLLECTION_TO_WORKSPACE,!0),{userCanSave:r}=(0,m.resolveStoreInstance)(u.default),n=r&&o&&this.state.isCollectionCreateEnabled,i=!(0,m.resolveStoreInstance)(d.default).isSocketConnected,a=(0,E.isLoggedIn)()&&!((0,E.isWorkspaceMember)()||(0,E.canJoinWorkspace)())||i;let l=a?"Only members of this workspace can recover deleted collections":"Recover your deleted collections";return l=i?"You can perform this action once you're back online":l,s.createElement("div",{className:"collection-sidebar-menu"},s.createElement(S.default,{createNewConfig:{tooltip:r?o?"Create new collection":y.DISABLED_TOOLTIP_NO_PERMISSION:y.DISABLED_TOOLTIP_IS_OFFLINE,disabled:!n,onCreate:this.handleNewCollectionClick,xPathIdentifier:"addCollection"},onSearch:this.handleSearchChange,searchQuery:g.get(this.props.model,"searchQuery"),moreActions:s.createElement(f.DropdownMenu,null,s.createElement(f.MenuItem,null,s.createElement(c.Button,{onClick:this.handleTrashOpen,tooltip:l,disabled:a,type:"text",className:"collection-sidebar-menu__actions-trash"},"Open Trash")))}))}})||r;P.propTypes={model:a().instanceOf(_.default).isRequired}},"./runtime-repl/collection/sidebar/CollectionSidebarView.js":function(e,t,o){o.r(t),o.d(t,{default:function(){return P}});var r,s=o("../../node_modules/react/index.js"),n=o("./node_modules/prop-types/index.js"),i=o.n(n),a=o("../../node_modules/mobx/lib/mobx.module.js"),l=o("../../node_modules/mobx-react/dist/mobx-react.module.js"),c=o("./js/components/base/XPaths/XPath.js"),d=o("./js/stores/StoreManager.js"),u=o("./js/stores/SyncStatusStore.js"),h=o("./runtime-repl/collection/sidebar/CollectionSidebarModel.js"),m=o("./appsdk/sidebar/SidebarLoadingState/SidebarLoadingState.js"),p=o("./runtime-repl/collection/sidebar/CollectionSidebarListContainer/CollectionSidebarListContainer.js"),b=o("./runtime-repl/collection/sidebar/CollectionSidebarMenu/CollectionSidebarMenu.js"),S=o("./runtime-repl/_common/WorkbenchStatusConstants.js"),f=o("./runtime-repl/_common/components/SidebarErrorState/SidebarErrorState.js"),C=o("./js/constants/ResourceAnalyticsConstant.js"),E=o("./js/apps/boot/FirstPageLoadService.js"),_=o("./js/components/network/NetworkTrouble.js"),j=o("./js/modules/services/AnalyticsService.js"),y=o("./js/utils/MeasurePerformance.js"),g=o("./node_modules/lodash/lodash.js");let P=(0,l.observer)(r=class extends s.Component{constructor(e){super(e),this.analyticsReactionDisposer=null,this.isFirstPageLoad=!0,this.focus=this.focus.bind(this),this.focusCollection=this.focusCollection.bind(this),this.focusNext=this.focusNext.bind(this),this.listRef=null}componentDidMount(){y.default.markPoint("collection-sidebar-mount"),this.props.controller&&(this.analyticsReactionDisposer=(0,a.reaction)((()=>this.props.controller.status),(e=>{[S.ERROR,S.READY].includes(e)&&(this.isFirstPageLoad&&"desktop"===window.SDK_PLATFORM&&(E.FirstPageLoadPerformanceService.sendMeasure(C.PERF_MEASURE_NAMES.COLLECTION_SIDEBAR_MOUNT_TIME,C.PERF_MARK_NAMES.WORKSPACE_COMPONENT_MOUNT_COMPLETE),this.isFirstPageLoad=!1),j.default.addEventV2AndPublish({category:"workspace-load",action:"collection-sidebar-view",label:e===S.ERROR?"error":"success"}))}),{fireImmediately:!0}))}componentWillUnmount(){this.analyticsReactionDisposer&&this.analyticsReactionDisposer()}getView(){const{model:e,status:t,handleRetry:o,handlePartialRetry:r}=this.props.controller||{},{isConsistentlyOffline:n}=(0,d.resolveStoreInstance)(u.default);return n&&t===S.LOADING?s.createElement(_.default,{origin:"sidebar",entity:"collection"}):t===S.ERROR?s.createElement(f.default,{title:"Couldn’t fetch your data",description:"Just a faulty wire. Your data is safely synced to Postman’s servers.",action:"collection",buttonText:"Refresh",handler:o}):t===S.READY?s.createElement(c.default,{identifier:"collection"},s.createElement(p.default,{ref:e=>{this.listRef=e},model:e,handlePartialRetry:r})):s.createElement(m.default,{hasIcon:!0})}focus(){g.invoke(this,"listRef.__wrappedInstance.focus")}focusCollection(e,t){g.invoke(this,"listRef.__wrappedInstance.focusCollection",e,t)}focusNext(){const e=g.head(g.get(this.props.controller,"model.collections"));g.invoke(this,"listRef.handleSelect",e.id)}render(){const{model:e}=this.props.controller||{};return s.createElement("div",{className:"collection-sidebar"},s.createElement("div",{className:"collection-sidebar-wrapper"},s.createElement(b.default,{model:e}),this.getView()))}})||r;P.propTypes={controller:i().shape({model:i().instanceOf(h.default),status:i().oneOf([S.ERROR,S.READY,S.LOADING])}).isRequired}},"./version-control/featureFlags.ts":function(e,t,o){o.r(t),o.d(t,{ENABLE_PULL_CHANGES_NUDGE_FLAG:function(){return r}});const r={key:"enable-pull-changes-nudge",defaultValue:!1}}}]);