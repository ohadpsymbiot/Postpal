"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[21],{"./apinetwork/services/PublicProfileService.js":function(e,t,s){s.r(t);var i=s("./js/utils/PostmanGatewayService.js");t.default={getPublicEntities:function({publisherType:e,publisherId:t,entityType:s,type:o,limit:n,offset:a}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}/${t}?entityType=${s}&type=${o}&limit=${n}&offset=${a}&sort=latest&flattenAPIVersions=true`})})},getTemplateByPublisher:function({publisherType:e,publisherId:t,limit:s}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/template/${e}/${t}?limit=${s}&sort=latest`})})},getApiNetworkByTeam:function({teamId:e,limit:t}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/apinetwork/team/${e}?limit=${t}&sort=latest`})})},updateNetworkEntity:function({entityId:e,body:t}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"put",path:`/v1/api/networkentity/${e}`,body:t})})},fetchPermissions:e=>i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:"/api/permissions/check",service:"acs",method:"post",body:{checks:e}})}),fetchProfileMetaData:function({id:e,profileType:t,referrer:s}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:`/v1/api/${t}/${e}${s?"?referrer="+s:""}`,service:"publishing",method:"get"})})},fetchProfileMeta:function({id:e,profileType:t,referrer:s}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:`/v1/api/${t}/${e}/meta${s?"?referrer="+s:""}`,service:"publishing",method:"get"})})},fetchCounts:function(e={}){let t=`/v1/api/networkentity/count?publisherType=${e.publisherType}&publisherId=${e.publisherId}&flattenAPIVersions=true`;return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},getTemplate:function(e={}){let t=`/v1/api/template/review?publishedId=${e.publishedId}`;return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},getApiNetwork:function(e={}){let t=`/v1/api/apinetwork?publishedId=${e.publishedId}`;return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:t})})},removeApiNetwork:function(e={}){let t=`/v1/api/apinetwork/${e.id}`;return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"delete",path:t})})},removeTemplate:function(e={}){let t=`/v1/api/template/${e.id}`;return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"delete",path:t})})},getPublisherHomeEntities:function({publisherType:e,publisherId:t,limit:s}){return i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}/${t}/home?limit=${s}&sort=latest&flattenAPIVersions=true`})})},async getNetworkEntity(e){const t=await i.default.request("/ws/proxy",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:"publishing",method:"get",path:`/v1/api/networkentity/${e}`})},{returnRawResponse:!0});return t.ok?t.json():Promise.reject(await t.json())}}},"./documentation/components/DocumentationIntersectionObserver/index.js":function(e,t,s){s.r(t),s.d(t,{IntersectionObserverContext:function(){return i.IntersectionObserverContext},useIntersectionObserver:function(){return i.useIntersectionObserver}});var i=s("./documentation/components/DocumentationIntersectionObserver/DocumentationIntersectionObserver.js");t.default=i.default},"./documentation/components/DocumentationPublishView/ColorPicker.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return a}});var i=s("../../node_modules/react/index.js"),o=s("./js/components/base/Inputs.js"),n=s("./documentation/utils/utils.js");function a(e){const{colorHex:t,onColorChange:s,isColorInvalid:a,pristineColorHex:l}=e,r=(0,n.formatInputHex)(t),c={background:a?(0,n.formatInputHex)(l):r};return i.createElement("div",{className:"color-picker"},i.createElement(o.Input,{inputStyle:"box",onChange:s,value:r,className:"color-picker--input",error:a}),a&&i.createElement("div",{className:"color-picker--warning"},i.createElement("span",null,"Please enter a valid hexcode.")),i.createElement("div",{className:"color-picker--preview "+(a?"color-picker--preview--invalid":""),style:c}))}},"./documentation/components/DocumentationPublishView/CustomDomainHelperText.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var i=s("../../node_modules/react/index.js"),o=s("./node_modules/prop-types/index.js"),n=s.n(o),a=s("./js/components/messaging/Alert.js"),l=s("./js/services/NavigationService.js"),r=s("./js/components/base/LoadingIndicator.js"),c=s("./js/modules/services/AnalyticsService.js"),d=s("./documentation/constants.js"),u=s("./node_modules/lodash/lodash.js");function h(e){let{publishedDomainIndex:t,selectedDomainIndex:s,customDomains:o,domainUpstreamViewPermission:n,domainUpstreamViewPermissionLoading:h}=e;if(!o||Number(s)<0)return null;let m=o[s],p=u.get(m,"publishData.owner"),b=u.get(m,"publishData.collectionId"),g=u.get(m,"id"),y=`${pm.artemisUrl}/documentation/${p}-${b}`,v=`${pm.dashboardUrl}/settings/domains/${g}`,E={unavailableDefault:i.createElement(a.default,{type:"error",isDismissable:!1,message:"Someone else on your team has already published a documentation with this domain. Ask them to unpublish their documentation before publishing yours."}),unavailableOwner:i.createElement(a.default,{type:"error",isDismissable:!1,message:`<a href='${y}'>Another published documentation</a> &nbsp;is already using this custom domain. Please unpublish that before attempting to publish another documentation using this domain.`,onMessageLinkClick:()=>l.default.openURL(`${y}`,{target:"_blank"})}),unverified:i.createElement(a.default,{type:"warn",isDismissable:!1,message:`Once domain ownership is verified, your documentation will be accessible from this URL.&nbsp;<a href=${v}>Verify Now</a>`,onMessageLinkClick:()=>(c.default.addEventV2({category:d.DOCUMENTATION_ANALYTICS.CATEGORY,action:"verify_custom_domain",label:d.DOCUMENTATION_ANALYTICS.LABEL.PUBLISH_SETTINGS_TAB,entityType:"domain",entityId:g}),l.default.openURL(`${v}`,{target:"_blank"}))})};if(h)return i.createElement(r.default,null);if(m){let e=m.upstream,s=o[t];if(e&&g!==u.get(s,"id"))return n?E.unavailableOwner:E.unavailableDefault;if(!u.get(m,"verified"))return E.unverified}return null}h.propTypes={publishedDomainIndex:n().number.isRequired,selectedDomainIndex:n().number.isRequired,customDomains:n().array.isRequired,domainUpstreamViewPermission:n().bool,domainUpstreamViewPermissionLoading:n().bool}},"./documentation/components/DocumentationPublishView/DocumentationSelectDropdown.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return h}});var i=s("../../node_modules/react/index.js"),o=s("./js/components/base/Inputs.js"),n=s("./js/components/base/Dropdowns.js"),a=s("./js/components/base/Buttons.js"),l=s("./js/components/base/FuzzySearchInput.js"),r=s("./js/components/base/LoadingIndicator.js"),c=s("./node_modules/classnames/index.js"),d=s.n(c),u=s("./node_modules/lodash/lodash.js");class h extends i.Component{constructor(e){super(e),this.state={searchQuery:"",searchResults:[]},this.handleFuzzySearch=this.handleFuzzySearch.bind(this),this.getClasses=this.getClasses.bind(this)}handleFuzzySearch(e,t){this.setState({searchQuery:e,searchResults:t})}handleSelect(e,t){let s={};s=t?{...this.props.selectedItems,[e]:u.find(this.props.items,{id:e})}:u.omitBy(this.props.selectedItems,{id:e}),u.isFunction(this.props.onSelect)&&this.props.onSelect(s)}getClasses(){return d()({"select-dropdown-container":!0,applied:this.props.isFilterApplied,selected:!this.props.isFilterApplied&&this.props.isSelected})}render(){let e=this.state.searchQuery?this.state.searchResults:this.props.items;return i.createElement("div",{className:d()("select-dropdown-container",this.props.className)},i.createElement(n.Dropdown,{className:this.getClasses()},i.createElement(n.DropdownButton,null,i.createElement(a.Button,{type:"text",className:"select-dropdown-btn"},this.props.dropDownPlaceholder)),i.createElement(n.DropdownMenu,null,i.createElement("div",{className:"select-dropdown"},this.props.displaySearch&&i.createElement(l.default,{searchQuery:this.state.searchQuery,placeholder:this.props.searchPlaceholder,onChange:this.handleFuzzySearch,items:this.props.items,searchFields:this.props.searchFields}),i.createElement("div",{className:d()({"select-dropdown-list":!0,isLoading:this.props.isLoading})},this.props.isLoading?i.createElement(r.default,null):e&&e.length?u.map(e,(e=>i.createElement("div",{key:e.id,className:"select-dropdown-item",onClick:this.handleSelect.bind(this,e.id,!this.props.selectedItems[e.id])},i.createElement("span",{className:"select-dropdown-item-text",title:e.name},e.name),i.createElement(o.Checkbox,{onChange:this.handleSelect.bind(this,e.id),className:"select-dropdown-item-checkbox",checked:this.props.selectedItems[e.id]})))):i.createElement("div",{className:"select-dropdown-item"},"No results found"))))))}}},"./documentation/components/DocumentationPublishView/PublishSettings.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return B}});var i,o=s("../../node_modules/react/index.js"),n=s("./node_modules/prop-types/index.js"),a=s.n(n),l=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=s("./node_modules/classnames/index.js"),c=s.n(r),d=s("./node_modules/querystring-browser/querystring.js"),u=s.n(d),h=s("../../packages/documentation/documentation-core/index.js"),m=s("./documentation/components/DocumentationPublishView/DocumentationSelectDropdown.js"),p=s("./documentation/components/DocumentationPublishView/ColorPicker.js"),b=s("./documentation/components/DocumentationPublishView/SidebarNavigation.js"),g=s("./documentation/utils/utils.js"),y=s("./documentation/components/DocumentationPublishView/PublishedViewPreview.js"),v=s("./documentation/components/DocumentationPublishView/CustomDomainHelperText.js"),E=s("./appsdk/components/link/Link.js"),f=s("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),C=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),w=s("../../node_modules/@postman/aether/esmLib/src/components/Tab/Tabs.js"),I=s("../../node_modules/@postman/aether/esmLib/src/components/Tab/TabList.js"),S=s("../../node_modules/@postman/aether/esmLib/src/components/Tab/Tab.js"),N=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),T=s("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),P=s("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),k=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),D=s("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),R=s("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),O=(s("./js/components/base/LoadingIndicator.js"),s("./documentation/constants.js")),_=s("./documentation/utils/publish.js"),q=s("./documentation/services/DocumentationService.js"),A=s("./js/stores/StoreManager.js"),L=s("./js/stores/CurrentUserStore.js"),j=s("./documentation/components/DocumentationPublishView/ShareToWorkspace/index.js"),x=s("./js/modules/services/AnalyticsService.js"),U=s("./node_modules/lodash/lodash.js");const M="no-custom-domain",V="no-environment",W={"right-sidebar":"303030","top-bar":"FFFFFF",highlight:"EF5B25"};let B=(0,l.observer)(i=class extends o.Component{constructor(e){super(e),this.handleRetractRequest=()=>{this.setState({showRetractConfirmationModal:!1});const{retractRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(t),x.default.addEventV2({category:O.DOCUMENTATION_ANALYTICS.CATEGORY,action:"retract_request_settings",label:this.props.isViewOnlyStatusPage?O.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:O.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:O.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.getEnvironmentMenuItems=()=>{let e=this.props.availableEnvironments;if(e&&Array.isArray(e)){let t=e.map((e=>({name:e.name,id:e.owner+"-"+e.id})));return t.unshift({name:"No Environment",id:V}),t}return[{name:"No Environment",id:V},{}]};const t=this.props.publishedStyling.documentationLayout||"classic-double-column",s=this.props.requestedStyling.documentationLayout||"classic-double-column";this.state={selectedDomain:U.findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),publishedDomainId:U.findIndex(this.props.availableCustomDomains,{id:this.props.publishedCustomDomain}),selectedEnvironment:U.findIndex(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedEnvironmentDetails:U.find(this.props.availableEnvironments,{id:this.props.publishedEnvironment,owner:this.props.publishedEnvironmentOwner}),selectedVersions:U.isEmpty(this.props.publishedVersions)?{latest:O.DOCUMENTATION_LATEST_VERSION}:this.props.publishedVersions,versionsDropdownPlaceholder:this.getVersionDropdownPlaceholder(Object.keys(this.props.publishedVersions).length,U.get(this.props.publishedVersions,"0"))||"CURRENT",customColors:this.props.publishedStyling.customColor||{"right-sidebar":W["right-sidebar"],"top-bar":W["top-bar"],highlight:W.highlight},activeSidebarItem:"#content",documentationLayout:t,documentationLayoutActiveTabIndex:"classic-double-column"===t?0:1,domainUpstreamViewPermission:null,domainUpstreamViewPermissionLoading:!1,selectedDomainUnavailable:!1,triggerShare:!1,isSharing:!1,isColorInvalid:{"right-sidebar":!1,"top-bar":!1,highlight:!1},showRetractConfirmationModal:!1,noteToCommunityManager:this.props.noteToCommunityManager,selectedRequestedDomain:U.findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),requestedDomainId:U.findIndex(this.props.availableCustomDomains,{id:this.props.requestedCustomDomain}),selectedRequestedEnvironment:U.findIndex(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedEnvironmentDetails:U.find(this.props.availableEnvironments,{id:this.props.requestedEnvironment,owner:this.props.requestedEnvironmentOwner}),selectedRequestedVersions:U.isEmpty(this.props.requestedVersions)?{latest:O.DOCUMENTATION_LATEST_VERSION}:this.props.requestedVersions,requestedVersionsDropdownPlaceholder:this.getVersionDropdownPlaceholder(Object.keys(this.props.requestedVersions).length,U.get(this.props.requestedVersions,"0"))||"CURRENT",requestedCustomColors:this.props.requestedStyling.customColor||{"right-sidebar":W["right-sidebar"],"top-bar":W["top-bar"],highlight:W.highlight},requestedDocumentationLayout:s,requestedDocumentationLayoutActiveTabIndex:"classic-double-column"===s?0:1,isRequestedColorInvalid:{"right-sidebar":!1,"top-bar":!1,highlight:!1}},this.handleVersionSelect=this.handleVersionSelect.bind(this),this.handleEnvironmentSelect=this.handleEnvironmentSelect.bind(this),this.handleCustomDomainSelect=this.handleCustomDomainSelect.bind(this),this.handlePublishButtonClick=this.handlePublishButtonClick.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleLayoutToggle=this.handleLayoutToggle.bind(this),this.handlePreview=this.handlePreview.bind(this),this.updatePreviewWindow=this.updatePreviewWindow.bind(this),this.constructPreviewUrl=this.constructPreviewUrl.bind(this),this.getVersionsForPreview=this.getVersionsForPreview.bind(this),this.onShareComplete=this.onShareComplete.bind(this),this.handleNoteToCommunityManager=this.handleNoteToCommunityManager.bind(this),this.handleRequestedVersionSelect=this.handleRequestedVersionSelect.bind(this),this.handleRequestedEnvironmentSelect=this.handleRequestedEnvironmentSelect.bind(this),this.handleRequestedCustomDomainSelect=this.handleRequestedCustomDomainSelect.bind(this),this.handleRequestPublishButtonClick=this.handleRequestPublishButtonClick.bind(this),this.handleApproveRequest=this.handleApproveRequest.bind(this),this.handleRequestedLayoutToggle=this.handleRequestedLayoutToggle.bind(this),this.updateRequestPreviewWindow=this.updateRequestPreviewWindow.bind(this),this.constructRequestPreviewUrl=this.constructRequestPreviewUrl.bind(this),this.getRequestedVersionsForPreview=this.getRequestedVersionsForPreview.bind(this),this.previewWindow=null}handleNoteToCommunityManager(e){this.setState({noteToCommunityManager:e})}handleCancel(){"function"==typeof this.props.cancelButtonCallback&&this.props.cancelButtonCallback()}handleApproveRequest(){const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let s=this.getRequestPayload();"function"==typeof e&&e(s,t)}getRequestPayload(){let{requestData:e}=this.props,t=U.get(e,"data.body.data[0]",{}),{modelId:s}=t,i=this.state.selectedRequestedEnvironment,o=U.get(this.props.availableEnvironments,[i],{}),{owner:n,id:a}=U.pick(o,["id","owner"]),l=n&&a?`${n}-${a}`:null,r=this.state.selectedRequestedDomain,c=U.get(this.props.availableCustomDomains,[r],null),d=U.get(c,"id",null),u=Object.keys(this.state.selectedRequestedVersions),h={...U.pick(this.state.requestedCustomColors,["top-bar","right-sidebar","highlight"])},m=this.formatCustomColorsForPublishing(h);return n=n||null,e&&{uid:s,environmentTemplateId:l,environmentOwner:n,customDomainId:d,customColor:m,versionTag:u,documentationLayout:this.state.requestedDocumentationLayout}}handlePublishButtonClick(){if(this.props.isGovernance){const e=this.getPublishPayload();"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(e)}else this.setState({triggerShare:!0,isSharing:!0})}getPublishPayload(){var e,t;let s=this.state.selectedEnvironment,i=U.get(this.props.availableEnvironments,[s],{}),{owner:o,id:n}=U.pick(i,["id","owner"]),a=o&&n?`${o}-${n}`:null,l=this.state.selectedDomain,r=U.get(this.props.availableCustomDomains,[l],null),c=U.get(r,"id",null),d=Object.keys(this.state.selectedVersions),u={...U.pick(this.state.customColors,["top-bar","right-sidebar","highlight"])};o=o||null;let h={versionTag:d,environmentTemplateId:a,environmentOwner:o,customDomainId:c,customColor:this.formatCustomColorsForPublishing(u),documentationLayout:this.state.documentationLayout};const m={...(null===(e=this.props.publishedStyling)||void 0===e?void 0:e.customColor)||{"right-sidebar":W["right-sidebar"],"top-bar":W["top-bar"],highlight:W.highlight},layout:(null===(t=this.props.publishedStyling)||void 0===t?void 0:t.documentationLayout)||"classic-double-column"},p={...h.customColor,layout:h.documentationLayout};let b=U.reduce(m,((e,t,s)=>U.isEqual(t,p[s])?e:e.concat(s)),[]);return b=b.join("_"),x.default.addEventV2({category:O.DOCUMENTATION_ANALYTICS.CATEGORY,action:this.props.isCollectionPublished?"republish_documentation":"publish_documentation",label:b.length?b:"",entityType:O.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid}),h}getRequestPublishPayload(){let e=this.state.selectedRequestedEnvironment,t=U.get(this.props.availableEnvironments,[e],{}),{owner:s,id:i}=U.pick(t,["id","owner"]),o=s&&i?`${s}-${i}`:null,n=this.state.selectedRequestedDomain,a=U.get(this.props.availableCustomDomains,[n],null),l=U.get(a,"id",null),r=Object.keys(this.state.selectedRequestedVersions),c={...U.pick(this.state.requestedCustomColors,["top-bar","right-sidebar","highlight"])};return s=s||null,{environmentTemplateId:o,environmentOwner:s,customDomainId:l,customColor:this.formatCustomColorsForPublishing(c),versionTag:r,documentationLayout:this.state.requestedDocumentationLayout}}onShareComplete(e,t,s){this.setState({isSharing:!1,triggerShare:!1});let i=this.getPublishPayload();U.set(i,"shareToWorkspace",{workspaceId:t,shared:!e,isEnvironmentMoved:s}),"function"==typeof this.props.publishButtonCallback&&this.props.publishButtonCallback(i)}handleRequestPublishButtonClick(){let e=this.getRequestPublishPayload();"function"==typeof this.props.requestPublishButtonCallback&&this.props.requestPublishButtonCallback(e,this.state.noteToCommunityManager)}handleRequestedEnvironmentSelect(e){let{owner:t,collectionId:s}=(0,g.getOptionsFromCollectionUid)(e);this.setState({selectedRequestedEnvironment:U.findIndex(this.props.availableEnvironments,{owner:t,id:s}),selectedRequestedEnvironmentDetails:U.find(this.props.availableEnvironments,{owner:t,id:s})},(()=>{this.handlePreview()}))}handleEnvironmentSelect(e){let{owner:t,collectionId:s}=(0,g.getOptionsFromCollectionUid)(e);this.setState({selectedEnvironment:U.findIndex(this.props.availableEnvironments,{owner:t,id:s}),selectedEnvironmentDetails:U.find(this.props.availableEnvironments,{owner:t,id:s})},(()=>{this.handlePreview()}))}async handleRequestedCustomDomainSelect(e){let t,s,i=this.props.availableCustomDomains,o=U.findIndex(i,{id:e}),n=i[o],a=U.get(i,[this.state.requestedDomainId,"id"],void 0),l=U.get(n,"id")===a,r=null!==U.get(n,"upstream")&&!l,c=U.get(n,"publishData.owner"),d=U.get(n,"publishData.collectionId"),u=(0,A.resolveStoreInstance)(L.default);e===M&&(r=!1),this.setState({selectedRequestedDomain:o,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${c}-${d}`,objectType:"collection",entityId:u.id,entityType:"user",permission:O.PERMISSIONS.VIEW_COLLECTION},s=await(0,q.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:U.get(s,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettings~handleRequestedCustomDomainSelect: Failed to fetch collection view permission",e)}}async handleCustomDomainSelect(e){let t,s,i=this.props.availableCustomDomains,o=U.findIndex(i,{id:e}),n=i[o],a=U.get(i,[this.state.publishedDomainId,"id"],void 0),l=U.get(n,"id")===a,r=null!==U.get(n,"upstream")&&!l,c=U.get(n,"publishData.owner"),d=U.get(n,"publishData.collectionId"),u=(0,A.resolveStoreInstance)(L.default);e===M&&(r=!1),this.setState({selectedDomain:o,selectedDomainUnavailable:r});try{r&&(this.setState({domainUpstreamViewPermissionLoading:!0}),t={objectId:`${c}-${d}`,objectType:"collection",entityId:u.id,entityType:"user",permission:O.PERMISSIONS.VIEW_COLLECTION},s=await(0,q.fetchPermissions)({permissionQuery:t}),this.setState({domainUpstreamViewPermission:U.get(s,"permissionQuery.allowed"),domainUpstreamViewPermissionLoading:!1}))}catch(e){pm.logger.error("PublishSettings~handleCustomDomainSelect: Failed to fetch collection view permission",e)}}getVersionDropdownPlaceholder(e,t){switch(e){case 0:return"";case 1:return t;default:return`Multiple Versions(${e})`}}handleRequestedVersionSelect(e){let t=Object.keys(e);if(!t.length)return;let s=t.length,i=this.props.availableVersions,o=U.get(U.find(i,{id:t[0]}),"name",""),n=this.getVersionDropdownPlaceholder(s,o);this.setState({selectedRequestedVersions:e,versionsDropdownPlaceholder:n},(()=>{this.handlePreview()}))}handleVersionSelect(e){let t=Object.keys(e);if(!t.length)return;let s=t.length,i=this.props.availableVersions,o=U.get(U.find(i,{id:t[0]}),"name",""),n=this.getVersionDropdownPlaceholder(s,o);this.setState({selectedVersions:e,versionsDropdownPlaceholder:n},(()=>{this.handlePreview()}))}getRequestedCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=U.get(this.props.availableCustomDomains,[this.state.requestedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length){let s=e.map((e=>{let s=e.id===t,i=null!==e.upstream&&!s,o=e.verified?"":"(unverified)",n=i?"(unavailable)":o;return{name:`${e.fqdn} ${n}`,id:e.id}}));return s.unshift({name:"No custom domain",id:M}),s}return[{name:"No custom domain",id:M},{}]}getCustomDomainMenuItems(){let e=this.props.availableCustomDomains,t=U.get(this.props.availableCustomDomains,[this.state.publishedDomainId,"id"],void 0);if(e&&Array.isArray(e)&&e.length){let s=e.map((e=>{let s=e.id===t,i=null!==e.upstream&&!s,o=e.verified?"":"(unverified)",n=i?"(unavailable)":o;return{name:`${e.fqdn} ${n}`,id:e.id}}));return s.unshift({name:"No custom domain",id:M}),s}return[{name:"No custom domain",id:M},{}]}getCollectionVersions(){let e=this.props.availableVersions;if(e&&Array.isArray(e)&&e.length){return e.map((e=>({name:e.name,id:e.id})))}return[{name:"CURRENT",id:"latest"}]}isRequestedColorInvalid(){return this.state.isRequestedColorInvalid.highlight||this.state.isRequestedColorInvalid["right-sidebar"]||this.state.isRequestedColorInvalid["top-bar"]}isColorInvalid(){return this.state.isColorInvalid.highlight||this.state.isColorInvalid["right-sidebar"]||this.state.isColorInvalid["top-bar"]}getRequestedDefaultColor(e){return this.props.requestedStyling.customColor&&this.props.requestedStyling.customColor[e]?this.props.requestedStyling.customColor[e]:W[e]}getDefaultColor(e){return this.props.publishedStyling.customColor&&this.props.publishedStyling.customColor[e]?this.props.publishedStyling.customColor[e]:W[e]}handleRequestedCustomColorChange(e,t,s){(0,g.isHexColor)(s)?this.state.isRequestedColorInvalid[t]&&this.setState({isRequestedColorInvalid:{...this.state.isRequestedColorInvalid,[t]:!1}}):this.setState({isRequestedColorInvalid:{...this.state.isRequestedColorInvalid,[t]:!0}}),s=s.slice(1),this.setState({requestedCustomColors:{...e,[t]:s}},(()=>{this.handlePreview()}))}handleCustomColorChange(e,t,s){(0,g.isHexColor)(s)?this.state.isColorInvalid[t]&&this.setState({isColorInvalid:{...this.state.isColorInvalid,[t]:!1}}):this.setState({isColorInvalid:{...this.state.isColorInvalid,[t]:!0}}),s=s.slice(1),this.setState({customColors:{...e,[t]:s}},(()=>{this.handlePreview()}))}handleRequestedLayoutToggle(e){this.setState({requestedDocumentationLayout:0===e?"classic-double-column":"classic-single-column",requestedDocumentationLayoutActiveTabIndex:e},(()=>{this.handlePreview()}))}handleLayoutToggle(e){this.setState({documentationLayout:0===e?"classic-double-column":"classic-single-column",documentationLayoutActiveTabIndex:e},(()=>{this.handlePreview()}))}formatCustomColorsForPublishing(e){return e&&Object.keys(e).length?(Object.keys(e).forEach((t=>{e[t]=(0,g.sanitiseHexColor)(e[t])})),e):e}handlePreview(e){if("browser"===window.SDK_PLATFORM){if(this.previewWindow&&!this.previewWindow.closed&&(0,_.getPostMessageSupport)(this.previewWindow,pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__")))return this.props.isGovernance&&!this.props.isCommunityManager?this.updateRequestPreviewWindow:this.updatePreviewWindow(pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"));if(e===O.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST){let e=this.props.isGovernance&&!this.props.isCommunityManager?this.constructRequestPreviewUrl():this.constructPreviewUrl();this.previewWindow=window.open(e,"Preview",`height=${window.innerHeight},width=${window.innerWidth}`),x.default.addEventV2({category:O.DOCUMENTATION_ANALYTICS.CATEGORY,action:"preview_documentation",label:O.DOCUMENTATION_ANALYTICS.LABEL.PUBLISH_SETTINGS_TAB,entityType:O.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})}}}updateRequestPreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],s=U.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:i,apiName:o,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=this.state.requestedCustomColors["top-bar"],r=this.state.requestedCustomColors.highlight,c=this.state.requestedCustomColors["right-sidebar"],d={versionTag:i.join(","),apiName:o.join(","),version:n,"top-bar":l,"right-sidebar":c,highlight:r,environment:s,documentationLayout:a};return this.previewWindow.postMessage(JSON.stringify(d),e)}updatePreviewWindow(e){let t=this.props.availableEnvironments[this.state.selectedEnvironment],s=U.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:i,apiName:o,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=this.state.customColors["top-bar"],r=this.state.customColors.highlight,c=this.state.customColors["right-sidebar"],d={versionTag:i.join(","),apiName:o.join(","),version:n,"top-bar":l,"right-sidebar":c,highlight:r,environment:s,documentationLayout:a};return this.previewWindow.postMessage(JSON.stringify(d),e)}constructRequestPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedRequestedEnvironment],s=U.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:i,apiName:o,version:n}=this.getRequestedVersionsForPreview(),a=this.state.requestedDocumentationLayout,l=Object.keys(this.state.requestedCustomColors).map((e=>u().stringify({[e]:this.state.requestedCustomColors[e]}))).join("&"),r={environment:s,versionTag:i.join(","),apiName:o.join(","),version:n,documentationLayout:a},c=[u().stringify(r),l].join("&"),d=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return d+=`?${c}`,d}constructPreviewUrl(){let e=this.props.collectionUid,t=this.props.availableEnvironments[this.state.selectedEnvironment],s=U.isNil(t)?void 0:`${t.owner}-${t.id}`,{versionTag:i,apiName:o,version:n}=this.getVersionsForPreview(),a=this.state.documentationLayout,l=Object.keys(this.state.customColors).map((e=>u().stringify({[e]:this.state.customColors[e]}))).join("&"),r={environment:s,versionTag:i.join(","),apiName:o.join(","),version:n,documentationLayout:a},c=[u().stringify(r),l].join("&"),d=[pm.config.get("__WP_DOCUMENTATION_PREVIEW_URL__"),"preview",e].join("/");return d+=`?${c}`,d}getRequestedVersionsForPreview(){let e=Object.keys(this.state.selectedRequestedVersions),t=[],s=e[0];return e.forEach((e=>{t.push(this.state.selectedRequestedVersions[e].name)})),{versionTag:e,apiName:t,version:s}}getVersionsForPreview(){let e=Object.keys(this.state.selectedVersions),t=[],s=e[0];return e.forEach((e=>{t.push(this.state.selectedVersions[e].name)})),{versionTag:e,apiName:t,version:s}}componentDidUpdate(e){let{availableEnvironments:t,availableCustomDomains:s,requestedEnvironment:i,publishedEnvironment:o,requestedEnvironmentOwner:n,publishedEnvironmentOwner:a,requestedCustomDomain:l,publishedCustomDomain:r}=this.props||{},c=e.availableEnvironments,d=e.availableCustomDomains;JSON.stringify(t)===JSON.stringify(c)&&JSON.stringify(s)===JSON.stringify(d)||this.setState({selectedRequestedEnvironment:U.findIndex(t,{id:i,owner:n}),selectedEnvironment:U.findIndex(t,{id:o,owner:a}),selectedRequestedEnvironmentDetails:U.find(t,{id:i,owner:n}),selectedEnvironmentDetails:U.find(t,{id:o,owner:a}),selectedRequestedDomain:U.findIndex(s,{id:l}),selectedDomain:U.findIndex(s,{id:r})},(()=>{this.handlePreview()}))}render(){const{isOffline:e,collectionUid:t,collectionName:s,workspaceId:i,teamLogoUrl:n,availableCustomDomains:a,isPublishing:l,isCollectionPublished:r,isRequesting:d,isGovernance:u,isCommunityManager:g,isCollectionPublishRequested:O,isRequestRetracting:_,isRequestApproving:q,isLimitReachedForPublish:A,isRepeatSpammer:L}=this.props,{selectedRequestedDomain:x,selectedDomain:M,selectedRequestedVersions:V,selectedVersions:W,selectedRequestedEnvironment:B,selectedEnvironment:F,selectedRequestedEnvironmentDetails:Y,selectedEnvironmentDetails:$,selectedDomainUnavailable:H,requestedDomainId:G,publishedDomainId:z,isRequestedColorInvalid:J,isColorInvalid:K,activeSidebarItem:Q,triggerShare:X,isSharing:Z,versionsDropdownPlaceholder:ee,requestedDocumentationLayout:te,documentationLayout:se,domainUpstreamViewPermission:ie,domainUpstreamViewPermissionLoading:oe,requestedDocumentationLayoutActiveTabIndex:ne,documentationLayoutActiveTabIndex:ae,noteToCommunityManager:le}=this.state;let re=this.state.customColors,ce=this.state.requestedCustomColors,de=this.getEnvironmentMenuItems(),ue=Boolean(this.props.requestedEnvironment),he=Boolean(this.props.publishedEnvironment),me=U.get(this.props.environments,"loading",!1),pe=this.getRequestedCustomDomainMenuItems(),be=this.getCustomDomainMenuItems(),ge=U.get(this.props.customDomains,"loading",!1),ye=this.getCollectionVersions(),ve=-1===this.state.selectedRequestedEnvironment,Ee=-1===this.state.selectedEnvironment,fe=-1===this.state.selectedRequestedDomain,Ce=-1===this.state.selectedDomain,we=u&&!g,Ie=u?g&&A&&!r:A&&!r;return o.createElement("div",null,!L&&Ie&&o.createElement("div",{className:"documentation-publish-settings--limit-reached-banner"},o.createElement(f.default,{status:"warning"},o.createElement(C.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),o.createElement("div",{className:"documentation-publish-settings"},o.createElement("div",{className:"documentation-publish-settings-left-sidebar"},o.createElement("h1",{className:"documentation-publish-settings-left-sidebar--page-name"},u&&O||we?"Request Collection Documentation Publish":"Publish collection"),o.createElement("p",{className:"documentation-publish-settings-left-sidebar--collection-name"},s),o.createElement(b.default,{activeItem:Q,heading:"Publish collection",handlePreview:this.handlePreview,options:[{label:"Content",hash:"#content"},{label:"URL",hash:"#url"},{label:"Styling",hash:"#styling"}],onClick:e=>{this.setState({activeSidebarItem:e.hash})}})),u&&O||we?o.createElement(o.Fragment,null,o.createElement("div",{className:"documentation-publish-settings-main-content"},o.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Content"),o.createElement("div",{className:"content--versions"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Version"),o.createElement("div",{className:"content--dropdown"},o.createElement(m.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",selectedItems:V,items:ye,onSelect:this.handleRequestedVersionSelect,dropDownPlaceholder:ee}),o.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish.  ",o.createElement(E.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},o.createElement(C.default,{className:"documentation-default-link__text"},"Learn more")),"  about versions"))),o.createElement("div",{className:"content--environment"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Environment"),o.createElement("div",{className:"content--dropdown"},o.createElement(h.DropdownComponent,{className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":ve}),disabled:me,dropdownType:"simple",dropdownStyle:"carat",dropdownItems:de,onSelectItem:this.handleRequestedEnvironmentSelect,initialSelectedIndex:B+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(ue?"--environment-button":"--no-environment-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),o.createElement("div",{className:"content--helper-text"},"Publish the selected environment variables and values along   with the collection. ",o.createElement("a",{href:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},"Learn how")," to manage your environments.")))),o.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},o.createElement("div",{className:"url--header-container"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label url--heading"},"URL"),o.createElement("span",{className:"url--optional"}," (optional)")),o.createElement("div",{className:"url--custom-domains"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Custom Domain"),o.createElement("div",{className:"content--dropdown"},o.createElement(h.DropdownComponent,{className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":fe}),dropdownType:"simple",dropdownStyle:"carat",disabled:ge,dropdownItems:pe,onSelectItem:this.handleRequestedCustomDomainSelect,initialSelectedIndex:x+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(ue?"--domain-button":"--no-domain-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),o.createElement("div",{className:"content--helper-text"},"The collection documentation will be published at the selected domain")),o.createElement(v.default,{publishedDomainIndex:G,selectedDomainIndex:x,customDomains:a,domainUpstreamViewPermission:ie,domainUpstreamViewPermissionLoading:oe}))),o.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Styling"),o.createElement("div",{className:"styling--layout"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Default layout"),o.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                    plugin__workspace-view-switcher__wrapper\n                    plugin__workspace-view-switcher"},o.createElement(w.default,{activeTabIndex:ne,onChange:this.handleRequestedLayoutToggle,type:"secondary"},o.createElement(I.default,null,o.createElement(S.default,{label:"Double Column"}),o.createElement(S.default,{label:"Single Column"}))))),o.createElement(y.default,{documentationLayout:te,highlightColor:J.highlight?this.getRequestedDefaultColor("highlight"):ce.highlight,sidebarColor:J["right-sidebar"]?this.getRequestedDefaultColor("right-sidebar"):ce["right-sidebar"],topBarColor:J["top-bar"]?this.getRequestedDefaultColor("top-bar"):ce["top-bar"],teamLogoUrl:n}),o.createElement("div",{className:"styling--colors"},o.createElement("div",{className:"styling--colors--header"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Header background color"),o.createElement(p.default,{colorHex:ce["top-bar"],pristineColorHex:this.getRequestedDefaultColor("top-bar"),onColorChange:e=>{this.handleRequestedCustomColorChange(ce,"top-bar",e)},isColorInvalid:J["top-bar"]})),o.createElement("div",{className:"styling--colors--code"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Code background color"),o.createElement(p.default,{colorHex:ce["right-sidebar"],pristineColorHex:this.getRequestedDefaultColor("right-sidebar"),onColorChange:e=>{this.handleRequestedCustomColorChange(ce,"right-sidebar",e)},isColorInvalid:J["right-sidebar"]})),o.createElement("div",{className:"styling--colors--highlight"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Highlight color"),o.createElement(p.default,{colorHex:ce.highlight,pristineColorHex:this.getRequestedDefaultColor("highlight"),onColorChange:e=>{this.handleRequestedCustomColorChange(ce,"highlight",e)},isColorInvalid:J.highlight})))),!g&&o.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},o.createElement("div",{className:"governance--textarea"},o.createElement(N.default,{direction:"column",width:"48%",gap:"spacing-s"},o.createElement(T.default,{label:o.createElement(P.default,{text:"Include a note for the Community Manager"}),value:le,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"Add a note to community manager"})),o.createElement("div",{className:"governance--helper-text"},"Let the Community Manager know why you’d like this collection's documentation to be published. "))),o.createElement("hr",null),o.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},o.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},we?o.createElement(k.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:d,isDisabled:H||d||this.isRequestedColorInvalid()||e,text:O?"Update Request":"Request Publish"}):o.createElement(k.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleApproveRequest,isLoading:q||Z,isDisabled:H||q||Z||this.isRequestedColorInvalid()||e||L||A&&!r,text:"Save and Approve",tooltip:A&&!r&&o.createElement(D.default,{content:"You’ve reached your limit to publish documentation",placement:"top"})}),o.createElement(k.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"}),we&&O&&o.createElement(o.Fragment,null,o.createElement(k.default,{type:"destructive",size:"medium",className:"publish-button",isDisabled:_||e,isLoading:_,onClick:()=>{this.setState({showRetractConfirmationModal:!0})},text:"Retract request"}),o.createElement(R.Modal,{isOpen:this.state.showRetractConfirmationModal,onClose:()=>this.setState({showRetractConfirmationModal:!1})},o.createElement(R.ModalHeader,{heading:"Retract Request?"}),o.createElement(R.ModalContent,null,"Are you sure you want to retract the request to publish this collection's documentation?"),o.createElement(R.ModalFooter,null,o.createElement(N.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},o.createElement(k.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showRetractConfirmationModal:!1})}),o.createElement(k.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleRetractRequest()}})))))),o.createElement("div",{className:"content--helper-text"},we?"Community Manager will be notified of the changes.":"Completing this step will make your collection available at a public URL.")))):o.createElement(o.Fragment,null,o.createElement("div",{className:"documentation-publish-settings-main-content"},o.createElement("div",{className:"documentation-publish-settings-main-content--content",id:"content"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Content"),o.createElement("div",{className:"content--versions"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Version"),o.createElement("div",{className:"content--dropdown"},o.createElement(m.default,{className:"dropdown-content--dropdown-menu content--versions--dropdown",selectedItems:W,items:ye,onSelect:this.handleVersionSelect,dropDownPlaceholder:ee}),o.createElement("div",{className:"content--helper-text"},"Select one or more collection states to publish.  ",o.createElement(E.default,{to:"https://go.pstmn.io/public-documentation-versioning",className:"documentation-default-link",rel:"noopener noreferrer",target:"_blank"},o.createElement(C.default,{className:"documentation-default-link__text"},"Learn more")),"  about versions"))),o.createElement("div",{className:"content--environment"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Environment"),o.createElement("div",{className:"content--dropdown"},o.createElement(h.DropdownComponent,{className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ee}),disabled:me,dropdownType:"simple",dropdownStyle:"carat",dropdownItems:de,onSelectItem:this.handleEnvironmentSelect,initialSelectedIndex:F+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(he?"--environment-button":"--no-environment-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),o.createElement("div",{className:"content--helper-text"},"Publish the selected environment variables and values along   with the collection. ",o.createElement("a",{href:"https://learning.postman.com/docs/sending-requests/managing-environments/",rel:"noopener noreferrer",target:"_blank"},"Learn how")," to manage your environments.")))),o.createElement("div",{className:"documentation-publish-settings-main-content--url",id:"url"},o.createElement("div",{className:"url--header-container"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label url--heading"},"URL"),o.createElement("span",{className:"url--optional"}," (optional)")),o.createElement("div",{className:"url--custom-domains"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Custom Domain"),o.createElement("div",{className:"content--dropdown"},o.createElement(h.DropdownComponent,{className:c()({"documentation-dropdown":!0,"documentation-dropdown--publish-page":!0,"documentation-dropdown--empty":Ce}),dropdownType:"simple",dropdownStyle:"carat",disabled:ge,dropdownItems:be,onSelectItem:this.handleCustomDomainSelect,initialSelectedIndex:M+1,dropdownMenuClassName:"dropdown-content--dropdown-menu",dropdownButtonClassName:"dropdown-content--dropdown-button"+(he?"--domain-button":"--no-domain-button"),alwaysDisplayDropdown:!0,showMenuItemTooltip:!0}),o.createElement("div",{className:"content--helper-text"},"The collection documentation will be published at the selected domain")),o.createElement(v.default,{publishedDomainIndex:z,selectedDomainIndex:M,customDomains:a,domainUpstreamViewPermission:ie,domainUpstreamViewPermissionLoading:oe}))),o.createElement("div",{className:"documentation-publish-settings-main-content--styling",id:"styling"},o.createElement("h4",{className:"documentation-publish-settings-main-content--main-label"},"Styling"),o.createElement("div",{className:"styling--layout"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Default layout"),o.createElement("div",{className:"documentation-publish-settings-main-content--styling--layout\n                    plugin__workspace-view-switcher__wrapper\n                    plugin__workspace-view-switcher"},o.createElement(w.default,{activeTabIndex:ae,onChange:this.handleLayoutToggle,type:"secondary"},o.createElement(I.default,null,o.createElement(S.default,{label:"Double Column"}),o.createElement(S.default,{label:"Single Column"}))))),o.createElement(y.default,{documentationLayout:se,highlightColor:K.highlight?this.getDefaultColor("highlight"):re.highlight,sidebarColor:K["right-sidebar"]?this.getDefaultColor("right-sidebar"):re["right-sidebar"],topBarColor:K["top-bar"]?this.getDefaultColor("top-bar"):re["top-bar"],teamLogoUrl:n}),o.createElement("div",{className:"styling--colors"},o.createElement("div",{className:"styling--colors--header"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Header background color"),o.createElement(p.default,{colorHex:re["top-bar"],pristineColorHex:this.getDefaultColor("top-bar"),onColorChange:e=>{this.handleCustomColorChange(re,"top-bar",e)},isColorInvalid:K["top-bar"]})),o.createElement("div",{className:"styling--colors--code"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Code background color"),o.createElement(p.default,{colorHex:re["right-sidebar"],pristineColorHex:this.getDefaultColor("right-sidebar"),onColorChange:e=>{this.handleCustomColorChange(re,"right-sidebar",e)},isColorInvalid:K["right-sidebar"]})),o.createElement("div",{className:"styling--colors--highlight"},o.createElement("p",{className:"documentation-publish-settings-main-content--sub-label"},"Highlight color"),o.createElement(p.default,{colorHex:re.highlight,pristineColorHex:this.getDefaultColor("highlight"),onColorChange:e=>{this.handleCustomColorChange(re,"highlight",e)},isColorInvalid:K.highlight})))),!u&&o.createElement(j.default,{triggerShare:X,collectionUid:t,collectionName:s,onShareComplete:this.onShareComplete,workspaceId:i,selectedEnvironment:$}),we&&o.createElement("div",{className:"documentation-publish-settings-main-content--governance",id:"governance"},o.createElement("div",{className:"governance--textarea"},o.createElement(N.default,{direction:"column",width:"48%",gap:"spacing-s"},o.createElement(T.default,{label:o.createElement(P.default,{text:"Include a note for the Community Manager"}),value:le,onChange:e=>this.handleNoteToCommunityManager(e.target.value),placeholder:"Add a note to community manager"})),o.createElement("div",{className:"governance--helper-text"},"Let the Community Manager know why you’d like this collections documentation to be published. "))),o.createElement("hr",null),o.createElement("div",{className:"documentation-publish-settings-main-content--ctas"},o.createElement("div",{className:"documentation-publish-settings-main-content--ctas--buttons"},we?o.createElement(k.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handleRequestPublishButtonClick,isLoading:d,isDisabled:H||d||this.isColorInvalid()||e,text:O?"Update Request":"Request Publish"}):o.createElement(k.default,{type:"primary",size:"medium",className:"publish-button",onClick:this.handlePublishButtonClick,isLoading:l||Z,isDisabled:H||l||Z||this.isColorInvalid()||e||L||A&&!r,text:r?"Save and republish":"Publish",tooltip:L?o.createElement(D.default,{content:"We've temporarily blocked you from publishing documents as your content did not meet our community standards. Please try again later or contact support.",placement:"top"}):A&&!r?o.createElement(D.default,{content:"You’ve reached your limit to publish documentation",placement:"top"}):""}),o.createElement(k.default,{type:"secondary",size:"medium",className:"publish-doc-cancel-button",onClick:this.handleCancel,text:"Cancel"}),we&&O&&o.createElement(k.default,{type:"destructive",size:"medium",className:"publish-button",isDisabled:_||e,isLoading:_,onClick:this.handleRetractRequest,text:"Retract request"})),o.createElement("div",{className:"content--helper-text"},"Completing this step will make your collection available at a public URL."))))))}})||i;B.propTypes={publishButtonCallback:a().func.isRequired,cancelButtonCallback:a().func.isRequired,collectionName:a().string.isRequired,workspaceId:a().string.isRequired,availableVersions:a().array,availableEnvironments:a().array,availableCustomDomains:a().array,publishedStyling:a().object,publishedVersions:a().object,publishedEnvironment:a().string,publishedEnvironmentOwner:a().string,publishedCustomDomain:a().number,teamLogoUrl:a().string,isOffline:a().bool},B.defaultProps={availableVersions:[{key:"latest",label:"CURRENT"}]}},"./documentation/components/DocumentationPublishView/PublishedStatus.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return P}});var i,o=s("../../node_modules/react/index.js"),n=s("./node_modules/prop-types/index.js"),a=s.n(n),l=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=s("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),c=s("../../node_modules/@postman/aether/esmLib/src/components/Text/Text.js"),d=s("../../node_modules/@postman/aether/esmLib/src/components/Breadcrumb/Breadcrumb.js"),u=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),m=s("../../node_modules/@postman/aether/esmLib/src/components/Modal/Modal.js"),p=s("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),b=s("../../node_modules/@postman/aether/esmLib/src/components/TextArea/TextArea.js"),g=s("../../node_modules/@postman/aether/esmLib/src/components/Label/Label.js"),y=s("../../node_modules/@postman/aether/esmLib/src/components/Heading/Heading.js"),v=s("./documentation/components/DocumentationPublishView/PublishedViewPreview.js"),E=s("./appsdk/components/link/Link.js"),f=s("./js/components/base/Modals.js"),C=s("./apinetwork/services/PublicProfileService.js"),w=s("./documentation/constants.js"),I=s("./iam/src/common/styled-components/CopyButton.js"),S=s("./js/utils/ClipboardHelper.js"),N=s("./js/modules/services/AnalyticsService.js"),T=s("./node_modules/lodash/lodash.js");let P=(0,l.observer)(i=class extends o.Component{constructor(e){super(e),this.handleEditSettings=()=>{const{editSettingsButtonCallback:e}=this.props;"function"==typeof e&&e(),N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"edit_settings",label:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleUnpublish=()=>{const{unPublishButtonCallback:e}=this.props;"function"==typeof e&&e(),N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"unpublish_documentation",label:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleApproveRequest=()=>{const{approveRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;let s=this.getRequestPayload();"function"==typeof e&&e(s,t),N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"approve_request",label:this.props.isViewOnlyStatusPage?w.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleDenyRequest=()=>{this.setState({showDenyConfirmationModal:!1});const{denyRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(this.state.denyRequestNote,t),N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"deny_request",label:this.props.isViewOnlyStatusPage?w.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.handleRetractRequest=()=>{this.setState({showRetractConfirmationModal:!1});const{retractRequestButtonCallback:e,collectionPublishRequestCode:t}=this.props;"function"==typeof e&&e(t),N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"retract_request_status",label:this.props.isViewOnlyStatusPage?w.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},this.state={showCollectionDiscovery:!1,collectionType:null,apinetworkData:{},modalOpen:!1,modalLoading:!1,showRetractConfirmationModal:!1,showDenyConfirmationModal:!1,denyRequestNote:"",showBanner:!0},this.handleModalToggle=this.handleModalToggle.bind(this),this.handleRemoveFromPublicAPINetwork=this.handleRemoveFromPublicAPINetwork.bind(this),this.handleCopyButtonClick=this.handleCopyButtonClick.bind(this),this.handleDismissBanner=this.handleDismissBanner.bind(this)}async componentDidMount(){const{publishedId:e}=this.props;try{const t=await Promise.all([C.default.getApiNetwork({publishedId:e}),C.default.getTemplate({publishedId:e})]),s=T.get(t,"0.body.data[0]"),i=T.get(t,"1.body.data[0]");s?this.setState({showCollectionDiscovery:!0,collectionType:"apinetwork",apinetworkData:s}):i&&this.setState({showCollectionDiscovery:!0,collectionType:"template",apinetworkData:i})}catch(e){pm.logger.error("PublishedStatus~componentDidMount - Error while fetching apinetwork data",e)}}getRequestedVersionNames(){let e=this.props.requestedVersions;return(Array.isArray(e)&&e.map((e=>e.apiName))||[]).join(", ")}getVersionNames(){let e=this.props.publishedVersions;return(Array.isArray(e)&&e.map((e=>e.apiName))||[]).join(", ")}handleModalToggle(){this.setState((e=>({modalOpen:!e.modalOpen})))}getRequestPayload(){let{requestData:e}=this.props,t=T.get(e,"data.body.data[0]",{}),{modelId:s}=t,{environmentTemplateId:i,environmentOwner:o,customDomainId:n,customColor:a,versionTag:l,documentationLayout:r}=t.metadata;return e&&{uid:s,environmentTemplateId:i,environmentOwner:o,customDomainId:n,customColor:a,versionTag:l,documentationLayout:r}}async handleRemoveFromPublicAPINetwork(){this.setState({modalLoading:!0});try{const{collectionType:e,apinetworkData:t}=this.state,s=T.get(t,"id","");"apinetwork"===e?await C.default.removeApiNetwork({id:s}):await C.default.removeTemplate({id:s}),this.setState({modalLoading:!1,showCollectionDiscovery:!1,collectionType:"",apinetworkData:{},modalOpen:!1}),pm.toasts.success("Successfully removed collection from Public API Network")}catch(e){pm.toasts.error("Could not remove collection from Public API Network"),pm.logger.error("PublishedStatus~handleRemoveFromPublicAPINetwork - Error while removing collection",e),this.setState({modalLoading:!1})}}handleDenyRequestNote(e){this.setState({denyRequestNote:e})}handleDismissBanner(){this.setState({showBanner:!1})}handleCopyButtonClick(){const{publishedUrl:e}=this.props;S.default.copy(e),pm.toasts.success("Published documentation's URL copied to clipboard successfully.")}render(){const{isOffline:e,isUnpublishing:t,handleBreadcrumbClick:s,collectionName:i,requestedCollectionName:n,teamLogoUrl:a,requestedEnvironment:l,publishedEnvironment:C,publishedUrl:S,isCollectionPublishRequested:P,noteToCommunityManager:k,isCommunityManager:D,isGovernance:R,isRequestRetracting:O,isRequestDenying:_,isRequestApproving:q,isViewOnlyStatusPage:A,isLimitReachedForPublish:L,isCollectionPublished:j}=this.props,{collectionType:x,modalOpen:U,modalLoading:M,showBanner:V}=this.state;let W=T.get(this.props.publishedStyling,"documentationLayout"),B=T.get(this.props.requestedStyling,"documentationLayout"),F=T.get(this.props.requestedStyling,"customColor",{}),Y=T.get(this.props.publishedStyling,"customColor",{}),$=T.get(this.state.apinetworkData,"publicURL",""),H=T.get(this.state.apinetworkData,"team")?T.get(this.state.apinetworkData,"team.publicURL",""):T.get(this.state.apinetworkData,"publishedBy.publicURL",""),G=R&&P?"Requested Settings":"Publication settings",z=[{id:this.props.collectionUid,name:T.isEmpty(this.props.collectionName)?this.props.requestedCollectionName:this.props.collectionName,type:w.DOCUMENTATION_ENTITY.COLLECTION,workspaceId:this.props.workspaceId},{id:this.props.collectionUid,name:w.DOCUMENTATION_TITLE,type:w.DOCUMENTATION_WORKBENCH_IDENTIFIER,workspaceId:this.props.workspaceId}];return z.push({name:G}),o.createElement("div",{className:"documentation-published-status"},R&&P&&D&&L&&!j&&o.createElement("div",{className:"documentation-published-status-body--limit-reached-banner"},o.createElement(r.default,{status:"warning"},o.createElement(c.default,null,"You've reached your limit to publish documentation. You can unpublish existing documentation in your team or contact support to increase the limit."))),o.createElement(d.Breadcrumb,{className:"documentation-published-breadcrumbs",onItemClick:s},z.map((e=>o.createElement(d.BreadcrumbItem,{itemData:e,key:e.name},e.name)))),R&&P?o.createElement(o.Fragment,null,o.createElement("div",{className:"documentation-published-status-header"},o.createElement("div",null,o.createElement("h3",null,"Requested settings")),o.createElement("div",{className:"documentation-published-status-header--buttons"},o.createElement(u.default,{type:"outline",size:"medium",className:"edit-settings-button",isDisabled:t||A,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(t||A)&&o.createElement(h.default,{content:"You do not have access to the underlying collection.",placement:"top"})}),P?D?o.createElement(o.Fragment,null,o.createElement(u.default,{type:"primary",size:"medium",className:"approve-button",isDisabled:q||e||L&&!j,isLoading:q,onClick:this.handleApproveRequest,text:"Approve",tooltip:L&&!j&&o.createElement(h.default,{content:"You’ve reached your limit to publish documentation",placement:"top"})}),o.createElement(u.default,{type:"secondary",size:"medium",className:"deny-button",isDisabled:_||e,isLoading:_,onClick:()=>{this.setState({showDenyConfirmationModal:!0})},text:"Deny"}),o.createElement(m.Modal,{isOpen:this.state.showDenyConfirmationModal,onClose:()=>this.setState({showDenyConfirmationModal:!1})},o.createElement(m.ModalHeader,{heading:"Deny Request?"}),o.createElement(m.ModalContent,null,"Are you sure you want to deny the request to publish this collection's documentation?"),o.createElement(p.default,{direction:"column",gap:"spacing-s",padding:"spacing-xl"},o.createElement(b.default,{label:o.createElement(g.default,{text:"Add a note"}),rows:3,value:this.state.denyRequestNote,onChange:e=>this.handleDenyRequestNote(e.target.value),placeholder:"Enter the reason to deny the publish request."})),o.createElement(m.ModalFooter,null,o.createElement(p.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},o.createElement(u.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showDenyConfirmationModal:!1})}),o.createElement(u.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleDenyRequest()}}))))):o.createElement(o.Fragment,null,o.createElement(u.default,{type:"destructive",size:"medium",className:"unpublish-button",isDisabled:O||e,isLoading:O,onClick:()=>{this.setState({showRetractConfirmationModal:!0})},text:"Retract request"}),o.createElement(m.Modal,{isOpen:this.state.showRetractConfirmationModal,onClose:()=>this.setState({showRetractConfirmationModal:!1})},o.createElement(m.ModalHeader,{heading:"Retract Request?"}),o.createElement(m.ModalContent,null,"Are you sure you want to retract the request to publish this collection's documentation?"),o.createElement(m.ModalFooter,null,o.createElement(p.default,{justifyContent:"flex-end",grow:1,shrink:1,gap:"spacing-s"},o.createElement(u.default,{type:"secondary",text:"Cancel",onClick:()=>this.setState({showRetractConfirmationModal:!1})}),o.createElement(u.default,{type:"destructive",text:"Confirm",onClick:()=>{this.handleRetractRequest()}}))))):o.createElement(u.default,{type:"destructive",size:"medium",className:`unpublish-button ${(R&&!D||t||e)&&"unpublish-button--disabled"}`,isDisabled:R&&!D||t||e,tooltip:R&&!D&&"Only community manager can unpublish this documentation.",isLoading:t,onClick:this.handleUnpublish,text:"Unpublish"}))),o.createElement("hr",null),o.createElement("div",{className:"documentation-published-status-body"},A&&V&&o.createElement("div",{className:"documentation-published-status-body--private-collection-banner"},o.createElement(r.default,{status:"warning",onDismiss:this.handleDismissBanner},"You don't have access to the underlying collection.")),!T.isEmpty(k)&&o.createElement("div",{className:"documentation-published-status-body--note"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Note to the Community Manager"),o.createElement("p",{className:"documentation-published-status-body--content--note-to-cm"},k)),o.createElement("div",{className:"documentation-published-status-body--content"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Collection Name"),o.createElement("p",{className:"documentation-published-status-body--content--collection-name"},T.isEmpty(i)?n:i),o.createElement("p",{className:"documentation-published-status-body--content--versions"},"Versions: ",this.getRequestedVersionNames())),o.createElement("div",{className:"documentation-published-status-body--environment"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Environment"),o.createElement("span",{className:"documentation-published-status-body--content--environment"},l)),o.createElement("div",{className:"documentation-published-status-body--styling"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Styling"),o.createElement(v.default,{documentationLayout:B,highlightColor:F.highlight,sidebarColor:F["right-sidebar"],topBarColor:F["top-bar"],teamLogoUrl:a})),this.state.showCollectionDiscovery&&o.createElement("div",{className:"documentation-published-status-body--collection-discovery"},o.createElement("div",{className:"documentation-published-status-body--heading"},o.createElement(y.default,{type:"h2",text:"Collection Discovery"}),o.createElement(u.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),o.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},o.createElement(y.default,{type:"h4",text:"template"===x?"Postman templates":"Postman API Network"}),o.createElement(c.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",o.createElement("br",null),o.createElement(E.default,{to:$,target:"_blank"},$))),o.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},o.createElement(y.default,{type:"h4",text:"Publisher Profile"}),o.createElement(c.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",o.createElement(E.default,{to:H,target:"_blank"},H),". All your published work can be found here")))),o.createElement(f.Modal,{isOpen:U,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},o.createElement(f.ModalHeader,null,"Remove from Public API Network"),o.createElement(f.ModalContent,null,o.createElement(c.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",o.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),o.createElement(f.ModalFooter,null,o.createElement(u.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:M,text:"Remove from Public API Network"}),o.createElement(u.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:M,text:"Cancel"})))):o.createElement(o.Fragment,null,o.createElement("div",{className:"documentation-published-status-header"},o.createElement("div",null,o.createElement("h3",null,"Publication settings")),o.createElement("div",{className:"documentation-published-status-header--buttons"},o.createElement(u.default,{type:"secondary",size:"medium",className:"edit-settings-button",isDisabled:t||A,onClick:this.handleEditSettings,text:"Edit Settings",tooltip:(t||A)&&o.createElement(h.default,{content:"You do not have access to the underlying collection.",placement:"top"})}),o.createElement(u.default,{type:"destructive",size:"medium",className:`unpublish-button ${(R&&!D||t||e)&&"unpublish-button--disabled"}`,isDisabled:t||e||R&&!D,tooltip:R&&!D&&"Only community manager can unpublish this documentation.",isLoading:t,onClick:this.handleUnpublish,text:"Unpublish"}))),o.createElement("hr",null),o.createElement("div",{className:"documentation-published-status-body"},o.createElement("div",{className:"documentation-published-status-body--content"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Published Collection"),o.createElement("p",{className:"documentation-published-status-body--content--collection-name"},i),o.createElement("p",{className:"documentation-published-status-body--content--versions"},"Versions: ",this.getVersionNames())),o.createElement("div",{className:"documentation-published-status-body--environment"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Environment"),o.createElement("span",{className:"documentation-published-status-body--content--environment"},C)),o.createElement("div",{className:"documentation-published-status-body--url"},o.createElement("h4",{className:"documentation-published-status-body--label"},"URL for published documentation"),o.createElement("span",null,o.createElement(E.default,{to:S,onClick:()=>{N.default.addEventV2({category:w.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_published_url",label:w.DOCUMENTATION_ANALYTICS.LABEL.PUBLISHED_STATUS_TAB,entityType:w.DOCUMENTATION_ENTITY.COLLECTION,entityId:this.props.collectionUid})},target:"_blank"},S),o.createElement("span",{className:"documentation-published-status-body--copy-to-clipboard"},o.createElement(I.default,{type:"muted-plain",icon:"icon-action-copy-stroke",onClick:this.handleCopyButtonClick,tooltip:"Copy to clipboard"})))),o.createElement("div",{className:"documentation-published-status-body--styling"},o.createElement("h4",{className:"documentation-published-status-body--label"},"Styling"),o.createElement(v.default,{documentationLayout:W,highlightColor:Y.highlight,sidebarColor:Y["right-sidebar"],topBarColor:Y["top-bar"],teamLogoUrl:a})),this.state.showCollectionDiscovery&&o.createElement("div",{className:"documentation-published-status-body--collection-discovery"},o.createElement("div",{className:"documentation-published-status-body--heading"},o.createElement(y.default,{type:"h2",text:"Collection Discovery"}),o.createElement(u.default,{onClick:this.handleModalToggle,type:"text",text:"Remove from Public API Network"})),o.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},o.createElement(y.default,{type:"h4",text:"template"===x?"Postman templates":"Postman API Network"}),o.createElement(c.default,{type:"body-medium",color:"content-color-primary"},"Your listing is published on the Public API Network at"," ",o.createElement("br",null),o.createElement(E.default,{to:$,target:"_blank"},$))),o.createElement("div",{className:"documentation-published-status-body--collection-discovery__section"},o.createElement(y.default,{type:"h4",text:"Publisher Profile"}),o.createElement(c.default,{type:"body-medium",color:"content-color-primary"},"Your public profile is ",o.createElement(E.default,{to:H,target:"_blank"},H),". All your published work can be found here")))),o.createElement(f.Modal,{isOpen:U,onRequestClose:this.handleModalToggle,className:"documentation-published-status-modal"},o.createElement(f.ModalHeader,null,"Remove from Public API Network"),o.createElement(f.ModalContent,null,o.createElement(c.default,{type:"body-large",color:"content-color-primary"},"Are you sure you want to remove this collection from the Public API network? ",o.createElement("br",null),"This collection would still be available through the published documentation but not discoverable through the API Network.")),o.createElement(f.ModalFooter,null,o.createElement(u.default,{type:"primary",className:"documentation-published-status-modal__remove-btn",onClick:this.handleRemoveFromPublicAPINetwork,isDisabled:M,text:"Remove from Public API Network"}),o.createElement(u.default,{type:"secondary",onClick:this.handleModalToggle,isDisabled:M,text:"Cancel"})))))}})||i;P.propTypes={unPublishButtonCallback:a().func.isRequired,editSettingsButtonCallback:a().func.isRequired,handleBreadcrumbClick:a().func.isRequired,collectionName:a().string.isRequired,collectionUid:a().string.isRequired,publishedUrl:a().string,publishedId:a().string.isRequired,publishedOwner:a().string.isRequired,publishedStyling:a().object.isRequired,publishedVersions:a().array.isRequired,publishedEnvironment:a().string,teamLogoUrl:a().string.isRequired,isOffline:a().bool.isRequired}},"./documentation/components/DocumentationPublishView/PublishedViewPreview.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return a}});var i=s("../../node_modules/react/index.js"),o=s("./documentation/utils/utils.js"),n=s("./documentation/constants.js");function a(e){const{documentationLayout:t}=e;switch(t){case"classic-double-column":default:return i.createElement(l,e);case"classic-single-column":return i.createElement(r,e)}}function l(e){let{highlightColor:t,topBarColor:s,sidebarColor:a,teamLogoUrl:l}=e,r={opacity:.05},c={opacity:.1},d={opacity:.1};return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,i.createElement("svg",{id:"documenter-preview-double-col",width:"100%",height:"130px"},i.createElement("rect",{x:"0",y:"0",width:"100%",height:"170",stroke:"#d8d8d8",style:{strokeWidth:1}}),i.createElement("rect",{x:"0",y:30,width:"100%",height:"130",fill:"#ffffff"}),i.createElement("rect",{x:"0",y:30,width:"30%",height:"130",fill:"#303030",style:{opacity:.05}}),i.createElement("rect",{x:"2%",y:"40",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"80",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"95",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"32%",y:"40",width:"41%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"32%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"32%",y:"80",width:"15%",height:"10",rx:"3",ry:"3",fill:(0,o.formatInputHex)(t)}),i.createElement("rect",{x:"75%",y:30,width:"25%",height:"130",fill:(0,o.formatInputHex)(a)}),i.createElement("rect",{x:"75%",y:"40",width:"25%",height:"20",fill:"#ffffff",style:c}),i.createElement("rect",{x:"75%",y:"80",width:"25%",height:"10",fill:"#ffffff",style:c}),i.createElement("rect",{x:"0",y:"0",width:"100%",height:30,fill:(0,o.formatInputHex)(s),stroke:"#000000",style:{strokeWidth:.5,strokeOpacity:.3}}),i.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),i.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:d}),i.createElement("rect",{x:"66%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:d}))}function r(e){let{highlightColor:t,topBarColor:s,sidebarColor:a,teamLogoUrl:l}=e,r={opacity:.05},c={opacity:.1};return l=l||n.DOCUMENTATION_PUBLISHING.DEFAULT_DOCUMENTATION_LOGO_URL,i.createElement("svg",{id:"documenter-preview-single-col",width:"100%",height:"130px"},i.createElement("rect",{x:"0",y:"0",width:"100%",height:"170",stroke:"#d8d8d8",style:{strokeWidth:1}}),i.createElement("rect",{x:"0",y:30,width:"100%",height:"130",fill:"#ffffff"}),i.createElement("rect",{x:"0",y:30,width:"30%",height:"130",fill:"#303030",style:{opacity:.05}}),i.createElement("rect",{x:"2%",y:"40",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"55",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"80",width:"26%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"95",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"2%",y:"135",width:"15%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"37%",y:"40",width:"45%",height:"10",rx:"3",ry:"3",fill:"#000000",style:r}),i.createElement("rect",{x:"37%",y:"55",width:"35%",height:"10",rx:"3",ry:"3",fill:(0,o.formatInputHex)(t)}),i.createElement("rect",{x:"30%",y:"85",width:"70%",height:"50",fill:(0,o.formatInputHex)(a)}),i.createElement("rect",{x:"37%",y:"85",width:"56%",height:"50",rx:"3",ry:"3",fill:"#ffffff",style:{opacity:.1}}),i.createElement("rect",{x:"0",y:"0",width:"100%",height:30,fill:(0,o.formatInputHex)(s),stroke:"#000000",style:{strokeWidth:.5,strokeOpacity:.3}}),i.createElement("image",{xlinkHref:l,preserveAspectRatio:"xMinYMin",x:"10",y:"5",width:"57",height:"20"}),i.createElement("rect",{x:"83%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:c}),i.createElement("rect",{x:"66%",y:"7",width:"15%",height:"16",rx:"3",ry:"3",fill:"#000000",style:c}))}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/InputSelect.js":function(e,t,s){s.r(t),s.d(t,{InputSelect:function(){return f}});var i=s("../../node_modules/react/index.js"),o=(s("../../node_modules/react-dom/index.js"),s("./js/components/base/Inputs.js")),n=s("./js/components/base/Buttons.js"),a=s("./node_modules/classnames/index.js"),l=s.n(a),r=s("./node_modules/prop-types/index.js"),c=s.n(r),d=s("../../node_modules/@postman/aether/esmLib/src/components/Spinner/Spinner.js"),u=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),h=s("./js/stores/StoreManager.js"),m=s("./js/stores/CurrentUserStore.js"),p=s("./js/stores/FeatureFlagsStore.js"),b=s("./collaboration/services/PermissionService.js"),g=s("./js/components/base/Dropdowns.js"),y=s("./documentation/components/DocumentationIntersectionObserver/index.js"),v=s("./node_modules/lodash/lodash.js");let E="";class f extends i.Component{constructor(e){super(e),this.getFilteredListDebounce=v.debounce((e=>this.props.getFilteredList(e)),500),this.state={focusedItem:null,isOpen:!1,inputValue:e.getInputValue(e.selectedItem),selectedItem:e.selectedItem,permissions:[]},this.inputRef=i.createRef(),this.wrapperRef=i.createRef(),this.handleChange=this.handleChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleToggleList=this.handleToggleList.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleFocus=this.handleFocus.bind(this),this.handleSelect=this.handleSelect.bind(this),this.handleClose=this.handleClose.bind(this),this.handleCreateWorkspace=this.handleCreateWorkspace.bind(this),this.fetchPermissions=this.fetchPermissions.bind(this)}componentDidMount(){this.fetchPermissions()}async fetchPermissions(){const e=(0,h.resolveStoreInstance)(m.default).teamId,t=(0,h.resolveStoreInstance)(p.default).get("workspace:isCommunityManagerEnabled");let s={};if(e&&t){const{manageWorkspaceVisibilityRequests:t}=await(0,b.fetchPermissions)(["manageWorkspaceVisibilityRequests"],e);s.manageWorkspaceVisibilityRequests=t}this.setState({permissions:s,isCommunityManagerEnabled:t})}renderOptions(){const{optionRenderer:e,getFilteredList:t}=this.props,{inputValue:s,selectedItem:o,focusedItem:n}=this.state;if(!E||!s||E!==s||this._visibleItems)return E=s,this._visibleItems=this.props.dropdownItems,v.chain(this._visibleItems).map((t=>{let s=e(t,E),a=t.id===(n&&n.id),r=t.id===(o&&o.id);if(s&&t.id)return i.createElement(g.MenuItem,{className:l()({item:!0,"is-focused":a,"is-selected":r},"share-to-public-workspace-dropdown-item"),disabled:t.disabled,key:t.id,refKey:t.id,onMouseEnter:()=>{this.handleMouseEnter(t)},onMouseLeave:()=>{this.handleMouseLeave()},onSelect:()=>{this.handleSelect(t.id)}},s)})).compact().value()}handleMouseEnter(e){this.focusOption(e)}handleMouseLeave(){this.focusOption(null)}handleCancel(){this.props.clearSelectedItem(),setTimeout((()=>{this.focus()}),0)}focus(){this.inputRef.current&&this.inputRef.current.focus()}blur(){this.inputRef.current&&(this.inputRef.current.blur(),this.props.resetEmptyFilterOnBlur&&!this.state.inputValue&&this.setState({inputValue:this.props.getInputValue(this.props.selectedItem)}),pm.mediator.trigger("focusBuilder"),this.props.onBlur&&this.props.onBlur())}handleOpen(){this.setState({isOpen:!0},this.focus)}handleToggleList(){this.state.isOpen?this.handleClose():this.handleOpen()}handleClose(){this.state.isOpen&&this.setState({isOpen:!1},this.blur)}handleSelect(e){let t=v.find(this._visibleItems,{id:e});t&&this.selectFocusedOption(t)}handleKeyDown(e){let t=this.state.focusedItem;switch(e.key){case"ArrowDown":e.preventDefault(),this.focusAdjacentOption("next");break;case"ArrowUp":e.preventDefault(),this.focusAdjacentOption("previous");break;case"Enter":e.preventDefault(),t&&this.handleSelect(t.id),this.handleClose();break;case"Escape":e.preventDefault()}}handleFocus(){this.props.openOnFocus&&this.setState({isOpen:!0}),this.props.onFocus&&this.props.onFocus()}getNextVisibleItem(e,t){if(v.every(e,{disableFocus:!0}))return null;let s,i=v.findIndex(e,{id:t&&t.id});return-1===i||i===e.length-1?(s=e[0],s.disableFocus?this.getNextVisibleItem(e,s):s):(s=e[i+1],s.disableFocus?this.getNextVisibleItem(e,s):s)}getPreviousVisibleItem(e,t){if(v.every(e,{disableFocus:!0}))return null;let s,i=v.findIndex(e,{id:t&&t.id});return-1===i||0===i?(s=v.last(e),s.disableFocus?this.getPreviousVisibleItem(e,s):s):(s=e[i-1],s.disableFocus?this.getPreviousVisibleItem(e,s):s)}focusOption(e){this.setState({focusedItem:e})}focusAdjacentOption(e){let t=this.state.focusedItem,s=this._visibleItems;"next"===e?t=this.getNextVisibleItem(s,t):"previous"===e&&(t=this.getPreviousVisibleItem(s,t)),this._scrollToFocusedOption=!0,this.setState({focusedItem:t})}selectFocusedOption(e){const t=e||this.state.focusedItem;this.props.onSelect&&this.props.onSelect(t),this.handleClose()}handleChange(e){this.setState({inputValue:e,isOpen:!0,focusedItem:null},(()=>{this.getFilteredListDebounce(e),this.props.onChange&&this.props.onChange(e)}))}UNSAFE_componentWillReceiveProps(e){this.props.selectedItem!==e.selectedItem&&this.setState({selectedItem:e.selectedItem,inputValue:e.getInputValue(e.selectedItem)})}getWrapperClasses(){return l()({[this.props.className]:!0,"input-select-wrapper":!0,"is-open":this.state.isOpen,"is-disabled":this.props.disabled})}handleCreateWorkspace(){this.props.handleCreateNewWorkspace(),this.handleClose()}renderMenu(){let e=this.renderOptions(),t=v.get(this.state.permissions,"manageWorkspaceVisibilityRequests"),s=!(0,h.resolveStoreInstance)(p.default).get("workspace:isCommunityManagerEnabled")&&!t;return i.createElement(y.default,null,(({rootRef:o})=>i.createElement("div",{className:"share-to-public-workspace-dropdown"},i.createElement(g.DropdownMenu,{disableCloseOnInputElementScroll:this.props.disableCloseOnInputElementScroll,fluid:!0,className:"share-to-public-workspace-dropdown-menu",parentClassName:`input-select-dropdown-menu ${this.props.menuClassName}`,targetRef:this.wrapperRef.current,onSelect:this.handleSelect,onClose:this.handleClose},i.createElement("div",{className:"share-to-public-workspace-dropdown-menu__list",ref:e=>{o(e)}},v.isEmpty(e)||this.props.displayEmptyDropdown?i.createElement("div",{className:"share-to-public-workspace-dropdown-menu__list__no-results"},s?"No workspaces found.":t?this.props.noSearchResultsPlaceholder:"No workspaces found. To create one, contact your team's Community Manager."):e),this.props.isFetchingWorkspaces&&i.createElement("div",{className:"share-to-public-workspace-dropdown-menu__spinner"},i.createElement(d.default,null)),i.createElement(n.Button,{disabled:!t,onClick:this.handleCreateWorkspace,className:"share-to-public-workspace-dropdown-menu__list__button",tooltip:!t&&"To create one, contact your team's Community Manager.",tooltipPlacement:"right"},"+ Create Workspace")))))}render(){const{placeholder:e,hideSearchGlass:t,hideCancelOnBlur:s,showToggleButton:a,selectAllOnFocus:l}=this.props;return i.createElement("div",{ref:this.wrapperRef,className:this.getWrapperClasses(),style:this.props.style},i.createElement(o.Input,{hideCancelOnBlur:s,hideSearchGlass:t,inputStyle:"search",placeholder:e||"Type to filter",query:this.state.inputValue,ref:this.inputRef,selectAllOnFocus:l,onCancel:this.handleCancel,onChange:this.handleChange,onFocus:this.handleFocus,onKeyDown:this.handleKeyDown,disabled:this.props.disabled}),a&&i.createElement(n.Button,{className:"dropdown-button",ref:"button",onClick:this.handleToggleList,disabled:this.props.disabled},i.createElement(u.default,{name:"icon-direction-down",className:"dropdown-caret"})),this.state.isOpen&&this.renderMenu(),i.createElement("div",null))}}f.defaultProps={closeOnBlur:!0,closeOnSelect:!0,hideCancelOnBlur:!0,selectAllOnFocus:!0,showToggleButton:!0,hideSearchGlass:!0,openOnFocus:!0,resetEmptyFilterOnBlur:!0,menuClassName:"",disableCloseOnInputElementScroll:!0,isFetchingWorkspaces:!1},f.propTypes={closeOnBlur:c().bool,closeOnSelect:c().bool,hideCancelOnBlur:c().bool,selectAllOnFocus:c().bool,showToggleButton:c().bool,hideSearchGlass:c().bool,resetEmptyFilterOnBlur:c().bool,menuClassName:c().string,onBlur:c().func,onFocus:c().func,openOnFocus:c().bool,optionRenderer:c().func.isRequired,getInputValue:c().func.isRequired,selectedItem:c().object.isRequired,getFilteredList:c().func.isRequired,disableCloseOnInputElementScroll:c().bool,isFetchingWorkspaces:c().bool}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/ShareToWorkspaceDropdown.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var i=s("../../node_modules/react/index.js"),o=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),n=(s("./node_modules/classnames/index.js"),s("./documentation/components/DocumentationPublishView/ShareToWorkspace/InputSelect.js")),a=(s("./js/modules/services/RemoteSyncRequestService.js"),s("./js/components/base/LoadingIndicator.js"));const l=o.default.div`
  display: flex;
  flex-direction: row;

  .input-select-wrapper {
    background-color: var(--background-color-secondary);

    .input {
      font-family: var(--text-family-default);
      font-weight: normal !important;
      font-size: var(--text-size-m);
      line-height: var(--line-height-m);
      color: var(--content-color-primary);
      align-items: center;
      display: flex;
    }
  }
`,r=o.default.div`
  span {
    margin-left: var(--spacing-s);
    vertical-align: top;
  }
`,c=(0,o.default)(a.default)`
  position: relative;
  left: 0;
  margin-left: var(--spacing-m);
  padding-bottom: var(--spacing-m);
`;class d extends i.Component{constructor(e){super(e),this.state={workspaces:this.props.dropdownItems,loading:!1}}getOption(e,t,s={}){const{name:o,id:n,component:a}=e;return i.createElement("div",{className:"item-wrapper"},i.createElement("div",{className:"item-label",title:o},a))}filterWorkspaces(e,t,s={}){let i={visibilityStatus:"public",limit:50,name:t||""};this.props.setFilter(t),this.props.fetchPublicWorkspaces(i)}render(){const e=this.props.selectedItem;let t=[];return this.state.workspaces.forEach(((e,s)=>{t[s]={...e,renderOption:i.createElement(r,null,i.createElement("span",null,e.name))}})),this.state.loading?i.createElement(c,null):i.createElement(l,null,i.createElement(n.InputSelect,{disabled:this.props.disabled,style:{width:"420px"},selectedItem:e,handleCreateNewWorkspace:this.props.handleCreateNewWorkspace,getInputValue:e=>e&&e.name||"",optionRenderer:this.getOption,dropdownItems:this.props.dropdownItems,getFilteredList:this.filterWorkspaces.bind(this,this.props.dropdownItems),ref:"inputSelect",onSelect:this.props.onSelectItem,menuClassName:"workspace-selector-menu",displayEmptyDropdown:this.props.displayEmptyDropdown,placeholder:"Search for a workspace",noSearchResultsPlaceholder:"No workspaces found.",clearSelectedItem:this.props.clearSelectedItem,isFetchingWorkspaces:this.props.isFetchingWorkspaces}))}}},"./documentation/components/DocumentationPublishView/ShareToWorkspace/WorkspaceListItem.js":function(e,t,s){s.r(t);var i=s("../../node_modules/react/index.js"),o=s("./node_modules/classnames/index.js"),n=s.n(o),a=s("../../node_modules/@postman/aether/esmLib/src/components/Tooltip/Tooltip.js"),l=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),r=(s("./js/components/base/Buttons.js"),s("./js/components/base/LoadingIndicator.js"),s("./documentation/components/DocumentationIntersectionObserver/DocumentationIntersectionObserver.js"));class c extends i.Component{constructor(e){super(e),this.container=(0,i.createRef)(),this.state={isLoading:!1}}componentDidMount(){this.props.register(this.props.workspaceId,{target:this.container.current,onEnter:this.handleViewportEnter.bind(this)})}componentWillUnmount(){this.props.deregister(this.props.workspaceId)}async handleViewportEnter(){await this.props.loadMore()}getItemClasses(){return n()({"doc-workspace-list-item":!0,"is-disabled":this.props.disabled})}getContextItem(){switch(this.props.context){case"shared":return i.createElement("div",null,i.createElement("span",{className:n()({"doc-workspace__shared":this.props.disabled})},i.createElement(a.default,{content:"The collection already exists in this workspace.",placement:"right"},i.createElement(l.default,{size:"small",name:"icon-state-info-stroke-small"}))));case"moveNotAllowed":return i.createElement("div",null,i.createElement("span",{className:n()({"doc-workspace__shared":this.props.disabled})},i.createElement(a.default,{content:"You don’t have access to move collections to this workspace.",placement:"right"},i.createElement(l.default,{size:"small",name:"icon-state-info-stroke-small"}))))}}render(){return i.createElement("div",{className:this.getItemClasses(),ref:this.container},i.createElement(l.default,{name:"icon-state-published-stroke",color:"content-color-secondary",className:"doc-workspace-type-icon"}),i.createElement("div",{className:"doc-workspace-list-item__name"},this.props.text),this.getContextItem())}}t.default=(0,r.withIntersectionObserver)(c)},"./documentation/components/DocumentationPublishView/ShareToWorkspace/index.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return v}});var i=s("./node_modules/lodash/lodash.js"),o=s.n(i),n=s("../../node_modules/react/index.js"),a=s("./node_modules/prop-types/index.js"),l=s.n(a),r=s("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),c=s("./documentation/components/DocumentationPublishView/ShareToWorkspace/ShareToWorkspaceDropdown.js"),d=s("./js/stores/StoreManager.js"),u=s("./js/stores/CurrentUserStore.js"),h=s("./js/stores/SyncStatusStore.js"),m=s("./documentation/components/DocumentationPublishView/ShareToWorkspace/WorkspaceListItem.js"),p=s("./documentation/services/DocumentationService.js"),b=s("./js/services/CurrentUserDetailsService.js"),g=s("./collaboration/workspace/types/PermissionTypes.ts"),y=s("./documentation/constants.js");class v extends n.Component{constructor(e){super(e),this.state={publicWorkspaces:{},dropdownDisabled:!0,displayEmptyDropdownPlaceholder:!0,selectedWorkspace:{},isSharing:!1,publicWorkspacesListItems:[{}],workspaceListWithCollection:[],permissions:[],isFetchingWorkspaces:!1,canMoveEnvironment:!0,canMoveCollection:!1},this.handleWorkspaceSelect=this.handleWorkspaceSelect.bind(this),this.fetchPublicWorkspaces=this.fetchPublicWorkspaces.bind(this),this.handleShare=this.handleShare.bind(this),this.handleCreateNewWorkspace=this.handleCreateNewWorkspace.bind(this),this.handleCreatedPublicWorkspace=this.handleCreatedPublicWorkspace.bind(this),this.updateWorkspaceItems=this.updateWorkspaceItems.bind(this),this.clearSelectedItem=this.clearSelectedItem.bind(this)}async transformWorkspacesIntoDropdownList(e){let t=(0,d.resolveStoreInstance)(u.default),s=(t&&t.id,[]),i=[],a=[];if(Array.isArray(e.data))for(const[t,o]of e.data.entries()){let t=!!this.state.workspaceListWithCollection.find((e=>e.id===o.id)),l=this.state.permissions[o.id],r=t?"shared":l?"":"moveNotAllowed",c=""!==r,d={id:o.id,name:o.name,component:n.createElement(m.default,{text:o.name,context:r,workspaceId:o.id,loadMore:this.loadMore.bind(this,o.id,e.data.length,e.meta)}),disabled:c};t?i.push(d):l?s.push(d):a.push(d)}return s.push(...a),s.push(...i),o().isEmpty(s)?[{}]:s}async fetchPublicWorkspaces(e={visibilityStatus:"public",limit:50}){try{let t=await(0,p.fetchWorkspaces)(e),s=!t.data.length,i={};this.state.publicWorkspaces.data&&e.cursor?(i={...this.state.publicWorkspaces},i.meta=t.meta,i.data.push(...t.data)):i=t,this.setState({publicWorkspaces:i,dropdownDisabled:!1,displayEmptyDropdownPlaceholder:s}),await this.setWorkspacePermissions(this.state.publicWorkspaces.data);let o=await this.getWorkspaceItems();this.setState({publicWorkspacesListItems:o})}catch(e){throw pm.logger.error("ShareToWorkspace~fetchWorkspaces: Failed to fetch public workspaces",e),pm.toasts.error("Failed to load Public Workspaces. Please try again later"),this.setState({dropdownDisabled:!0}),e}}async loadMore(e,t,s){const i=o().findIndex(this.state.publicWorkspacesListItems,(t=>t.id===e));if(i&&t===i+1&&s.nextCursor){this.setState({isFetchingWorkspaces:!0});try{await this.fetchPublicWorkspaces({visibilityStatus:"public",cursor:s.nextCursor,limit:50,name:this.query?this.query:""})}catch(e){pm.logger.error("ShareToWorkspace~loadMore: Error occured while fetching public workspaces",e)}finally{this.setState({isFetchingWorkspaces:!1})}}}async checkEnvMovePermission(){if(!this.props.selectedEnvironment)return void this.setState({canMoveEnvironment:!0});let e={},t={},s=b.default.userId,{workspaceId:i}=this.props;e[i]={entityType:g.ENTITY_TYPE.USER,entityId:s,objectType:g.OBJECT_TYPE.WORKSPACE,objectId:i,permission:y.MOVE_REMOVE_PERMISSIONS.environment},t=await(0,p.fetchPermissions)(e),i&&t[i]&&t[i].allowed?this.setState({canMoveEnvironment:!0}):this.setState({selectedWorkspace:{},canMoveEnvironment:!1})}async checkCollectionMovePermission(){let e={},t={},s=b.default.userId,{workspaceId:i}=this.props;e[i]={entityType:g.ENTITY_TYPE.USER,entityId:s,objectType:g.OBJECT_TYPE.WORKSPACE,objectId:i,permission:y.MOVE_REMOVE_PERMISSIONS[y.DOCUMENTATION_ENTITY.COLLECTION]},t=await(0,p.fetchPermissions)(e),i&&t[i]&&t[i].allowed?this.setState({canMoveCollection:!0}):this.setState({canMoveCollection:!1})}async setWorkspacePermissions(e){const t=o().map(e,"id"),{permissions:s}=this.state,i=b.default.userId;let n={},a={};for(const e of t)s[e]||e===this.props.workspaceId||(n[e]={entityType:g.ENTITY_TYPE.USER,entityId:i,objectType:g.OBJECT_TYPE.WORKSPACE,objectId:e,permission:y.MOVE_ADD_PERMISSIONS.collection});try{o().isEmpty(n)||(a=await(0,p.fetchPermissions)(n))}catch(e){pm.logger.error("ShareToWorkspace~setWorkspacePermissions: Error occurred while fetching permissions",e)}this.setState((e=>({permissions:o().reduce(t,((t={},s)=>(e.permissions[s]||(t[s]=o().get(a,`${s}.allowed`,!1)),t)),e.permissions)})))}handleWorkspaceSelect(e){this.setState({selectedWorkspace:e})}handleCreateNewWorkspace(){pm.mediator.trigger("openCreateNewPublicWorkspaceModal",{handleCreatedPublicWorkspace:this.handleCreatedPublicWorkspace,collectionName:this.props.collectionName})}handleCreatedPublicWorkspace(e){this.updateWorkspaceItems(e),this.setState({selectedWorkspace:e})}setFilter(e){this.query=e}async getWorkspaceItems(){let{publicWorkspaces:e}=this.state;return!e.data||!e.data.length?[{}]:await this.transformWorkspacesIntoDropdownList(e)}updateWorkspaceItems(e){e&&this.setState((t=>({publicWorkspaces:[...t.publicWorkspaces.data,{...e,context:"",disabled:!1}]})))}clearSelectedItem(){this.setState({selectedWorkspace:{}})}async handleShare(){if(this.state.isSharing||o().isEmpty(this.state.selectedWorkspace))return this.props.onShareComplete();this.setState({isSharing:!0},(async()=>{try{let e=!1;if(await(0,d.resolveStoreInstance)(h.default).onSyncAvailable({timeout:1e4}),await(0,p.moveEntity)(this.state.selectedWorkspace.id,y.DOCUMENTATION_ENTITY.COLLECTION,this.props.collectionUid,this.props.workspaceId),this.props.selectedEnvironment&&this.props.selectedEnvironment.id&&this.props.selectedEnvironment.owner)try{await(0,d.resolveStoreInstance)(h.default).onSyncAvailable({timeout:1e4}),await(0,p.moveEntity)(this.state.selectedWorkspace.id,"environment",`${this.props.selectedEnvironment.owner}-${this.props.selectedEnvironment.id}`,this.props.workspaceId),e=!0}catch(e){pm.logger.error("ShareToWorkspace~handleShare : Failed to move environment to the workspace",e),pm.toasts.error("Failed to move the environment to the workspace. Please try again later.")}this.props.onShareComplete(null,this.state.selectedWorkspace.id,e)}catch(e){pm.logger.error("ShareToWorkspace~handleShare : Failed to share collection to the workspace",e),pm.toasts.error("Failed to move the collection to the workspace. Please try again later."),this.props.onShareComplete(e)}finally{this.setState({isSharing:!1})}}))}async componentDidMount(){await this.checkCollectionMovePermission(),await this.filterWorkspacesWithCollection(),await this.fetchPublicWorkspaces()}async filterWorkspacesWithCollection(){let e,t=[],{collectionUid:s}=this.props;try{do{let i=await(0,p.fetchWorkspaces)({limit:50,element:{type:"collection",id:s},visibilityStatus:"public",...e&&{cursor:e}});e=o().get(i,"meta.nextCursor"),t=o().unionBy(t,i.data,"id")}while(e)}catch(e){pm.logger.error("SharedWorkspaceList~filterWorkspacesWithCollection: Failed to fetch public workspaces",e),pm.toasts.error("Failed to load Public Workspaces. Please try again later")}this.setState({workspaceListWithCollection:t})}componentDidUpdate(e){!1===e.triggerShare&&!0===this.props.triggerShare&&this.handleShare(),e.selectedEnvironment!==this.props.selectedEnvironment&&this.checkEnvMovePermission()}render(){return n.createElement("div",{className:"share-to-workspace-container"},n.createElement("p",{className:"share-to-workspace-heading"},"Move to public workspace",n.createElement("span",{className:"share-to-workspace-optional"}," (optional)")),!this.state.canMoveCollection&&n.createElement(r.default,{title:"Insufficient permissions",status:"warning",className:"share-to-workspace-permissions-banner"},"You need to be an Editor in the current workspace to be able to move the collection."),this.state.canMoveCollection&&!this.state.canMoveEnvironment&&n.createElement(r.default,{title:"Insufficient permissions",status:"warning",className:"share-to-workspace-permissions-banner"},"You need to be an Editor in the current workspace to be able to move the environment."),n.createElement("h6",{className:"share-to-workspace-label"},"Select public workspace"),n.createElement("div",{className:"share-to-workspace-dropdown-and-text"},n.createElement("div",{className:"public-workspace-dropdown"},n.createElement(c.default,{disabled:this.state.dropdownDisabled||!this.state.canMoveCollection||!this.state.canMoveEnvironment,dropdownItems:this.state.publicWorkspacesListItems,onSelectItem:this.handleWorkspaceSelect,selectedItem:this.state.selectedWorkspace,handleCreateNewWorkspace:this.handleCreateNewWorkspace,displayEmptyDropdown:this.state.displayEmptyDropdownPlaceholder,clearSelectedItem:this.clearSelectedItem,fetchPublicWorkspaces:this.fetchPublicWorkspaces.bind(this),setFilter:this.setFilter.bind(this),isFetchingWorkspaces:this.state.isFetchingWorkspaces})),n.createElement("div",{className:"workspace-helper-text"},"This will make the collection (and environment, if selected) discoverable on the Public API Network along with its documentation.")))}}v.propTypes={collectionUid:l().string.isRequired,onShareComplete:l().func,triggerShare:l().bool}},"./documentation/components/DocumentationPublishView/SidebarNavigation.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var i=s("./node_modules/lodash/lodash.js"),o=s.n(i),n=s("../../node_modules/react/index.js"),a=s("./node_modules/classnames/index.js"),l=s.n(a),r=s("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),c=s("./documentation/constants.js"),d=s("./js/components/base/Tooltips.js");function u(e){const{options:t,className:s}=e,[i,a]=(0,n.useState)(!1),u=(0,n.useRef)();return n.createElement(n.Fragment,null,n.createElement("div",{className:l()("pm-sidebar-navigation",s)},n.createElement("ul",null,Array.isArray(t)&&t.map(((t,s)=>{const i=e.activeItem===o().get(t,"hash");return n.createElement("li",{className:l()({"active-item":i}),key:s},n.createElement("a",{className:l()("pm-sidebar-navigation__item",{"pm-sidebar-navigation__item--active":i}),href:t.hash,onClick:()=>{!function(e,t){"function"==typeof t.onClick&&t.onClick(e)}(t,e)}},t.label))}))),"browser"===window.SDK_PLATFORM&&n.createElement("div",{className:"preview-documentation",ref:u,onMouseOver:()=>{a(!0)},onMouseOut:()=>{a(!1)},onClick:()=>{"function"==typeof e.handlePreview&&e.handlePreview(c.DOCUMENTATION_PUBLISHING.USER_PREVIEW_REQUEST)}},n.createElement(r.default,{name:"icon-action-view-stroke",color:"content-color-primary"}),n.createElement("span",{className:"preview-label"},"Preview Documentation"))),n.createElement(d.Tooltip,{target:u.current,immediate:!0,placement:"right",show:i},n.createElement(d.TooltipBody,null,"Opens a live preview of the documentation in another window, which reloads on any change.")))}},"./documentation/components/DocumentationPublishView/index.js":function(e,t,s){s.r(t);var i,o=s("../../node_modules/react/index.js"),n=s("../../node_modules/mobx/lib/mobx.module.js"),a=s("../../node_modules/mobx-react/dist/mobx-react.module.js"),l=s("./node_modules/lodash/lodash.js"),r=s.n(l),c=s("./js/stores/StoreManager.js"),d=s("./js/stores/CurrentUserStore.js"),u=s("./js/stores/SyncStatusStore.js"),h=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),m=s("../../node_modules/@postman/aether/esmLib/src/components/Illustration/illustrations/NoReport.js"),p=s("../../node_modules/@postman/aether/esmLib/src/components/Toast/withToast.js"),b=s("../../node_modules/@postman/aether-icons/esmLib/src/design-system-icons/icon-action-open-stroke-small.js"),g=s("./js/components/base/LoadingIndicator.js"),y=s("./documentation/utils/utils.js"),v=s("./documentation/components/DocumentationPublishView/PublishedStatus.js"),E=s("./documentation/components/DocumentationPublishView/PublishSettings.js"),f=s("./js/services/NavigationService.js"),C=s("./documentation/components/DocumentationError.js"),w=s("./documentation/services/DocumentationService.js"),I=s("./js/services/CurrentUserDetailsService.js"),S=s("./documentation/constants.js"),N=s("./billing/stores/PlanFeaturesStore.js"),T=s("./js/modules/services/AnalyticsService.js");let P=(0,a.observer)(i=class extends o.Component{constructor(...e){super(...e),this.state={showPublishedStatusPage:!0,isPublished:null,isPublishing:null,isUnpublished:null,isUnpublishing:null,destinationWorkspaceId:null,isRequestApproving:null,isRequestApproved:null,isRequestDenying:null,isRequestDenied:null,isRequestRetracting:null,isRequestRetracted:null,isGovernanceEnabled:!1,isCommunityManager:!1,isGovernanceLoading:!0,isRequesting:null,isRequested:null,collectionWorkspaceId:null,respondedFrom:null,isCollectionApiExclusive:!1,hasError:!1},this.handleUnpublish=async()=>{const{addToast:e}=this.props;let t=r().get(this.props.controller,"params.collectionUid");try{this.setState({isUnpublishing:!0,isUnpublished:!1});let e=await(0,w.unpublishDocumentation)(t);this.setState({isUnpublishing:!1,isUnpublished:"success"===r().get(e,"body.status")})}catch(s){this.setState({isUnpublishing:!1}),e({status:"error",description:"Error unpublishing Collection"}),pm.logger.error(`DocumentationPublishView~handleUnpublish: Error unpublishing collection: ${t}`,s)}},this.handleRetractRequest=async e=>{const{addToast:t}=this.props;let s=r().get(this.props.controller,"params.collectionUid");try{this.setState({isRequestRetracting:!0,isRequestRetracted:!1}),await(0,w.retractRequest)(e),this.setState({isRequestRetracting:!1,isRequestRetracted:!0}),t({title:"Request to publish retracted",status:"success",description:"This request has been removed from the Community Managers queue"}),f.default.transitionTo("documentation.openWithWsSelect",{collectionUid:s})}catch(e){this.setState({isRequestRetracting:!1}),t({title:"Something went wrong",status:"error",description:"There was an error in retracting the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleRetractRequest: Error retracting publish request for collection: ${s}`,e)}},this.handleDenyRequest=async(e,t)=>{const{addToast:s}=this.props;let i=r().get(this.props.controller,"params.collectionUid"),o={notes:e};try{this.setState({isRequestDenying:!0,isRequestDenied:!1}),await(0,w.denyRequest)(o,t),this.setState({isRequestDenying:!1,isRequestDenied:!0});let e="Request to publish rejected",n=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),a=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!n,l=["workspaces","documentation","links"];s({title:e,status:"success",description:"This request has been rejected and removed from Community Managers' queue"}),a?f.default.transitionTo(S.OPEN_MANAGE_PUBLIC_ELEMENTS_IDENTIFIER,{},{tab:l[1]}):f.default.transitionTo("documentation.openWithWsSelect",{collectionUid:i})}catch(e){this.setState({isRequestDenying:!1}),s({title:"Something went wrong",status:"error",description:"There was an error in denying the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleDenyRequest: Error denying publish request for collection: ${i}`,e)}},this.handleApproveRequest=async(e,t)=>{const{addToast:s}=this.props;let i=r().get(this.props.controller,"params.collectionUid"),n=r().get(this.props.controller,"params.workspaceId"),{store:a}=this.props.controller,l={metadata:e};try{this.setState({isRequestApproving:!0,isRequestApproved:!1}),await(0,w.approveRequest)(l,t),await a.fetchRequestData(),await a._fetchPublishedData();let e=a.publishedData,c=r().get(e,"data.body.collections[0]",{}),d=(0,y.getPublishedUrl)(c),u={target:"_blank"};s({title:"Documentation published.",status:"success",description:o.createElement(o.Fragment,null,o.createElement(h.default,{onClick:()=>{f.default._openExternalURL(d,u),T.default.addEventV2({category:S.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_view_documentation_toast",entityType:S.DOCUMENTATION_ENTITY.COLLECTION,entityId:i})},icon:o.createElement(b.default,{color:"content-color-primary"}),type:"monochrome-plain",text:"View documentation."}))}),this.setState({isRequestApproving:!1,isRequestApproved:!0,showPublishedStatusPage:!0,respondedFrom:null}),f.default.transitionTo("documentation.publish",{collectionUid:i},{workspaceId:n})}catch(e){this.setState({isRequestApproving:!1}),s({title:"Something went wrong",status:"error",description:"There was an error in approving the publish request for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleApproveRequest: Error approving publish request for collection: ${i}`,e)}},this.handleEditSettingsButtonClick=()=>{this.setState({showPublishedStatusPage:!1})},this.handleCancel=()=>{let e=this.getCollectionPublishStatus(),t=this.getCollectionRequestPublishStatus(),s=r().get(this.props.controller,"params.collectionUid");e||t?this.setState({showPublishedStatusPage:!0}):f.default.transitionTo("documentation.openWithWsSelect",{collectionUid:s})},this.handleRequestPublish=async(e,t="")=>{const{addToast:s}=this.props;let i=r().get(this.props.controller,"params.collectionUid"),{store:o}=this.props.controller,n=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),a=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!n,l={modelId:i,notes:t,metadata:e},c={notes:t,metadata:e};try{this.setState({isRequesting:!0,isRequested:!1});let e=await this.getCollectionRequestPublishStatus();if(e){let e=await this.getCollectionPublishRequestCode();await(0,w.updatePublishRequest)(c,e),T.default.addEventV2({category:S.DOCUMENTATION_ANALYTICS.CATEGORY,action:"update_request",label:a?S.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:S.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:S.DOCUMENTATION_ENTITY.COLLECTION,entityId:i})}else{let e=this.getCollectionPublishStatus();await(0,w.requestPublish)(l),T.default.addEventV2({category:S.DOCUMENTATION_ANALYTICS.CATEGORY,action:e?"request_publish_for_published":"request_publish_for_unpublished",label:a?S.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:S.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:S.DOCUMENTATION_ENTITY.COLLECTION,entityId:i})}await o.fetchRequestData(),this.setState({isRequesting:!1,isRequested:!0}),s({title:e?"Request updated successfully":"Request sent successfully",status:"success",description:e?"A community manager will review the updated request.":"A community manager will review the request."}),f.default.transitionTo("documentation.publish",{collectionUid:i},{workspaceId:n})}catch(e){this.setState({isRequesting:!1}),s({title:"Something went wrong",status:"error",description:"There was an error in requesting publish for your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handleRequestPublish: Error requesting publish for collection: ${i}`,e)}},this.handlePublish=async e=>{const{addToast:t}=this.props;let s=r().get(this.props.controller,"params.collectionUid"),{store:i}=this.props.controller,n=r().get(e,"shareToWorkspace",{});e.uid=s;try{this.setState({isPublishing:!0,isPublished:!1}),await(0,w.publishDocumentation)(e),await i._fetchPublishedData(),await i.fetchRequestData();let a=i.publishedData,l=r().get(a,"data.body.collections[0]",{}),c=(0,y.getPublishedUrl)(l),d={target:"_blank"},{shared:u,workspaceId:m="",isEnvironmentMoved:p}=n;t({title:u&&m?p?"Collection and environment moved to the workspace and documentation published.":"Collection moved to the workspace and documentation published.":"Documentation published.",status:"success",description:o.createElement(o.Fragment,null,o.createElement(h.default,{onClick:()=>{f.default._openExternalURL(c,d),T.default.addEventV2({category:S.DOCUMENTATION_ANALYTICS.CATEGORY,action:"click_view_documentation_toast",entityType:S.DOCUMENTATION_ENTITY.COLLECTION,entityId:s})},icon:o.createElement(b.default,{color:"content-color-primary"}),type:"monochrome-plain",text:"View documentation."}))}),u&&m?(this.setState({destinationWorkspaceId:m}),f.default.transitionTo("documentation.publish",{collectionUid:s},{workspaceId:m})):this.setState({destinationWorkspaceId:r().get(this.props.controller,"params.workspaceId")}),this.setState({isPublishing:!1,isPublished:!0})}catch(e){this.setState({isPublishing:!1}),t({title:"Something went wrong",status:"error",description:"There was an error in publishing your Collection. Please try again."}),pm.logger.error(`DocumentationPublishView~handlePublish: Error publishing collection: ${s}`,e)}},this.handlePublishedCollection=()=>{this.setState({showPublishedStatusPage:!0})}}handleUnpublishedCollection(){const{addToast:e}=this.props;e({status:"success",description:"Collection successfully unpublished"});let t=r().get(this.props.controller,"params.collectionUid"),s=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),i=["workspaces","documentation","links"];this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!s?f.default.transitionTo(S.OPEN_MANAGE_PUBLIC_ELEMENTS_IDENTIFIER,{},{tab:i[1]}):f.default.transitionTo("documentation.openWithWsSelect",{collectionUid:t})}getCollectionPublishStatus(){let{store:e}=this.props.controller,{publishedData:t}=e;return Boolean(r().get(t,"data.body.collections.length"))}getCollectionRequestPublishStatus(){let{store:e}=this.props.controller,{requestData:t}=e,s=r().get((0,n.toJS)(t),"data",null);return Boolean("pending_approval"===r().get(s,"body.data[0].state"))}getCollectionPublishRequestCode(){let{store:e}=this.props.controller,{requestData:t}=e,s=r().get((0,n.toJS)(t),"data",null);return r().get(s,"body.data[0].code","")}resolvePublishedEnvironmentName(e,t){if(!e)return"";e=(0,y.handleLegacyEnvironmentId)(e);let s=t.find((t=>t.id===e));return r().get(s,"name")}getEnvironmentData(e){const t=r().chain(e).sortBy((e=>e.name.toLowerCase())).value(),s=[];return"function"==typeof t.forEach&&t.forEach((e=>{e&&s.push(r().pick(e,["owner","id","name"]))})),s}getPublishedVersionIds(e){if(!e)return{};let t={};return"function"==typeof e.forEach&&e.forEach((e=>{t[e.versionTagId]={id:e.versionTagId,name:e.apiName}})),t}handleBreadcrumbClick(e){return(0,y.openEntity)(r().get(e,"type"),r().get(e,"id"),r().get(e,"workspaceId"))}async componentDidMount(){try{await N.default.onPlanFeaturesLoad();let e,t=r().get((0,n.toJS)(N.default.featureObject).features,"publish_documentation_governance_enabled.value",!1),s=r().get(this.props.controller,"params.collectionUid");try{const{apiId:e,isEntityApiExclusive:t}=await(0,y.getEntityExclusivityDetails)("collection",s);e&&t&&this.setState({isCollectionApiExclusive:!0})}catch(e){pm.logger.error("DocumentationPublishView~componentDidMount: Unable to get entity exclusivity details",e)}if(t){await this.fetchPublishPermission(),e=await(0,w.fetchWorkspaceForCollection)(s);try{r().isEmpty(e)||this.props.controller.store.getEnvironmentsAndApiForCollection(e)}catch(e){pm.logger.error("DocumentationPublishView~componentDidMount: Unable to get entity exclusivity details",e)}}this.setState({isGovernanceLoading:!1,isGovernanceEnabled:t,collectionWorkspaceId:e});let i=r().get(this.props.controller,"params.respondedFrom",""),o=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?e:r().get(this.props.controller,"params.workspaceId"),a=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!o;"email"!==i&&"notification"!==i||T.default.addEventV2({category:S.DOCUMENTATION_ANALYTICS.CATEGORY,action:"notification"===i?"respond_request_notification":"email"===i&&"respond_request_email",label:a?S.DOCUMENTATION_ANALYTICS.LABEL.PRIVATE_WORKSPACE:S.DOCUMENTATION_ANALYTICS.LABEL.PUBLIC_WORKSPACE,entityType:S.DOCUMENTATION_ENTITY.COLLECTION,entityId:s}),this.setState({respondedFrom:i})}catch(e){this.setState({isGovernanceLoading:!1,hasError:!0}),pm.logger.error("DocumentationPublishView~componentDidMount",e)}}async fetchPublishPermission(){let{userId:e,teamId:t}=I.default,s={objectId:t,objectType:"team",entityId:e,entityType:"user",permission:S.PERMISSIONS.MANAGE_PUBLISH_DOCUMENTATION};try{await(0,c.resolveStoreInstance)(u.default).onSyncAvailable();let e=await(0,w.fetchPermissions)({permissionQuery:s});this.setState({isCommunityManager:r().get(e,"permissionQuery.allowed")})}catch(e){pm.logger.error("DocumentationPublishView~fetchPublishPermission: Error fetching publish permission",e)}}componentDidUpdate(e,t){let s=this.state.isPublished,i=this.state.isUnpublished,o=this.state.isRequested;s&&s!==t.showPublishedStatusPage&&this.handlePublishedCollection(),o&&o!==t.showPublishedStatusPage&&this.handlePublishedCollection(),i&&this.handleUnpublishedCollection()}render(){let{store:e}=this.props.controller,{customDomains:t,publishedData:s,requestData:i,versions:n,data:a,publishPermission:l,environments:u,isOffline:h,isLimitReachedForPublish:p,isRepeatSpammer:b}=e,f=this.getCollectionPublishStatus(),w=this.getCollectionRequestPublishStatus(),I=f&&!this.state.isCommunityManager&&!w,N=r().get(this.props.controller,"params.collectionUid"),T=r().isEmpty(r().get(this.props.controller,"params.workspaceId"))||void 0===r().get(this.props.controller,"params.workspaceId")?this.state.collectionWorkspaceId:r().get(this.props.controller,"params.workspaceId"),P=this.state.isGovernanceEnabled&&!this.state.destinationWorkspaceId&&!T,k=r().get(s,"data.body.collections[0]",{}),D=r().get(i,"data.body.data[0].metadata",{}),R=P?r().get(k,"collectionName",""):r().get(a,"name",""),O=this.state.isGovernanceEnabled&&r().get(i,"data.body.data[0].notes",""),_=this.getEnvironmentData(u),q=(0,y.handleLegacyEnvironmentId)(r().get(k,"environmentTemplateId")),A=I?q:(0,y.handleLegacyEnvironmentId)(r().get(D,"environmentTemplateId")),L=P?r().get(k,"environment.name"):this.resolvePublishedEnvironmentName(q,_),j=I?L:r().get(D,"environment.name"),x=r().get(k,"customDomainId"),U=I?x:r().get(D,"customDomainId"),M=r().get(D,"collection.name",""),V=this.getCollectionPublishRequestCode(),W=this.getPublishedVersionIds(r().get(k,"versions")),B=I?W:this.getPublishedVersionIds(r().get(D,"versions")),F=r().pick(k,["customColor","documentationLayout"]),Y=I?F:r().pick(D,["customColor","documentationLayout"]),$=r().get(k,"environmentOwner"),H=I?$:r().get(D,"environmentOwner"),G=this.state.isUnpublishing,z=this.state.isRequestRetracting,J=this.state.isRequestApproving,K=this.state.isRequestDenying,Q=this.state.isPublishing,X=this.state.isRequesting,Z=r().get(t,"data.body.domains"),ee=(0,y.getPublishedUrl)(k),te=r().get(l,"loading"),se=r().get(s,"loading",!0)||!R&&!P||te&&!P,ie=!!te||r().get(l,"data"),oe="email"===this.state.respondedFrom||"notification"===this.state.respondedFrom||"managePublicElements"===this.state.respondedFrom,ne=S.DISABLE_API_EXCLUSIVE_PUBLISH_FLOW&&this.state.isCollectionApiExclusive;return this.state.hasError?o.createElement("div",{className:"documentation documentation-publish-page-container"},o.createElement(C.default,{status:500,fullView:!0},o.createElement(m.default,null))):this.state.isGovernanceLoading?o.createElement("div",{className:"documentation documentation-publish-page-container"},o.createElement(g.default,null)):o.createElement("div",{className:"documentation documentation-publish-page-container"},!ne&&(ie||this.state.isGovernanceEnabled&&this.state.isCommunityManager)?se||this.state.isGovernanceLoading?o.createElement(g.default,null):P&&oe&&!w?o.createElement(C.default,{status:404,title:"Couldn't find request",message:"This request might have been retracted.",fullView:!0},o.createElement(m.default,null)):(f||w)&&this.state.showPublishedStatusPage||P?o.createElement(v.default,{unPublishButtonCallback:this.handleUnpublish,denyRequestButtonCallback:this.handleDenyRequest,retractRequestButtonCallback:this.handleRetractRequest,approveRequestButtonCallback:this.handleApproveRequest,editSettingsButtonCallback:this.handleEditSettingsButtonClick,handleBreadcrumbClick:this.handleBreadcrumbClick,requestData:i,collectionName:R,requestedCollectionName:M,collectionUid:N,workspaceId:this.state.destinationWorkspaceId?this.state.destinationWorkspaceId:T,publishedUrl:ee,publishedId:k.id,requestedOwner:D&&D.owner,publishedOwner:k.owner,requestedStyling:Y,publishedStyling:F,requestedVersions:r().get(D,"versions"),publishedVersions:r().get(k,"versions"),requestedEnvironment:j||"No Environment",publishedEnvironment:L||"No Environment",isUnpublishing:G,isRequestRetracting:z,isRequestApproving:J,isRequestDenying:K,teamLogoUrl:r().get((0,c.resolveStoreInstance)(d.default),"team.logo_url"),isOffline:h,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:O,isCollectionPublishRequested:w,collectionPublishRequestCode:V,isViewOnlyStatusPage:P,isCollectionPublished:f,isLimitReachedForPublish:p}):o.createElement(E.default,{customDomains:t,environments:u,publishButtonCallback:this.handlePublish,requestPublishButtonCallback:this.handleRequestPublish,approveRequestButtonCallback:this.handleApproveRequest,retractRequestButtonCallback:this.handleRetractRequest,cancelButtonCallback:this.handleCancel,collectionName:R,collectionUid:N,workspaceId:T,availableVersions:r().get(n,"data"),availableEnvironments:_,availableCustomDomains:Z,requestedStyling:Y,publishedStyling:F,requestedVersions:B,publishedVersions:W,publishedId:k&&k.id,publishedCustomDomain:x,requestedCustomDomain:U,requestedEnvironment:A,publishedEnvironment:q,requestedEnvironmentOwner:H,publishedEnvironmentOwner:$,isPublishing:Q,isRequesting:X,isRequestApproving:J,requestData:i,isRequestRetracting:z,isCollectionPublished:f,isCollectionPublishRequested:w,teamLogoUrl:r().get((0,c.resolveStoreInstance)(d.default),"team.logo_url"),isOffline:h,isGovernance:this.state.isGovernanceEnabled,isCommunityManager:this.state.isCommunityManager,noteToCommunityManager:O,collectionPublishRequestCode:V,isViewOnlyStatusPage:P,isLimitReachedForPublish:p,isRepeatSpammer:b}):o.createElement(C.default,{status:403,fullView:!0},o.createElement(m.default,null)))}})||i;t.default=(0,p.default)(P)},"./documentation/controllers/DocumentationPublishController.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return l}});var i,o=s("../../node_modules/mobx/lib/mobx.module.js"),n=s("./appsdk/pages/BasePageController.js"),a=s("./documentation/stores/PublishDocumentationStore.js");let l=(i=class extends n.default{constructor(...e){super(...e),this.store=null}_setParams(e,t){this.params={...this.params,...e,...t}}didCreate({routeParams:e,queryParams:t}){this._setParams(e,t);let{collectionUid:s,workspaceId:i}=this.params;this.store=new a.default(i,s)}didActivate({routeParams:e,queryParams:t}){this._setParams(e,t);let{workspaceId:s,collectionUid:i}=this.params;this.store=new a.default(s,i)}willDestroy(){this.store&&this.store.cleanup()}},r=i.prototype,c="_setParams",d=[o.action],u=Object.getOwnPropertyDescriptor(i.prototype,"_setParams"),h=i.prototype,m={},Object.keys(u).forEach((function(e){m[e]=u[e]})),m.enumerable=!!m.enumerable,m.configurable=!!m.configurable,("value"in m||m.initializer)&&(m.writable=!0),m=d.slice().reverse().reduce((function(e,t){return t(r,c,e)||e}),m),h&&void 0!==m.initializer&&(m.value=m.initializer?m.initializer.call(h):void 0,m.initializer=void 0),void 0===m.initializer&&(Object.defineProperty(r,c,m),m=null),i);var r,c,d,u,h,m},"./documentation/stores/PublishDocumentationStore.js":function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var i,o,n,a,l,r,c,d,u,h,m,p=s("../../node_modules/mobx/lib/mobx.module.js"),b=s("./js/stores/StoreManager.js"),g=s("./js/stores/SyncStatusStore.js"),y=s("./js/stores/CurrentUserStore.js"),v=s("./documentation/services/DocumentationService.js"),E=s("./documentation/constants.js"),f=s("./js/utils/uid-helper.js"),C=s("./documentation/utils/utils.js"),w=s("./runtime-repl/environment/_api/EnvironmentStoreV2.js"),I=s("./billing/stores/PlanFeaturesStore.js"),S=s("./node_modules/lodash/lodash.js");function N(e,t,s,i){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(i):void 0})}function T(e,t,s,i,o){var n={};return Object.keys(i).forEach((function(e){n[e]=i[e]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=s.slice().reverse().reduce((function(s,i){return i(e,t,s)||s}),n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}const P=(e=!0)=>({data:null,loading:e,error:null});let k=(o=T((i=class{constructor(e,t){N(this,"data",o,this),N(this,"loading",n,this),N(this,"error",a,this),N(this,"isLimitReachedForPublish",l,this),N(this,"isRepeatSpammer",r,this),N(this,"publishedData",c,this),N(this,"requestData",d,this),N(this,"customDomains",u,this),N(this,"versions",h,this),N(this,"publishPermission",m,this),this._disposer=void 0,this.entityType="collection",this.entityUid=t,this.fetchData().then(this._subscribeToSync.bind(this)),this.workspaceId=e,this.collectionUid=t,this.environments=[],this.getEnvironmentsAndApiForCollection(e),this._fetchPublishedData(),this.getPublishingData(),this.fetchRequestData(),this.isPublishLimitReached(),this.isPublisherSpamCheck()}async getEnvironmentsAndApiForCollection(e){await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();try{const{apiId:t,isEntityApiExclusive:s}=await(0,C.getEntityExclusivityDetails)(this.entityType,this.entityUid);return this.environments=this.getEnvironments(e,s&&t),this.environments}catch(e){pm.logger.error(`PublishDocumentationStore~getEnvironmentsAndApiForCollection: Failed to fetch environments for ${this.entityType} ${this.entityUid}`,e)}}get entityId(){let{modelId:e}=(0,f.decomposeUID)(this.entityUid);return e}get owner(){let{owner:e}=(0,f.decomposeUID)(this.entityUid);return e}get isOffline(){return!(0,b.resolveStoreInstance)(g.default).isSocketConnected}cleanUp(){this._unsubscribeToSync()}_subscribeToSync(){}_unsubscribeToSync(){"function"==typeof this._disposer&&this._disposer()}async fetchData(e=E.DOCUMENTATION_LATEST_VERSION_STRING){this._updateStore({loading:!0});try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let t=(await(0,v.fetchData)(this.entityType,this.entityId,this.owner,{populate:!0,versionTag:this.entityType===E.DOCUMENTATION_ENTITY.COLLECTION?e:void 0})).body.data;this._updateStore({data:t,loading:!1,error:null})}catch(e){pm.logger.error(`Failed to fetch ${this.entityType} ${this.entityId}`,e),this._updateStore({data:null,loading:!1,error:e})}}_updateStore({data:e,loading:t,error:s},i=this.entityType,o=this.entityId){if(void 0!==e)if(i===this.entityType&&o===this.entityId)this.data?(0,C.mergeUpdates)(this.data,e):this.data=e;else if(i===E.DOCUMENTATION_ENTITY.FOLDER&&this.data){let t=this.data.folders.find((e=>e.id===o));(0,C.mergeUpdates)(t,e)}else if(i===E.DOCUMENTATION_ENTITY.REQUEST&&this.data){let t=this.data.requests.find((e=>e.id===o));(0,C.mergeUpdates)(t,e)}void 0!==t&&(this.loading=t),void 0!==s&&(this.error=s)}getPublishingData(){this._fetchCustomDomains(),this._fetchVersionTags(),this._fetchPublishPermission()}async fetchRequestData(){this._updatePublishStore(this.requestData,{loading:!0});try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let e=await(0,v.fetchRequestData)(this.collectionUid);this._updatePublishStore(this.requestData,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch request data:",e),this._updatePublishStore(this.requestData,{loading:!1,error:e})}}async isPublishLimitReached(){try{let i;var e,t,s;if(await(0,b.resolveStoreInstance)(g.default).onSyncAvailable(),await I.default.onPlanFeaturesLoad(),S.get((0,p.toJS)(I.default.featureObject).features,"limit_publish_documentation.value",!1))i=await(0,v.isPublishLimitReached)(),i=null===(e=i)||void 0===e||null===(t=e.body)||void 0===t||null===(s=t.operation)||void 0===s?void 0:s.allowed;else i=!0;(0,p.runInAction)((()=>{this.isLimitReachedForPublish=!i}))}catch(e){pm.logger.error("PublishDocumentationStore~isPublishLimitReached: Failed to fetch the publish limit",e)}}async isPublisherSpamCheck(){try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let e=await(0,v.fetchPublisherSpamStatus)();(0,p.runInAction)((()=>{var t;this.isRepeatSpammer=null==e||null===(t=e.body)||void 0===t?void 0:t.spam}))}catch(e){pm.logger.error("PublishDocumentationStore~isPublisherSpamCheck: Failed to fetch publisher spam status data:",e),(0,p.runInAction)((()=>{this.isRepeatSpammer=!1}))}}async _fetchPublishedData(){this._updatePublishStore(this.publishedData,{loading:!0});try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let e=await(0,v.fetchPublishedData)(this.collectionUid);this._updatePublishStore(this.publishedData,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch published data:",e),this._updatePublishStore(this.publishedData,{loading:!1,error:e})}}async _fetchCustomDomains(){try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();const e=(0,b.resolveStoreInstance)(y.default).teamId;let t=[];e&&(t=await(0,v.fetchCustomDomains)()),this._updatePublishStore(this.customDomains,{data:t,loading:!1})}catch(e){pm.logger.error("Failed to fetch custom domains data:",e),this._updatePublishStore(this.customDomains,{loading:!1,error:e})}}async _fetchVersionTags(){try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let e=await(0,v.fetchAllTags)(this.collectionUid);this._updatePublishStore(this.versions,{data:e,loading:!1})}catch(e){pm.logger.error("Failed to fetch versions:",e),this._updatePublishStore(this.versions,{loading:!1,error:e})}}async _fetchPublishPermission(){this._updatePublishStore(this.publishPermission,{loading:!0});try{await(0,b.resolveStoreInstance)(g.default).onSyncAvailable();let e=(0,b.resolveStoreInstance)(y.default),t=(0,p.autorun)((async()=>{if(!e.isHydrating){let s={objectId:this.collectionUid,objectType:"collection",entityId:e.id,permission:E.DOCUMENTATION_PUBLISHING.PUBLISH_PERMISSION_NAME,entityType:"user"},i=await(0,v.fetchPermissions)({permissionQuery:s});this._updatePublishStore(this.publishPermission,{data:S.get(i,"permissionQuery.allowed"),loading:!1}),t&&t()}}))}catch(e){pm.logger.error("Failed to fetch publish publish permission for collection:",this.collectionUid,e),this._updatePublishStore(this.publishPermission,{loading:!1,error:e})}}_updatePublishStore(e,{data:t,loading:s,error:i}){e&&(t&&(e.data=t),"boolean"==typeof s&&(e.loading=s),i&&(e.error=i))}getEnvironments(e,t){const s=(0,p.observable)([]),i=t?["api","workspace"]:["workspace"],o=t?[{type:"api",id:t},{type:"workspace",id:e}]:[{type:"workspace",id:e}];return(0,w.getMeta)(e,{parent:i}).then((0,p.action)((e=>{const t=(null==e?void 0:e.getFilteredList({parents:o})).map((e=>{let t={...e},{owner:s,modelId:i}=(0,f.decomposeUID)(e.id);return t.id=i,t.owner=s,t}));s.push(...t)}))).catch((t=>{pm.logger.error(`PublishDocumentationStore~getEnvironments: Error fetching environments for workspace - ${e}`,t)})),s}}).prototype,"data",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n=T(i.prototype,"loading",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),a=T(i.prototype,"error",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=T(i.prototype,"isLimitReachedForPublish",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=T(i.prototype,"isRepeatSpammer",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=T(i.prototype,"publishedData",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P()}}),d=T(i.prototype,"requestData",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P()}}),u=T(i.prototype,"customDomains",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P()}}),h=T(i.prototype,"versions",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P()}}),m=T(i.prototype,"publishPermission",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P(!0)}}),T(i.prototype,"getEnvironmentsAndApiForCollection",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"getEnvironmentsAndApiForCollection"),i.prototype),T(i.prototype,"isOffline",[p.computed],Object.getOwnPropertyDescriptor(i.prototype,"isOffline"),i.prototype),T(i.prototype,"_updateStore",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"_updateStore"),i.prototype),T(i.prototype,"_updatePublishStore",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"_updatePublishStore"),i.prototype),i)},"./documentation/utils/publish.js":function(e,t,s){function i(e=window,t){let s=!1;if("function"==typeof e.postMessage){try{e.postMessage({toString:function(){}},t)}catch(e){s="DataCloneError"===e.name}return s}return s}s.r(t),s.d(t,{getPostMessageSupport:function(){return i}})},"./iam/src/common/styled-components/CopyButton.js":function(e,t,s){s.r(t);var i=s("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),o=s("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js");const n=(0,i.default)(o.default)`
  border-radius: var(--border-radius-default);
  width: var(--size-s);
  height: var(--size-s);
`;t.default=n}}]);