"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[87],{"../../packages/api-design/client-codegen/src/components/CodeCBView.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});var o,i=n("../../node_modules/react/index.js"),a=n("../../node_modules/mobx-react/dist/mobx-react.module.js"),r=n("../../node_modules/mobx/lib/mobx.module.js"),s=n("./appsdk/contextbar/ContextBarViewHeader.js"),p=n("./js/modules/services/AnalyticsService.js"),l=n("./js/utils/ClipboardHelper.js"),c=n("./js/stores/EditorStore.js"),d=n("./js/stores/StoreManager.js"),g=n("../../packages/api-design/client-codegen/src/stores/CodegenStore.js"),u=n("../../packages/api-design/client-codegen/src/services/CodegenService.js"),h=n("../../packages/api-design/client-codegen/src/components/CodeSnippetEditor.js"),m=n("../../packages/api-design/client-codegen/src/components/CodeControls.js"),E=n("../../packages/api-design/api-design-analytics/index.js"),S=n("./growth/activation/experiment/growth-335/CodeSnippetBanner.js"),C=n("./growth/foundation/public/amplitude/AmplitudeService.js"),y=n("./growth/activation/stores/GrowthActivationExperimentStore.ts"),v=n("../../node_modules/lodash/lodash.js");const f={ctaType:"icon",type:"tertiary"};let T=(0,a.observer)(o=class extends i.Component{constructor(e){super(e),this.state={activeLanguage:{language:"curl",variant:"cURL"},optionsArray:[],optionsPreference:{},codeSnippet:"",originalSnippetHash:"",codeCopied:!1,selectedLanguage:{}},this.handleCodeTypeSelect=this.handleCodeTypeSelect.bind(this),this.handleSnippetChange=this.handleSnippetChange.bind(this),this.handleCopyCode=this.handleCopyCode.bind(this),this.store=(0,d.resolveStoreInstance)(g.default),this.throttledGenerateSnippet=v.throttle(this.handleCodeTypeSelect.bind(this),500,{leading:!0,trailing:!0})}isParentCollectionEligibleToBeShared(){const e=v.get(this.props,"contextData.parentCollectionUid"),t=!v.isEmpty(v.get(this.props,"controller.editor.requestItem.url")),n=!v.isEmpty(e),o=v.get(this.props,"controller.editor.requestItem.parentCollection.isShareable");return t&&n&&o}fetchCurrentLanguage(){const e=v.get(this.store,"languagePreference"),{language:t}=v.isObject(e)?e:JSON.parse(e);return t}componentDidMount(){var e={id:this.store.languagePreference},{language:t,variant:n}=v.isObject(e.id)?e:JSON.parse(e.id);this.disposePreviewReaction=(0,r.reaction)((()=>{let e=(0,d.resolveStoreInstance)(c.default).find(this.props.contextData.editorId),t=e&&e.model;return t&&t.viewState&&(0,r.toJS)(t.viewState.previewRequest)}),(()=>{this.throttledGenerateSnippet(this.state.selectedLanguage)})),this.handleCodeTypeSelect(e),p.default.addEventV2({category:"codegen",action:"open_codegen_contextbar",label:`${t}_${n}`}),p.default.addEventV2({category:"api-design",action:"interact",label:"read",value:1,entityType:"collection",entityId:v.get(this.props,"contextData.parentCollectionId")}),(0,E.logApiDesignAnalytics)({category:E.EVENT_CATEGORIES.CODEGEN,action:E.EVENT_ACTIONS.OPEN_CODEGEN_CONTEXT_BAR_CLIENT,label:this.state.activeLanguage?`${this.state.activeLanguage.language} - ${this.state.activeLanguage.variant}`:void 0,entityType:"example"===v.get(this.props,"contextData.type")?E.EVENT_ENTITY_TYPES.EXAMPLE:E.EVENT_ENTITY_TYPES.REQUEST,entityId:v.get(this.props,"contextData.id")})}componentWillUnmount(){this.disposePreviewReaction&&this.disposePreviewReaction()}componentDidUpdate(e){const{id:t}=e.contextData||{};t!==v.get(this.props.contextData,"id")&&this.handleCodeTypeSelect(this.state.selectedLanguage)}hash(e){return n("../../node_modules/crypto-browserify/index.js").createHash("sha1").update(e).digest("base64")}handleCodeTypeSelect(e){v.isEmpty(e)||this.setState({selectedLanguage:e});let t,n=v.isEmpty(e)?this.store.languagePreference:JSON.parse(e.id),{language:o,variant:i}=n,a={};if(this.setState({activeLanguage:{language:o,variant:i}}),this.isParentCollectionEligibleToBeShared()){if("curl"===o){const{experimentId:e,variationId:t}=y.activationExperimentStore.shareCollectionFromCodeSnippet;(0,C.ampliIdentifyExperimentV2)({experimentId:e,variationId:t})}C.Ampli.savedRequestContextSectionCodeSnippetViewed({selected_language:o})}(0,E.logApiDesignAnalytics)({category:E.EVENT_CATEGORIES.CODEGEN,action:E.EVENT_ACTIONS.SELECT_LANGUAGE_CLIENT,label:`${o} - ${i}`,entityType:"example"===v.get(this.props,"contextData.type")?E.EVENT_ENTITY_TYPES.EXAMPLE:E.EVENT_ENTITY_TYPES.REQUEST,entityId:v.get(this.props,"contextData.id")}),u.default.getOptions(o,i).then((e=>{e&&e.length&&(this.setState({optionsArray:e}),e.forEach((e=>{a[e.id]=e.default})))})).catch((e=>{this.setState({optionsArray:[]}),pm.logger.error(`CodeCBView~handleCodeTypeSelect - ${e}`)})).then((()=>{t=this.store.getSnippetOptionForLanguage(o,i)||a,this.setState({optionsPreference:t})})).then((()=>{let e=this.props.contextData&&this.props.contextData.type;u.default.getSnippet(this.props.contextData.editorId,{language:o,variant:i,optionsPreference:t},e).then((e=>{if(!e)return;let t=this.hash(e.snippet);t!==this.state.originalSnippetHash&&((0,E.logApiDesignAnalytics)({category:E.EVENT_CATEGORIES.CODEGEN,action:E.EVENT_ACTIONS.CONFIGURE_CLIENT,label:`${o} - ${i}`,entityType:"example"===v.get(this.props,"contextData.type")?E.EVENT_ENTITY_TYPES.EXAMPLE:E.EVENT_ENTITY_TYPES.REQUEST,entityId:v.get(this.props,"contextData.id")}),this.setState({codeSnippet:e.snippet,originalSnippetHash:t},(()=>{let e=JSON.stringify({language:o,variant:i});this.store.updateLanguagePreference(e)})))}))}))}handleSnippetChange(e){this.setState({codeSnippet:e})}handleCopyCode(){var e,t,n;C.Ampli.contextSectionCodeSnippetCopySnippetClicked({...(0,C.getAmpliCTAProperties)(f),selected_language:v.get(this.state,"activeLanguage.language")}),l.default.copy(this.state.codeSnippet),this.setState({codeCopied:!0}),(0,E.logApiDesignAnalytics)({category:E.EVENT_CATEGORIES.CODEGEN,action:E.EVENT_ACTIONS.SELECT_LANGUAGE_CLIENT,label:null!==(e=this.state)&&void 0!==e&&e.activeLanguage?`${null===(t=this.state.activeLanguage)||void 0===t?void 0:t.language} - ${null===(n=this.state.activeLanguage)||void 0===n?void 0:n.variant}`:void 0,entityType:"example"===v.get(this.props,"contextData.type")?E.EVENT_ENTITY_TYPES.EXAMPLE:E.EVENT_ENTITY_TYPES.REQUEST,entityId:v.get(this.props,"contextData.id")}),clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.setState({codeCopied:!1})}),1500)}render(){let e,t=v.get(this.state.activeLanguage,"language","curl"),{controller:n={}}=this.props||{},o=v.get(this.state.activeLanguage,"variant","cURL"),a=n.labelEditorMap&&n.labelEditorMap[`${t}_${o}`]?n.labelEditorMap[`${t}_${o}`].editorMode:"powershell",r={indentationType:this.state.optionsPreference.indentType?v.toLower(this.state.optionsPreference.indentType):null,indentationSize:this.state.optionsPreference.indentCount||null},p=this.store.getSnippetOptions(),l="curl"===this.fetchCurrentLanguage()&&this.isParentCollectionEligibleToBeShared(),c=v.get(this.props,"contextData.parentCollectionUid"),d=v.get(this.props,"controller.editor.requestItem.url"),g=v.get(this.props,"controller.editor.requestItem.parentCollection.name");return n.editor&&(e=n.editor.isDirty),"dart"===a&&(a="powershell"),i.createElement("div",{className:"context-bar-code-snippet-view"},i.createElement(s.ContextBarViewHeader,{title:"Code snippet",onClose:this.props.onClose}),i.createElement("div",{className:"context-bar-code-snippet-body"},i.createElement(m.default,{codeCopied:this.state.codeCopied,languageList:n.languageList,onSelectLanguage:this.handleCodeTypeSelect,selectedLanguage:this.state.selectedLanguage,handleCopyCode:this.handleCopyCode,snippetOptions:p,isDirty:e}),l&&i.createElement(S.default,{collectionUid:c,requestUrl:d,parentCollectionName:g}),i.createElement(h.default,{indentation:r,codeSnippet:this.state.codeSnippet,editorMode:a,handleSnippetChange:this.handleSnippetChange})))}})||o},"../../packages/api-design/client-codegen/src/components/CodeControls.js":function(e,t,n){n.r(t);var o=n("../../node_modules/react/index.js"),i=n("../../node_modules/@postman/aether-icons/esmLib/src/Icon/Icon.js"),a=n("./js/components/base/Buttons.js"),r=n("./js/modules/controllers/ViewHierarchyController.js"),s=n("../../packages/api-design/client-codegen/src/components/ContextBarCodegenDropdown.js"),p=n("../../node_modules/lodash/lodash.js");class l extends o.Component{constructor(e){super(e),this.openLanguageSettingsModal=()=>{r.ModalViewManager.onMount((()=>{pm.mediator.trigger("openLanguageSettingsModel",this.props.selectedLanguage)}))},this.openLanguageSettingsModal=this.openLanguageSettingsModal.bind(this)}componentDidUpdate(e){let t=this.props.snippetOptions,n=e.snippetOptions,o=JSON.parse(this.props.selectedLanguage.id),i=p.get(o,"language","curl"),a=p.get(o,"variant","cURL");(JSON.stringify(n[`${i}_${a}`])!==JSON.stringify(t[`${i}_${a}`])||!this.props.isDirty&&e.isDirty)&&this.props.onSelectLanguage(this.props.selectedLanguage)}render(){return o.createElement("div",{className:"context-bar-codegen-controls"},o.createElement("div",{className:"context-bar-codegen-controls-left"},o.createElement("div",{className:"context-bar-codegen-controls-left__dropdown"},o.createElement(s.default,{selectedTarget:this.props.selectedLanguage,onTargetSelect:this.props.onSelectLanguage,menuClassName:"context-bar-codegen-dropdown",filterItems:this.props.languageList})),o.createElement("div",{className:"context-bar-codegen-controls-left__setting"},o.createElement(a.Button,{type:"tertiary",onClick:this.openLanguageSettingsModal},o.createElement(i.default,{name:"icon-descriptive-setting-stroke",className:"language-settings-icon",tooltip:"Code settings"})))),o.createElement("div",{className:"context-bar-codegen-controls-right"},o.createElement("div",{className:"context-bar-codegen-controls-right__copy"},this.props.codeCopied?o.createElement(a.Button,{onClick:this.props.handleCopyCode,tooltip:"Copied"},o.createElement(i.default,{name:"icon-state-success-stroke",className:"code-copied-icon"})):o.createElement(a.Button,{type:"tertiary",onClick:this.props.handleCopyCode,tooltip:"Copy snippet"},o.createElement(i.default,{name:"icon-action-copy-stroke",className:"code-copy-icon"})))))}}t.default=l},"../../packages/api-design/client-codegen/src/components/CodeSnippetEditor.js":function(e,t,n){n.r(t);var o=n("../../node_modules/react/index.js"),i=n("../../packages/client-foundation/text-editor/index.js");class a extends o.Component{constructor(e){super(e)}render(){return o.createElement("div",{className:"context-bar-code-snippet-editor"},o.createElement(i.TextEditor,{ref:e=>e&&e.focus(),indentation:this.props.indentation,value:this.props.codeSnippet,language:this.props.editorMode,onChange:this.props.handleSnippetChange,wordWrap:!0,ref:"editor"}))}}t.default=a},"../../packages/api-design/client-codegen/src/components/ContextBarCodegenDropdown.js":function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var o=n("../../node_modules/react/index.js"),i=n("./js/components/base/InputSelectV2.js"),a=n("./js/components/base/XPaths/XPath.js"),r=n("./js/components/base/SearchHighlighter.js"),s=n("../../node_modules/lodash/lodash.js");class p extends o.Component{constructor(e){super(e),this.selectedTarget=this.selectedTarget.bind(this)}getFilteredList(e,t,n={}){return!t||n.firstRender?e:s.filter(e,(e=>e.id&&s.includes(e.name.toLowerCase(),t.toLowerCase())))}selectedTarget(){var e=this.props.filterItems,t=this.props.selectedTarget,n=s.find(e,(e=>e.id===t.id));return n||{id:'{language:"curl",variant:"cURL"}',name:"cURL"}}getOption(e,t,n={}){const i=e.name,s=e.id;return t&&!n.firstRender?o.createElement(a.default,null,o.createElement("div",{className:"input-select-item",key:s},o.createElement(r.default,{source:i,query:t}))):o.createElement(a.default,null,o.createElement("div",{className:"input-select-item",key:s},i))}render(){var{filterItems:e}=this.props;return o.createElement("div",{className:"context-bar-dropdown-wrapper"},o.createElement("div",null,o.createElement(i.InputSelectV2,{style:{height:"32px"},onSelect:this.props.onTargetSelect,getFilteredList:this.getFilteredList.bind(this,e),optionRenderer:this.getOption,selectedItem:this.selectedTarget(),ref:"inputSelect",menuClassName:this.props.menuClassName,getInputValue:e=>e.name||""})))}}},"./growth/activation/experiment/growth-335/CodeSnippetBanner.js":function(e,t,n){n.r(t);var o=n("../../node_modules/react/index.js"),i=n("../../node_modules/@postman/aether/esmLib/src/components/Flex/Flex.js"),a=n("../../node_modules/@postman/aether/esmLib/src/components/Banner/Banner.js"),r=n("../../node_modules/@postman/aether/esmLib/src/components/Button/Button.js"),s=n("./growth/activation/experiment/growth-335/CodeSnippetHelper.js"),p=n("./growth/activation/stores/GrowthActivationExperimentStore.ts"),l=n("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),c=n("./runtime-repl/collection/_api/CollectionInterface.js"),d=n("./runtime-repl/collection/CollectionActionsConstants.js"),g=n("./growth/activation/experiment/growth-335/CodeSnippetInteractionHelper.js"),u=n("./growth/foundation/public/amplitude/AmplitudeService.js"),h=n("../../node_modules/mobx-react/dist/mobx-react.module.js");function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},m.apply(this,arguments)}const E=(0,l.default)(i.default)`
  margin-top: var(--spacing-l);
`,S={type:"outline",text:"Share Collection"},C={ctaType:"icon",type:"tertiary"};t.default=e=>{const t=()=>{u.Ampli.shareCodeSnippetBannerShareClicked((0,u.getAmpliCTAProperties)(S)),(0,c.collectionActions)(e.collectionUid,d.ACTION_TYPE_SHARE,null,{origin:"code_snippet"})},n=()=>{u.Ampli.shareCodeSnippetBannerCloseClicked((0,u.getAmpliCTAProperties)(C)),s.codeSnippetHelper.update("shouldShowCodeSnippetBanner",!1),(0,g.writeInteractionData)()};(0,o.useEffect)((()=>{(async()=>{p.activationExperimentStore.shareCollectionFromCodeSnippet.isEnabled&&(await s.codeSnippetHelper.hydrate(),s.codeSnippetHelper.shouldShowCodeSnippetBanner&&u.Ampli.shareCodeSnippetBannerViewed({request_url:e.requestUrl,collection_name:e.parentCollectionName}))})()}),[]);const i=()=>{const{isEnabled:e}=p.activationExperimentStore.shareCollectionFromCodeSnippet;return s.codeSnippetHelper.shouldShowCodeSnippetBanner&&e?o.createElement(E,null,o.createElement(a.default,{title:"send_banner"===p.activationExperimentStore.shareCollectionFromCodeSnippet.variationId?"Sending this code snippet to someone?":"Copying code snippets after every update?",hideIcon:!0,onDismiss:n,primaryAction:o.createElement(r.default,m({},S,{onClick:t}))},"send_banner"===p.activationExperimentStore.shareCollectionFromCodeSnippet.variationId?"Share this collection to collaborate directly on Postman instead of switching between tools.":"Share this collection with your team so they can view updates in real time on Postman. ")):null};return o.createElement(h.Observer,null,i)}},"./growth/activation/experiment/growth-335/CodeSnippetHelper.js":function(e,t,n){n.r(t),n.d(t,{codeSnippetHelper:function(){return d}});var o,i,a,r,s=n("../../node_modules/mobx/lib/mobx.module.js"),p=n("./growth/activation/experiment/growth-335/CodeSnippetInteractionHelper.js");function l(e,t,n,o){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0})}function c(e,t,n,o,i){var a={};return Object.keys(o).forEach((function(e){a[e]=o[e]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=n.slice().reverse().reduce((function(n,o){return o(e,t,n)||n}),a),i&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(i):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(e,t,a),a=null),a}const d=new(o=s.action.bound,a=c((i=class{constructor(){l(this,"shouldShowCodeSnippetBanner",a,this),l(this,"isHydrated",r,this)}update(e,t){this[e]=t}setIsHydrated(e){this.isHydrated=e}async hydrate(){if(!this.isHydrated)try{await(0,p.readInteractionData)()}catch(e){pm.logger.error("Error in fetching code snippet banner data",e)}finally{this.setIsHydrated(!0)}}}).prototype,"shouldShowCodeSnippetBanner",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),r=c(i.prototype,"isHydrated",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c(i.prototype,"update",[o],Object.getOwnPropertyDescriptor(i.prototype,"update"),i.prototype),c(i.prototype,"setIsHydrated",[s.action],Object.getOwnPropertyDescriptor(i.prototype,"setIsHydrated"),i.prototype),c(i.prototype,"hydrate",[s.action],Object.getOwnPropertyDescriptor(i.prototype,"hydrate"),i.prototype),i)},"./growth/activation/experiment/growth-335/CodeSnippetInteractionHelper.js":function(e,t,n){n.r(t),n.d(t,{INTERACTION_EVENT_DEFAULTS:function(){return s},readInteractionData:function(){return p},writeInteractionData:function(){return l}});var o=n("./growth/foundation/public/InteractionStoreService.js"),i=n("./growth/activation/constants/InteractionEventConstants.ts"),a=n("./growth/activation/experiment/growth-335/CodeSnippetHelper.js"),r=n("./node_modules/lodash/lodash.js");const s={entityType:i.USER,resourceId:i.CODE_SNIPPET_BANNER,resourceType:i.EXPERIMENT,multiTeam:!0};async function p(){const e=await(0,o.readInteractionEvent)({...s});a.codeSnippetHelper.update("shouldShowCodeSnippetBanner",r.get(e,"shouldShowCodeSnippetBanner",!0))}function l(){const e={shouldShowCodeSnippetBanner:a.codeSnippetHelper.shouldShowCodeSnippetBanner},t={...s,data:e};return(0,o.writeInteractionEvent)(t)}}}]);