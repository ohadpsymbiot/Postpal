"use strict";(self.webpackChunk_postman_app_renderer=self.webpackChunk_postman_app_renderer||[]).push([[124],{"./monitors/controllers/MonitorContextBarController.js":function(t,e,o){o.r(e),o.d(e,{default:function(){return n}});var i=o("./monitors/stores/domain/MonitorActivitiesStore.js"),r=o("./monitors/services/UrlService.js");class n{didCreate(){const t=r.default.getMonitorIdFromActiveRoute();this.monitorActivityStore=new i.default,this.monitorActivityStore.setActiveMonitorId(t)}didActivate(){const t=r.default.getMonitorIdFromActiveRoute();this.monitorActivityStore.isOffline||this.monitorActivityStore.getActivitiesByMonitor({monitorId:t,page:null},!0),this.monitorActivityStore.setActiveMonitorId(t)}willDestroy(){this.monitorActivityStore&&this.monitorActivityStore.offlineObserver&&this.monitorActivityStore.offlineObserver()}}},"./monitors/stores/domain/MonitorActivitiesStore.js":function(t,e,o){o.r(e),o.d(e,{default:function(){return M}});var i,r,n,s,a,l,c,d,p,u,b=o("../../node_modules/mobx/lib/mobx.module.js"),m=o("./js/stores/StoreManager.js"),y=o("./js/stores/SyncStatusStore.js"),v=o("./monitors/stores/domain/MasterMonitorStore.js"),f=o("./node_modules/lodash/lodash.js");function h(t,e,o,i){o&&Object.defineProperty(t,e,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(i):void 0})}function g(t,e,o,i,r){var n={};return Object.keys(i).forEach((function(t){n[t]=i[t]})),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=o.slice().reverse().reduce((function(o,i){return i(t,e,o)||o}),n),r&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(r):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(t,e,n),n=null),n}let M=(i=b.action.bound,n=g((r=class{constructor(){h(this,"loading",n,this),h(this,"loadingMore",s,this),h(this,"loaded",a,this),h(this,"error",l,this),h(this,"nextCursor",c,this),h(this,"activeMonitorId",d,this),h(this,"moreLoading",p,this),h(this,"isOpen",u,this),this.masterMonitorStore=new v.default,this.offlineObserver=(0,b.reaction)((()=>this.masterMonitorStore.isOffline),(async t=>{!t&&this.activeMonitorId&&await this.getActivitiesByMonitor({monitorId:this.activeMonitorId,cursor:null},!1)}))}get isOffline(){return this.masterMonitorStore.isOffline}get values(){return this.masterMonitorStore.getJobTemplateActivities(this.activeMonitorId).map((t=>({action:t.action,actor:t.actor,context:t.context,createdAt:t.createdAt,deletedAt:t.deletedAt,entityId:t.entityId,id:t.id,team:t.team,timestamp:t.timestamp,entityType:t.entityType})))}setIsOpen(t){this.isOpen=t}update(t){f.has(t,"loading")&&(this.loading=t.loading),f.has(t,"loaded")&&(this.loaded=t.loaded),f.has(t,"loadingMore")&&(this.loadingMore=t.loadingMore),f.has(t,"error")&&(this.error=t.error),f.has(t,"nextCursor")&&(this.nextCursor=t.nextCursor)}async getActivitiesByMonitor(t,e){const{monitorId:o,members:i,cursor:r}=t;e&&this.masterMonitorStore.clearJobTemplateActivities(o),this.update({loading:!0,loaded:!1,error:!1});try{await(0,m.resolveStoreInstance)(y.default).onSyncAvailable();const t=await this.masterMonitorStore.loadMonitorActivities({monitorId:o,members:i,cursor:r});if(200==t.status){const e=f.get(t,"body.meta",{});this.update({loading:!1,loaded:!0,nextCursor:e.nextCursor?e.nextCursor:null})}else this.update({loading:!1,loaded:!0,error:!0})}catch(t){pm.logger.error(`MonitorActivitiesStore~getActivitiesByMonitor: ${t.name}: ${t.message}`)}}setActiveMonitorId(t){this.activeMonitorId=t}setMoreLoading(t){this.moreLoading=t}}).prototype,"loading",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=g(r.prototype,"loadingMore",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=g(r.prototype,"loaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=g(r.prototype,"error",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=g(r.prototype,"nextCursor",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=g(r.prototype,"activeMonitorId",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),p=g(r.prototype,"moreLoading",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=g(r.prototype,"isOpen",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g(r.prototype,"isOffline",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"isOffline"),r.prototype),g(r.prototype,"values",[b.computed],Object.getOwnPropertyDescriptor(r.prototype,"values"),r.prototype),g(r.prototype,"setIsOpen",[b.action],Object.getOwnPropertyDescriptor(r.prototype,"setIsOpen"),r.prototype),g(r.prototype,"update",[b.action],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),g(r.prototype,"getActivitiesByMonitor",[i],Object.getOwnPropertyDescriptor(r.prototype,"getActivitiesByMonitor"),r.prototype),g(r.prototype,"setActiveMonitorId",[b.action],Object.getOwnPropertyDescriptor(r.prototype,"setActiveMonitorId"),r.prototype),g(r.prototype,"setMoreLoading",[b.action],Object.getOwnPropertyDescriptor(r.prototype,"setMoreLoading"),r.prototype),r)}}]);